# üêç –ì–ª–∞–≤–∞ 14: Pandas - –ø—Ä–µ–≤—Ä–∞—â–∞–µ–º –¥–∞–Ω–Ω—ã–µ –≤ —Å–æ–∫—Ä–æ–≤–∏—â–∞!

## üéØ –ß—Ç–æ –≤—ã –∏–∑—É—á–∏—Ç–µ

–ü–æ—Å–ª–µ —ç—Ç–æ–π –≥–ª–∞–≤—ã –≤—ã —Å–º–æ–∂–µ—Ç–µ:
- üêç –ü–æ–Ω–∏–º–∞—Ç—å, —á—Ç–æ —Ç–∞–∫–æ–µ Pandas –∏ –∑–∞—á–µ–º –æ–Ω –Ω—É–∂–µ–Ω –∫–∞–∂–¥–æ–º—É –∞–Ω–∞–ª–∏—Ç–∏–∫—É
- üìÇ –ó–∞–≥—Ä—É–∂–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –æ—Ç–∫—É–¥–∞ —É–≥–æ–¥–Ω–æ (Excel, CSV, –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö)
- üßπ –û—á–∏—â–∞—Ç—å "–≥—Ä—è–∑–Ω—ã–µ" –¥–∞–Ω–Ω—ã–µ –∏ –¥–µ–ª–∞—Ç—å –∏—Ö –ø—Ä–∏–≥–æ–¥–Ω—ã–º–∏ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
- üîÑ –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ–¥ –ª—é–±—ã–µ –Ω—É–∂–¥—ã
- üìä –°–æ–∑–¥–∞–≤–∞—Ç—å –æ—Ç—á–µ—Ç—ã –∏ –Ω–∞—Ö–æ–¥–∏—Ç—å –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏ –≤ –¥–∞–Ω–Ω—ã—Ö

## üåü –ß—Ç–æ —Ç–∞–∫–æ–µ Pandas –ø—Ä–æ—Å—Ç—ã–º–∏ —Å–ª–æ–≤–∞–º–∏

**Pandas** ‚Äî —ç—Ç–æ –≤–∞—à –ª–∏—á–Ω—ã–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏ –≤ Python. –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ Excel –Ω–∞—É—á–∏–ª—Å—è –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—é –∏ —Å—Ç–∞–ª –≤ 100 —Ä–∞–∑ –º–æ—â–Ω–µ–µ!

### üé≠ **–ú–µ—Ç–∞—Ñ–æ—Ä–∞: Pandas –∫–∞–∫ —à–≤–µ–π—Ü–∞—Ä—Å–∫–∏–π –Ω–æ–∂ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞**

–ï—Å–ª–∏ —Å—Ä–∞–≤–Ω–∏—Ç—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏:
- üìä **Excel** ‚Äî —ç—Ç–æ –º–æ–ª–æ—Ç–æ–∫ (–ø—Ä–æ—Å—Ç–æ–π, –Ω–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π)
- üîß **SQL** ‚Äî —ç—Ç–æ –æ—Ç–≤–µ—Ä—Ç–∫–∞ (–º–æ—â–Ω–∞—è –¥–ª—è –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö)  
- üêç **Pandas** ‚Äî —ç—Ç–æ —à–≤–µ–π—Ü–∞—Ä—Å–∫–∏–π –Ω–æ–∂ (—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –≤—Å–µ–≥–æ!)

### üíº **–ó–∞—á–µ–º –∏–∑—É—á–∞—Ç—å Pandas –≤ 2025 –≥–æ–¥—É:**

**–ë–µ–∑ Pandas:** "–ú–æ–∂–µ—à—å –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–∏ 100,000 —Å—Ç—Ä–æ–∫ –¥–∞–Ω–Ω—ã—Ö?"
*–í—ã 3 –¥–Ω—è –º—É—á–∞–µ—Ç–µ—Å—å —Å Excel, –∫–æ—Ç–æ—Ä—ã–π –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –∑–∞–≤–∏—Å–∞–µ—Ç...*

**–° Pandas:** "–°–µ–∫—É–Ω–¥–æ—á–∫—É!"
```python
df = pd.read_csv('big_data.csv')
result = df.groupby('category').sum()
print(result)
```
*2 —Å–µ–∫—É–Ω–¥—ã ‚Äî –∏ –≥–æ—Ç–æ–≤–æ!* ‚ö°

## üìä –î–≤–∞ "–ø–µ—Ä—Å–æ–Ω–∞–∂–∞" Pandas

### üé≠ **Series ‚Äî "–û–¥–∏–Ω –≤ –ø–æ–ª–µ –≤–æ–∏–Ω"**

**Series** ‚Äî —ç—Ç–æ –∫–∞–∫ –æ–¥–∏–Ω —Å—Ç–æ–ª–±–µ—Ü Excel, –Ω–æ —Å —Å—É–ø–µ—Ä—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—è–º–∏.

**–ê–Ω–∞–ª–æ–≥–∏—è:** –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ —Å–ø–∏—Å–æ–∫ –ø–æ–∫—É–ø–æ–∫, –Ω–æ –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç "–ø–æ–º–Ω–∏—Ç" —Å–≤–æ—ë –º–µ—Å—Ç–æ –∏ —É–º–µ–µ—Ç —Å —Å–æ–±–æ–π —á—Ç–æ-—Ç–æ –¥–µ–ª–∞—Ç—å.

```python
# –û–±—ã—á–Ω—ã–π —Å–ø–∏—Å–æ–∫ (—Å–∫—É—á–Ω–æ)
–ø—Ä–æ–¥–∞–∂–∏ = [100, 150, 200, 175]

# Pandas Series (–º–∞–≥–∏—è!)
–ø—Ä–æ–¥–∞–∂–∏ = pd.Series([100, 150, 200, 175], 
                   index=['–ü–Ω', '–í—Ç', '–°—Ä', '–ß—Ç'],
                   name='–ü—Ä–æ–¥–∞–∂–∏')

print(–ø—Ä–æ–¥–∞–∂–∏['–°—Ä'])  # 200 ‚Äî –ø—Ä–æ–¥–∞–∂–∏ –≤ —Å—Ä–µ–¥—É
print(–ø—Ä–æ–¥–∞–∂–∏.sum())  # 625 ‚Äî –æ–±—â–∏–µ –ø—Ä–æ–¥–∞–∂–∏
print(–ø—Ä–æ–¥–∞–∂–∏.mean()) # 156.25 ‚Äî —Å—Ä–µ–¥–Ω–∏–µ –ø—Ä–æ–¥–∞–∂–∏
```

**–ß—Ç–æ –∫—Ä—É—Ç–æ:** Series "–∑–Ω–∞–µ—Ç", —á—Ç–æ –æ–Ω —Å–æ–±–æ–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –∏ —É–º–µ–µ—Ç —Å–µ–±—è –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å!

### üìã **DataFrame ‚Äî "–ö–æ–º–∞–Ω–¥–∞ –º–µ—á—Ç—ã"**

**DataFrame** ‚Äî —ç—Ç–æ —Ç–∞–±–ª–∏—Ü–∞ –∫–∞–∫ –≤ Excel, –Ω–æ –∫–æ—Ç–æ—Ä–∞—è –ø–æ–Ω–∏–º–∞–µ—Ç –∫–æ–º–∞–Ω–¥—ã –Ω–∞ —á–µ–ª–æ–≤–µ—á–µ—Å–∫–æ–º —è–∑—ã–∫–µ.

**–ê–Ω–∞–ª–æ–≥–∏—è:** –ï—Å–ª–∏ Series ‚Äî —ç—Ç–æ –æ–¥–∏–Ω —Å–æ—Ç—Ä—É–¥–Ω–∏–∫, —Ç–æ DataFrame ‚Äî —ç—Ç–æ –≤—Å—è –∫–æ–º–∞–Ω–¥–∞, –≥–¥–µ –∫–∞–∂–¥—ã–π –∑–Ω–∞–µ—Ç —Å–≤–æ—ë –¥–µ–ª–æ.

```python
# –°–æ–∑–¥–∞–µ–º –∫–æ–º–∞–Ω–¥—É –ø—Ä–æ–¥–∞–∂
–∫–æ–º–∞–Ω–¥–∞_–ø—Ä–æ–¥–∞–∂ = pd.DataFrame({
    '–ò–º—è': ['–ò–≤–∞–Ω', '–ú–∞—Ä–∏—è', '–ü–µ—Ç—Ä'],
    '–ü—Ä–æ–¥–∞–∂–∏': [100000, 150000, 120000], 
    '–†–µ–≥–∏–æ–Ω': ['–ú–æ—Å–∫–≤–∞', '–°–ü–±', '–ö–∞–∑–∞–Ω—å'],
    '–û–ø—ã—Ç_–ª–µ—Ç': [3, 5, 2]
})

print(–∫–æ–º–∞–Ω–¥–∞_–ø—Ä–æ–¥–∞–∂)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
     –ò–º—è  –ü—Ä–æ–¥–∞–∂–∏  –†–µ–≥–∏–æ–Ω  –û–ø—ã—Ç_–ª–µ—Ç
0   –ò–≤–∞–Ω   100000  –ú–æ—Å–∫–≤–∞         3
1  –ú–∞—Ä–∏—è   150000     –°–ü–±         5
2   –ü–µ—Ç—Ä   120000  –ö–∞–∑–∞–Ω—å         2
```

**–ù–∞ —á–µ–ª–æ–≤–µ—á–µ—Å–∫–æ–º —è–∑—ã–∫–µ:**
- "–ü–æ–∫–∞–∂–∏ –º–Ω–µ –ø—Ä–æ–¥–∞–∂–∏ –ú–∞—Ä–∏–∏" ‚Üí `–∫–æ–º–∞–Ω–¥–∞_–ø—Ä–æ–¥–∞–∂[–∫–æ–º–∞–Ω–¥–∞_–ø—Ä–æ–¥–∞–∂['–ò–º—è'] == '–ú–∞—Ä–∏—è']['–ü—Ä–æ–¥–∞–∂–∏']`
- "–ö—Ç–æ –ª—É—á—à–∏–π –ø—Ä–æ–¥–∞–≤–µ—Ü?" ‚Üí `–∫–æ–º–∞–Ω–¥–∞_–ø—Ä–æ–¥–∞–∂.loc[–∫–æ–º–∞–Ω–¥–∞_–ø—Ä–æ–¥–∞–∂['–ü—Ä–æ–¥–∞–∂–∏'].idxmax(), '–ò–º—è']`
- "–°—Ä–µ–¥–Ω–∏–π –æ–ø—ã—Ç –∫–æ–º–∞–Ω–¥—ã?" ‚Üí `–∫–æ–º–∞–Ω–¥–∞_–ø—Ä–æ–¥–∞–∂['–û–ø—ã—Ç_–ª–µ—Ç'].mean()`

## üìÇ –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö ‚Äî –ø–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º

### üìÑ **CSV —Ñ–∞–π–ª—ã ‚Äî —Å–∞–º—ã–π –ø–æ–ø—É–ª—è—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç**

**CSV** ‚Äî —ç—Ç–æ –∫–∞–∫ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫ –º–µ–∂–¥—É —Ä–∞–∑–Ω—ã–º–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∞–º–∏.

```python
# –ë–∞–∑–æ–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ (—Ä–∞–±–æ—Ç–∞–µ—Ç –≤ 80% —Å–ª—É—á–∞–µ–≤)
df = pd.read_csv('–¥–∞–Ω–Ω—ã–µ.csv')

# –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ (–¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤)
df = pd.read_csv('–¥–∞–Ω–Ω—ã–µ.csv',
    encoding='utf-8',           # –î–ª—è —Ä—É—Å—Å–∫–∏—Ö –±—É–∫–≤
    sep=';',                    # –ï—Å–ª–∏ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å —Ç–æ—á–∫–∞ —Å –∑–∞–ø—è—Ç–æ–π
    decimal=',',                # –ï—Å–ª–∏ –¥–µ—Å—è—Ç–∏—á–Ω—ã–µ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é
    na_values=['', 'NULL', '–Ω/–¥'] # –ß—Ç–æ —Å—á–∏—Ç–∞—Ç—å –ø—Ä–æ–ø—É—Å–∫–∞–º–∏
)
```

**üí° –°–æ–≤–µ—Ç:** –ï—Å–ª–∏ —Ñ–∞–π–ª –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è ‚Äî –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å `encoding` –Ω–∞ `'cp1251'` –∏–ª–∏ `'windows-1251'`.

### üìä **Excel —Ñ–∞–π–ª—ã ‚Äî —Ä–æ–¥–Ω–∞—è —Å—Ç–∏—Ö–∏—è –æ—Ñ–∏—Å–Ω—ã—Ö —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤**

```python
# –ü—Ä–æ—Å—Ç–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
df = pd.read_excel('–æ—Ç—á–µ—Ç.xlsx')

# –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ª–∏—Å—Ç–∞
df = pd.read_excel('–æ—Ç—á–µ—Ç.xlsx', sheet_name='–ü—Ä–æ–¥–∞–∂–∏')

# –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ (–∫–∞–∫ –≤ Excel!)
df = pd.read_excel('–æ—Ç—á–µ—Ç.xlsx', 
                  usecols='A:F',     # –°—Ç–æ–ª–±—Ü—ã –æ—Ç A –¥–æ F
                  skiprows=2,        # –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å –∑–∞–≥–æ–ª–æ–≤–∫–∏
                  nrows=100)         # –¢–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–µ 100 —Å—Ç—Ä–æ–∫
```

### üóÑÔ∏è **–ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö ‚Äî –¥–ª—è —Å–µ—Ä—å–µ–∑–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤**

**–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** ‚Äî —ç—Ç–æ –∫–∞–∫ –æ–≥—Ä–æ–º–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞, –≥–¥–µ Pandas –∏–≥—Ä–∞–µ—Ç —Ä–æ–ª—å —É–º–Ω–æ–≥–æ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ä—è.

```python
import sqlite3

# –ü–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
conn = sqlite3.connect('–±–∞–∑–∞_–¥–∞–Ω–Ω—ã—Ö.db')

# –ì–æ–≤–æ—Ä–∏–º –Ω–∞ SQL, –ø–æ–ª—É—á–∞–µ–º Pandas DataFrame
df = pd.read_sql_query("""
    SELECT 
        –∫–ª–∏–µ–Ω—Ç,
        —Å—É–º–º–∞_–∑–∞–∫–∞–∑–∞,
        –¥–∞—Ç–∞_–∑–∞–∫–∞–∑–∞
    FROM –ø—Ä–æ–¥–∞–∂–∏ 
    WHERE –¥–∞—Ç–∞_–∑–∞–∫–∞–∑–∞ >= '2024-01-01'
""", conn)

print(df.head())
```

**–ú–∞–≥–∏—è:** –í—ã –ø–∏—à–µ—Ç–µ –Ω–∞ SQL, –∞ –ø–æ–ª—É—á–∞–µ—Ç–µ –¥–∞–Ω–Ω—ã–µ –≤ —É–¥–æ–±–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ Pandas!

## üîç –ü–µ—Ä–≤–∏—á–Ω—ã–π –∞–Ω–∞–ª–∏–∑ ‚Äî –∑–Ω–∞–∫–æ–º–∏–º—Å—è —Å –¥–∞–Ω–Ω—ã–º–∏

### üïµÔ∏è **"–î–µ—Ç–µ–∫—Ç–∏–≤–Ω–∞—è —Ä–∞–±–æ—Ç–∞" —Å –Ω–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏**

–ö–æ–≥–¥–∞ –≤—ã –ø–æ–ª—É—á–∏–ª–∏ –Ω–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ, –≤—Å–µ–≥–¥–∞ –Ω–∞—á–∏–Ω–∞–π—Ç–µ —Å "–¥–æ–ø—Ä–æ—Å–∞":

```python
# "–ü–∞—Å–ø–æ—Ä—Ç" –≤–∞—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö
print(f"–†–∞–∑–º–µ—Ä: {df.shape}")        # –°–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫ –∏ —Å—Ç–æ–ª–±—Ü–æ–≤?
print(df.info())                    # –ö–∞–∫–∏–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö?
print(df.describe())                # –ö–∞–∫–∏–µ —á–∏—Å–ª–∞ –≤ –¥–∞–Ω–Ω—ã—Ö?

# "–ü–µ—Ä–≤–æ–µ –∑–Ω–∞–∫–æ–º—Å—Ç–≤–æ"
print(df.head())                    # –ü–µ—Ä–≤—ã–µ 5 —Å—Ç—Ä–æ–∫
print(df.tail())                    # –ü–æ—Å–ª–µ–¥–Ω–∏–µ 5 —Å—Ç—Ä–æ–∫

# "–ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –ª–∏—á–Ω–æ—Å—Ç–∏"
print(df.isnull().sum())            # –ì–¥–µ –ø—Ä–æ–ø—É—Å–∫–∏?
print(df.duplicated().sum())        # –ï—Å—Ç—å –ª–∏ –¥—É–±–ª–∏–∫–∞—Ç—ã?
```

### üéØ **–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è**

```python
# –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–∞
df = pd.read_csv('–ø—Ä–æ–¥–∞–∂–∏_–º–∞–≥–∞–∑–∏–Ω–∞.csv')

# –ó–∞–¥–∞–µ–º –≤–æ–ø—Ä–æ—Å—ã –¥–∞–Ω–Ω—ã–º
print("üîç –ß—Ç–æ —É –Ω–∞—Å –µ—Å—Ç—å?")
print(f"üìä –ó–∞–∫–∞–∑–æ–≤: {len(df)}")
print(f"üë• –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤: {df['–∫–ª–∏–µ–Ω—Ç'].nunique()}")
print(f"üì¶ –†–∞–∑–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤: {df['—Ç–æ–≤–∞—Ä'].nunique()}")
print(f"üí∞ –û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞: {df['—Å—É–º–º–∞'].sum():,.2f} —Ä—É–±")

# –ò—â–µ–º –ø—Ä–æ–±–ª–µ–º—ã
print(f"\n‚ö†Ô∏è –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:")
print(f"‚ùå –ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: {df.isnull().sum().sum()}")
print(f"üîÑ –î—É–±–ª–∏–∫–∞—Ç—ã: {df.duplicated().sum()}")
print(f"üìâ –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ —Å—É–º–º—ã: {(df['—Å—É–º–º–∞'] < 0).sum()}")
```

## üßπ –û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö ‚Äî –Ω–∞–≤–æ–¥–∏–º –ø–æ—Ä—è–¥–æ–∫

### ‚ùå **–ë–æ—Ä—å–±–∞ —Å –ø—Ä–æ–ø—É—Å–∫–∞–º–∏ ‚Äî "–∑–∞–ø–æ–ª–Ω—è–µ–º –¥—ã—Ä—ã"**

**–ü—Ä–æ–ø—É—Å–∫–∏ –≤ –¥–∞–Ω–Ω—ã—Ö** ‚Äî —ç—Ç–æ –∫–∞–∫ –¥—ã—Ä—ã –≤ –¥–æ—Ä–æ–≥–µ. –ò—Ö –Ω—É–∂–Ω–æ –∏–ª–∏ –∑–∞–¥–µ–ª–∞—Ç—å, –∏–ª–∏ –æ–±—ä–µ—Ö–∞—Ç—å.

**4 —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Ä–∞–±–æ—Ç—ã —Å –ø—Ä–æ–ø—É—Å–∫–∞–º–∏:**

```python
# –°—Ç—Ä–∞—Ç–µ–≥–∏—è 1: "–£–¥–∞–ª—è–µ–º –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏"
df_—á–∏—Å—Ç—ã–π = df.dropna()

# –°—Ç—Ä–∞—Ç–µ–≥–∏—è 2: "–ó–∞–ø–æ–ª–Ω—è–µ–º —Å—Ä–µ–¥–Ω–∏–º –∑–Ω–∞—á–µ–Ω–∏–µ–º"
df['—Ü–µ–Ω–∞'] = df['—Ü–µ–Ω–∞'].fillna(df['—Ü–µ–Ω–∞'].mean())

# –°—Ç—Ä–∞—Ç–µ–≥–∏—è 3: "–ó–∞–ø–æ–ª–Ω—è–µ–º —Å–∞–º—ã–º —á–∞—Å—Ç—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º"
–ø–æ–ø—É–ª—è—Ä–Ω–∞—è_–∫–∞—Ç–µ–≥–æ—Ä–∏—è = df['–∫–∞—Ç–µ–≥–æ—Ä–∏—è'].mode()[0]
df['–∫–∞—Ç–µ–≥–æ—Ä–∏—è'] = df['–∫–∞—Ç–µ–≥–æ—Ä–∏—è'].fillna(–ø–æ–ø—É–ª—è—Ä–Ω–∞—è_–∫–∞—Ç–µ–≥–æ—Ä–∏—è)

# –°—Ç—Ä–∞—Ç–µ–≥–∏—è 4: "–£–º–Ω–æ–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ –≥—Ä—É–ø–ø–∞–º"
df['—Ü–µ–Ω–∞'] = df.groupby('–∫–∞—Ç–µ–≥–æ—Ä–∏—è')['—Ü–µ–Ω–∞'].transform(
    lambda x: x.fillna(x.mean())
)
```

**üí° –ó–æ–ª–æ—Ç–æ–µ –ø—Ä–∞–≤–∏–ª–æ:** –ï—Å–ª–∏ –ø—Ä–æ–ø—É—Å–∫–æ–≤ –±–æ–ª—å—à–µ 30% ‚Äî –ø–æ–¥—É–º–∞–π—Ç–µ, –Ω—É–∂–µ–Ω –ª–∏ –≤–∞–º —ç—Ç–æ—Ç —Å—Ç–æ–ª–±–µ—Ü.

### üóëÔ∏è **–ë–æ—Ä—å–±–∞ —Å –¥—É–±–ª–∏–∫–∞—Ç–∞–º–∏ ‚Äî "—É–±–∏—Ä–∞–µ–º –±–ª–∏–∑–Ω–µ—Ü–æ–≤"**

**–î—É–±–ª–∏–∫–∞—Ç—ã** ‚Äî —ç—Ç–æ –∫–∞–∫ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –ª—é–¥–∏ –Ω–∞ –≤–µ—á–µ—Ä–∏–Ω–∫–µ. –û–¥–∏–Ω –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π, –¥–≤–∞ ‚Äî —É–∂–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ.

```python
# –ù–∞—Ö–æ–¥–∏–º –∏ —É–¥–∞–ª—è–µ–º –ø–æ–ª–Ω—ã–µ –¥—É–±–ª–∏–∫–∞—Ç—ã
print(f"–î—É–±–ª–∏–∫–∞—Ç–æ–≤ –Ω–∞–π–¥–µ–Ω–æ: {df.duplicated().sum()}")
df = df.drop_duplicates()

# –£–¥–∞–ª—è–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã –ø–æ –∫–ª—é—á–µ–≤–æ–º—É –ø–æ–ª—é
df = df.drop_duplicates(subset=['–Ω–æ–º–µ—Ä_–∑–∞–∫–∞–∑–∞'], keep='last')

# –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–æ–ª—å–∫–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤
—É–Ω–∏–∫–∞–ª—å–Ω—ã–µ_–∫–ª–∏–µ–Ω—Ç—ã = df.drop_duplicates(subset=['email_–∫–ª–∏–µ–Ω—Ç–∞'])
```

### üîÑ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–æ–≤ ‚Äî "–ø–µ—Ä–µ–≤–æ–¥–∏–º –Ω–∞ –ø–æ–Ω—è—Ç–Ω—ã–π —è–∑—ã–∫"**

**–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã** ‚Äî —ç—Ç–æ –∫–∞–∫ –ª—é–¥–∏, –≥–æ–≤–æ—Ä—è—â–∏–µ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —è–∑—ã–∫–∞—Ö. –ù—É–∂–µ–Ω –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫.

```python
# –ò—Å–ø—Ä–∞–≤–ª—è–µ–º –¥–∞—Ç—ã
df['–¥–∞—Ç–∞'] = pd.to_datetime(df['–¥–∞—Ç–∞'], format='%d.%m.%Y')

# –ò—Å–ø—Ä–∞–≤–ª—è–µ–º —á–∏—Å–ª–∞ (—É–±–∏—Ä–∞–µ–º —Å–∏–º–≤–æ–ª—ã –≤–∞–ª—é—Ç)
df['—Ü–µ–Ω–∞'] = df['—Ü–µ–Ω–∞'].str.replace('‚ÇΩ', '').str.replace(' ', '')
df['—Ü–µ–Ω–∞'] = pd.to_numeric(df['—Ü–µ–Ω–∞'], errors='coerce')

# –ò—Å–ø—Ä–∞–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç (—É–±–∏—Ä–∞–µ–º –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã)
df['–Ω–∞–∑–≤–∞–Ω–∏–µ'] = df['–Ω–∞–∑–≤–∞–Ω–∏–µ'].str.strip().str.title()

# –°–æ–∑–¥–∞–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏–∑ —á–∏—Å–µ–ª
df['—Ü–µ–Ω–æ–≤–∞—è_–∫–∞—Ç–µ–≥–æ—Ä–∏—è'] = pd.cut(df['—Ü–µ–Ω–∞'], 
    bins=[0, 1000, 5000, 20000, float('inf')],
    labels=['–ë—é–¥–∂–µ—Ç', '–°—Ç–∞–Ω–¥–∞—Ä—Ç', '–ü—Ä–µ–º–∏—É–º', '–õ—é–∫—Å']
)
```

## üîß –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö ‚Äî –ø—Ä–∏–¥–∞–µ–º –Ω—É–∂–Ω—É—é —Ñ–æ—Ä–º—É

### üè∑Ô∏è **–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö "—Å—É–ø–µ—Ä—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π" –¥–ª—è –¥–∞–Ω–Ω—ã—Ö**

```python
# –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–µ –ø–æ–ª–µ–∑–Ω—ã–µ —Å—Ç–æ–ª–±—Ü—ã
df['–ø—Ä–∏–±—ã–ª—å'] = df['–≤—ã—Ä—É—á–∫–∞'] - df['—Ä–∞—Å—Ö–æ–¥—ã']
df['–º–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å'] = df['–ø—Ä–∏–±—ã–ª—å'] / df['–≤—ã—Ä—É—á–∫–∞'] * 100

# –ò–∑–≤–ª–µ–∫–∞–µ–º —á–∞—Å—Ç–∏ –∏–∑ –¥–∞—Ç
df['–≥–æ–¥'] = df['–¥–∞—Ç–∞_–∑–∞–∫–∞–∑–∞'].dt.year
df['–º–µ—Å—è—Ü'] = df['–¥–∞—Ç–∞_–∑–∞–∫–∞–∑–∞'].dt.month
df['–¥–µ–Ω—å_–Ω–µ–¥–µ–ª–∏'] = df['–¥–∞—Ç–∞_–∑–∞–∫–∞–∑–∞'].dt.day_name()

# –°–æ–∑–¥–∞–µ–º —É–º–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
def –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å_—Ä–∞–∑–º–µ—Ä_–∫–ª–∏–µ–Ω—Ç–∞(—Å—É–º–º–∞_–ø–æ–∫—É–ø–æ–∫):
    if —Å—É–º–º–∞_–ø–æ–∫—É–ø–æ–∫ < 10000:
        return '–ú–∞–ª—ã–π'
    elif —Å—É–º–º–∞_–ø–æ–∫—É–ø–æ–∫ < 50000:
        return '–°—Ä–µ–¥–Ω–∏–π'
    else:
        return '–ö—Ä—É–ø–Ω—ã–π'

df['—Ä–∞–∑–º–µ—Ä_–∫–ª–∏–µ–Ω—Ç–∞'] = df['–æ–±—â–∞—è_—Å—É–º–º–∞'].apply(–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å_—Ä–∞–∑–º–µ—Ä_–∫–ª–∏–µ–Ω—Ç–∞)
```

### üìä **–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ ‚Äî –Ω–∞—Ö–æ–¥–∏–º –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏**

**–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞** ‚Äî —ç—Ç–æ –∫–∞–∫ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –≤–µ—â–µ–π –ø–æ –∫–æ—Ä–æ–±–∫–∞–º, –Ω–æ –∫–∞–∂–¥–∞—è –∫–æ—Ä–æ–±–∫–∞ —É–º–µ–µ—Ç —Å—á–∏—Ç–∞—Ç—å —Å–≤–æ—ë —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ.

```python
# –ü—Ä–æ—Å—Ç–∞—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ ‚Äî –ø—Ä–æ–¥–∞–∂–∏ –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º
–ø—Ä–æ–¥–∞–∂–∏_–ø–æ_—Ä–µ–≥–∏–æ–Ω–∞–º = df.groupby('—Ä–µ–≥–∏–æ–Ω')['—Å—É–º–º–∞'].sum()
print(–ø—Ä–æ–¥–∞–∂–∏_–ø–æ_—Ä–µ–≥–∏–æ–Ω–∞–º)

# –°–ª–æ–∂–Ω–∞—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ ‚Äî –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π —Å—Ä–∞–∑—É
—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ = df.groupby('–∫–∞—Ç–µ–≥–æ—Ä–∏—è_—Ç–æ–≤–∞—Ä–∞').agg({
    '—Å—É–º–º–∞': ['sum', 'mean', 'count'],
    '–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ': 'sum',
    '–∫–ª–∏–µ–Ω—Ç': 'nunique'
}).round(2)

print(—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞)
```

**–ù–∞ —á–µ–ª–æ–≤–µ—á–µ—Å–∫–æ–º —è–∑—ã–∫–µ:**
- "–°–∫–æ–ª—å–∫–æ –º—ã –∑–∞—Ä–∞–±–æ—Ç–∞–ª–∏ –≤ –∫–∞–∂–¥–æ–º —Ä–µ–≥–∏–æ–Ω–µ?" ‚Üí `df.groupby('—Ä–µ–≥–∏–æ–Ω')['–≤—ã—Ä—É—á–∫–∞'].sum()`
- "–ö—Ç–æ –Ω–∞—à–∏ –ª—É—á—à–∏–µ –∫–ª–∏–µ–Ω—Ç—ã?" ‚Üí `df.groupby('–∫–ª–∏–µ–Ω—Ç')['—Å—É–º–º–∞'].sum().nlargest(10)`
- "–í –∫–∞–∫–æ–π –¥–µ–Ω—å –Ω–µ–¥–µ–ª–∏ –±–æ–ª—å—à–µ –ø—Ä–æ–¥–∞–∂?" ‚Üí `df.groupby('–¥–µ–Ω—å_–Ω–µ–¥–µ–ª–∏')['—Å—É–º–º–∞'].mean()`

### üîÑ **–°–≤–æ–¥–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã ‚Äî Excel –Ω–∞ —Å—Ç–µ—Ä–æ–∏–¥–∞—Ö**

```python
# –°–æ–∑–¥–∞–µ–º —Å–≤–æ–¥–Ω—É—é —Ç–∞–±–ª–∏—Ü—É (–∫–∞–∫ –≤ Excel, –Ω–æ –º–æ—â–Ω–µ–µ!)
—Å–≤–æ–¥–Ω–∞—è = pd.pivot_table(
    df,
    values='—Å—É–º–º–∞',          # –ß—Ç–æ —Å—á–∏—Ç–∞–µ–º
    index='—Ä–µ–≥–∏–æ–Ω',          # –ü–æ —Å—Ç—Ä–æ–∫–∞–º
    columns='–º–µ—Å—è—Ü',         # –ü–æ —Å—Ç–æ–ª–±—Ü–∞–º  
    aggfunc='sum',           # –ö–∞–∫ —Å—á–∏—Ç–∞–µ–º
    fill_value=0,            # –ß–µ–º –∑–∞–ø–æ–ª–Ω–∏—Ç—å –ø—É—Å—Ç–æ—Ç—ã
    margins=True             # –î–æ–±–∞–≤–∏—Ç—å –∏—Ç–æ–≥–∏
)

print(—Å–≤–æ–¥–Ω–∞—è)
```

## ü§ù –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö ‚Äî —Å–æ–µ–¥–∏–Ω—è–µ–º –ø–∞–∑–ª—ã

### üß© **Merge ‚Äî —É–º–Ω–æ–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü**

**–û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü** ‚Äî —ç—Ç–æ –∫–∞–∫ –∑–Ω–∞–∫–æ–º—Å—Ç–≤–æ –ª—é–¥–µ–π –Ω–∞ –≤–µ—á–µ—Ä–∏–Ω–∫–µ –ø–æ –æ–±—â–∏–º –∏–Ω—Ç–µ—Ä–µ—Å–∞–º.

```python
# –£ –Ω–∞—Å –µ—Å—Ç—å –¥–≤–µ —Ç–∞–±–ª–∏—Ü—ã
–∫–ª–∏–µ–Ω—Ç—ã = pd.DataFrame({
    'id': [1, 2, 3],
    '–∏–º—è': ['–ò–≤–∞–Ω', '–ú–∞—Ä–∏—è', '–ü–µ—Ç—Ä'],
    '–≥–æ—Ä–æ–¥': ['–ú–æ—Å–∫–≤–∞', '–°–ü–±', '–ö–∞–∑–∞–Ω—å']
})

–∑–∞–∫–∞–∑—ã = pd.DataFrame({
    '–∫–ª–∏–µ–Ω—Ç_id': [1, 1, 2, 3],
    '—Ç–æ–≤–∞—Ä': ['–¢–µ–ª–µ—Ñ–æ–Ω', '–ü–ª–∞–Ω—à–µ—Ç', '–ù–æ—É—Ç–±—É–∫', '–ú—ã—à–∫–∞'],
    '—Å—É–º–º–∞': [50000, 30000, 80000, 1500]
})

# –û–±—ä–µ–¥–∏–Ω—è–µ–º "–ø–æ –∑–Ω–∞–∫–æ–º—Å—Ç–≤—É" (–ø–æ ID –∫–ª–∏–µ–Ω—Ç–∞)
–ø–æ–ª–Ω–∞—è_–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è = pd.merge(
    –∑–∞–∫–∞–∑—ã, 
    –∫–ª–∏–µ–Ω—Ç—ã, 
    left_on='–∫–ª–∏–µ–Ω—Ç_id', 
    right_on='id', 
    how='left'  # –û—Å—Ç–∞–≤–ª—è–µ–º –≤—Å–µ –∑–∞–∫–∞–∑—ã
)

print(–ø–æ–ª–Ω–∞—è_–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è)
```

**–¢–∏–ø—ã –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–π:**
- ü§ù `inner` ‚Äî "—Ç–æ–ª—å–∫–æ –æ–±—â–∏–µ –∑–Ω–∞–∫–æ–º—ã–µ" (–ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ)
- ‚¨ÖÔ∏è `left` ‚Äî "–≤—Å–µ –∏–∑ –ª–µ–≤–æ–π —Ç–∞–±–ª–∏—Ü—ã + —á—Ç–æ –Ω–∞–π–¥–µ—Ç—Å—è —Å–ø—Ä–∞–≤–∞"
- ‚û°Ô∏è `right` ‚Äî "–≤—Å–µ –∏–∑ –ø—Ä–∞–≤–æ–π —Ç–∞–±–ª–∏—Ü—ã + —á—Ç–æ –Ω–∞–π–¥–µ—Ç—Å—è —Å–ª–µ–≤–∞" 
- üîÑ `outer` ‚Äî "–≤—Å–µ—Ö –ø–æ–¥—Ä—è–¥, –¥–∞–∂–µ –µ—Å–ª–∏ –Ω–µ –∑–Ω–∞–∫–æ–º—ã"

## üéØ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å SQL ‚Äî –ª—É—á—à–µ–µ –∏–∑ –¥–≤—É—Ö –º–∏—Ä–æ–≤

### üóÑÔ∏è **Pandas + SQL = –°—É–ø–µ—Ä—Å–∏–ª–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞**

–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ SQL ‚Äî —ç—Ç–æ –º–æ—â–Ω—ã–π —ç–∫—Å–∫–∞–≤–∞—Ç–æ—Ä –¥–ª—è –¥–æ–±—ã—á–∏ –¥–∞–Ω–Ω—ã—Ö, –∞ Pandas ‚Äî —ç—Ç–æ —é–≤–µ–ª–∏—Ä–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –∏—Ö –æ–≥—Ä–∞–Ω–∫–∏.

```python
import sqlite3

# –ü–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
conn = sqlite3.connect('sample_database.db')

# SQL –¥–µ–ª–∞–µ—Ç –≥—Ä—É–±—É—é —Ä–∞–±–æ—Ç—É ‚Äî –≤—ã–±–∏—Ä–∞–µ—Ç –Ω—É–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
sql_query = """
SELECT 
    c.customer_name,
    c.customer_segment,
    o.total_amount,
    o.order_date
FROM customers c
JOIN orders o ON c.customer_id = o.customer_id
WHERE o.order_date >= '2024-01-01'
"""

# Pandas –¥–µ–ª–∞–µ—Ç —Ç–æ–Ω–∫—É—é —Ä–∞–±–æ—Ç—É ‚Äî –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∏ –æ–±–æ–≥–∞—â–∞–µ—Ç
df = pd.read_sql_query(sql_query, conn)
df['order_date'] = pd.to_datetime(df['order_date'])
df['–º–µ—Å—è—Ü'] = df['order_date'].dt.month
df['revenue_category'] = pd.qcut(df['total_amount'], 3, labels=['Low', 'Medium', 'High'])

# –†–µ–∑—É–ª—å—Ç–∞—Ç ‚Äî –∫—Ä–∞—Å–∏–≤–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
monthly_analysis = df.groupby(['–º–µ—Å—è—Ü', 'customer_segment']).agg({
    'total_amount': ['sum', 'mean', 'count']
}).round(2)

print(monthly_analysis)
```

### üîÑ **ETL –ø—Ä–æ—Ü–µ—Å—Å—ã ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–µ–º —Ä—É—Ç–∏–Ω—É**

**ETL** (Extract-Transform-Load) ‚Äî —ç—Ç–æ –∫–æ–Ω–≤–µ–π–µ—Ä –ø–æ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤—É —á–∏—Å—Ç—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

```python
def create_etl_pipeline():
    """–°–æ–∑–¥–∞–µ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∫–æ–Ω–≤–µ–π–µ—Ä –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö"""
    
    # Extract ‚Äî –∏–∑–≤–ª–µ–∫–∞–µ–º –¥–∞–Ω–Ω—ã–µ
    print("üì• –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö...")
    raw_data = pd.read_sql_query("SELECT * FROM raw_sales", conn)
    
    # Transform ‚Äî –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –¥–∞–Ω–Ω—ã–µ
    print("üîÑ –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö...")
    clean_data = raw_data.copy()
    clean_data = clean_data.dropna()  # –£–±–∏—Ä–∞–µ–º –ø—Ä–æ–ø—É—Å–∫–∏
    clean_data['profit'] = clean_data['revenue'] - clean_data['cost']  # –°—á–∏—Ç–∞–µ–º –ø—Ä–∏–±—ã–ª—å
    clean_data['date'] = pd.to_datetime(clean_data['date'])  # –ò—Å–ø—Ä–∞–≤–ª—è–µ–º –¥–∞—Ç—ã
    
    # Load ‚Äî –∑–∞–≥—Ä—É–∂–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ–±—Ä–∞—Ç–Ω–æ –≤ –±–∞–∑—É
    print("üì§ –ó–∞–≥—Ä—É–∑–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞...")
    clean_data.to_sql('clean_sales', conn, if_exists='replace', index=False)
    
    print("‚úÖ ETL –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–≤–µ—Ä—à–µ–Ω!")
    return clean_data

# –ó–∞–ø—É—Å–∫–∞–µ–º –∫–æ–Ω–≤–µ–π–µ—Ä
result = create_etl_pipeline()
```

## üí° –ó–æ–ª–æ—Ç—ã–µ –ø—Ä–∞–≤–∏–ª–∞ —Ä–∞–±–æ—Ç—ã —Å Pandas

### üéØ **–ü—Ä–∏–Ω—Ü–∏–ø—ã —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π —Ä–∞–±–æ—Ç—ã:**

1. **üëÄ –°–Ω–∞—á–∞–ª–∞ –ø–æ—Å–º–æ—Ç—Ä–∏, –ø–æ—Ç–æ–º –¥–µ–ª–∞–π**
   ```python
   df.head()     # –ß—Ç–æ —É –Ω–∞—Å –µ—Å—Ç—å?
   df.info()     # –ö–∞–∫–∏–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö?
   df.describe() # –ö–∞–∫–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞?
   ```

2. **üíæ –í—Å–µ–≥–¥–∞ –¥–µ–ª–∞–π –∫–æ–ø–∏–∏**
   ```python
   df_backup = df.copy()  # –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª
   ```

3. **üîç –ü—Ä–æ–≤–µ—Ä—è–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã**
   ```python
   print(f"–ë—ã–ª–æ: {len(df_original)} —Å—Ç—Ä–æ–∫")
   print(f"–°—Ç–∞–ª–æ: {len(df_clean)} —Å—Ç—Ä–æ–∫")
   ```

4. **üìù –ö–æ–º–º–µ–Ω—Ç–∏—Ä—É–π —Å–ª–æ–∂–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏**
   ```python
   # –£–±–∏—Ä–∞–µ–º –∑–∞–∫–∞–∑—ã —Å –Ω—É–ª–µ–≤–æ–π —Å—É–º–º–æ–π (—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∑–∞–ø–∏—Å–∏)
   df = df[df['—Å—É–º–º–∞'] > 0]
   ```

### ‚ö° **–ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏ –∏ –∫–∞–∫ –∏—Ö –∏–∑–±–µ–∂–∞—Ç—å:**

‚ùå **–û—à–∏–±–∫–∞:** –ó–∞–±—ã–ª —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
```python
df.dropna()  # –ù–∏—á–µ–≥–æ –Ω–µ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å!
```
‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–æ:**
```python
df = df.dropna()  # –¢–µ–ø–µ—Ä—å –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã
```

‚ùå **–û—à–∏–±–∫–∞:** –ù–µ –ø—Ä–æ–≤–µ—Ä–∏–ª —Ä–µ–∑—É–ª—å—Ç–∞—Ç
```python
df['—Ü–µ–Ω–∞'] = pd.to_numeric(df['—Ü–µ–Ω–∞'])  # –ú–æ–∂–µ—Ç —É–ø–∞—Å—Ç—å —Å –æ—à–∏–±–∫–æ–π
```
‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–æ:**
```python
df['—Ü–µ–Ω–∞'] = pd.to_numeric(df['—Ü–µ–Ω–∞'], errors='coerce')  # –ë–µ–∑–æ–ø–∞—Å–Ω–æ
print(f"–ü—Ä–æ–ø—É—Å–∫–æ–≤ –ø–æ—Å–ª–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è: {df['—Ü–µ–Ω–∞'].isnull().sum()}")
```

## üöÄ –ß—Ç–æ –¥–∞–ª—å—à–µ?

–ü–æ—Å–ª–µ –æ—Å–≤–æ–µ–Ω–∏—è —ç—Ç–æ–π –≥–ª–∞–≤—ã –≤—ã —Å–º–æ–∂–µ—Ç–µ:

‚úÖ **–ó–∞–≥—Ä—É–∂–∞—Ç—å –¥–∞–Ω–Ω—ã–µ** –∏–∑ –ª—é–±—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤  
‚úÖ **–û—á–∏—â–∞—Ç—å "–≥—Ä—è–∑–Ω—ã–µ" –¥–∞–Ω–Ω—ã–µ** –∏ –ø—Ä–∏–≤–æ–¥–∏—Ç—å –∏—Ö –≤ –ø–æ—Ä—è–¥–æ–∫  
‚úÖ **–ù–∞—Ö–æ–¥–∏—Ç—å –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏** —Å –ø–æ–º–æ—â—å—é –≥—Ä—É–ø–ø–∏—Ä–æ–≤–æ–∫  
‚úÖ **–û–±—ä–µ–¥–∏–Ω—è—Ç—å –¥–∞–Ω–Ω—ã–µ** –∏–∑ —Ä–∞–∑–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤  
‚úÖ **–°–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏** –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞  
‚úÖ **–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å Pandas —Å SQL** –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –º–æ—â–∏

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ù–∞—É—á–∏—Ç—å—Å—è –∫—Ä–∞—Å–∏–≤–æ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏!

## üõ† –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏

–¢–µ–ø–µ—Ä—å –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫ –ø—Ä–∞–∫—Ç–∏–∫–µ ‚Äî —Ç–∞–º –≤–∞—Å –∂–¥—É—Ç 5 —Ä–µ–∞–ª—å–Ω—ã—Ö –±–∏–∑–Ω–µ—Å-—Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –≤—Å–µ—Ö –∏–∑—É—á–µ–Ω–Ω—ã—Ö –∫–æ–Ω—Ü–µ–ø—Ü–∏–π:

- üìù [–ü–µ—Ä–µ–π—Ç–∏ –∫ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–º –∑–∞–¥–∞–Ω–∏—è–º](practice.md)
- ‚úÖ [–ü–µ—Ä–µ–π—Ç–∏ –∫ —á–µ–∫-–ª–∏—Å—Ç—É](checklist.md)
- üìÅ [–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —É—á–µ–±–Ω—ã–µ —Ñ–∞–π–ª—ã](files/README.md)

---

- üîô [–ü—Ä–µ–¥—ã–¥—É—â–∞—è –≥–ª–∞–≤–∞: –ì–ª–∞–≤–∞ 13 - –û—Å–Ω–æ–≤—ã DAX: –≤—ã—á–∏—Å–ª—è–µ–º—ã–µ —Å—Ç–æ–ª–±—Ü—ã –∏ –º–µ—Ä—ã](../chapter-13/README.md)
- üîú [–°–ª–µ–¥—É—é—â–∞—è –≥–ª–∞–≤–∞: –ì–ª–∞–≤–∞ 15 - –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤ Python: Matplotlib –∏ Seaborn](../chapter-15/README.md)

---

- üì¢ –ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Ç–µ—Å—å –∫ —á–∞—Ç—É –∫—É—Ä—Å–∞: [https://t.me/analytics_course_chat](https://t.me/analytics_course_chat)
- üì¢ –ö–∞–Ω–∞–ª –∫—É—Ä—Å–∞: [https://t.me/analytics_course_channel](https://t.me/analytics_course_channel)