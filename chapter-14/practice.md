# üìù –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞–Ω–∏—è –¥–ª—è –≥–ª–∞–≤—ã 14

üìñ [–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Ç–µ–æ—Ä–∏–∏](../README.md) | üìÅ [–£—á–µ–±–Ω—ã–µ —Ñ–∞–π–ª—ã](../files/README.md) | ‚úÖ [–ß–µ–∫-–ª–∏—Å—Ç](../checklist.md)

**üéØ –¶–µ–ª—å:** –°—Ç–∞—Ç—å –Ω–∞—Å—Ç–æ—è—â–∏–º "–¥–æ–∫—Ç–æ—Ä–æ–º –¥–∞–Ω–Ω—ã—Ö" ‚Äî –Ω–∞—É—á–∏—Ç—å—Å—è –ª–µ—á–∏—Ç—å "–±–æ–ª—å–Ω—ã–µ" –¥–∞–Ω–Ω—ã–µ –∏ –ø—Ä–µ–≤—Ä–∞—â–∞—Ç—å –∏—Ö –≤ –ø–æ–ª–µ–∑–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é!

## üè• –ó–∞–¥–∞–Ω–∏–µ 1: "–î–æ–∫—Ç–æ—Ä –¥–∞–Ω–Ω—ã—Ö" ‚Äî –ª–µ—á–∏–º –≥—Ä—è–∑–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

**üé¨ –í–∞—à–∞ —Ä–æ–ª—å:** –í—ã ‚Äî –Ω–æ–≤—ã–π –∞–Ω–∞–ª–∏—Ç–∏–∫ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–µ. –í–∞–º –¥–∞–ª–∏ "–≥—Ä—è–∑–Ω—ã–µ" –¥–∞–Ω–Ω—ã–µ —Å –∫—É—á–µ–π –ø—Ä–æ–±–ª–µ–º. –ù—É–∂–Ω–æ –∏—Ö –≤—ã–ª–µ—á–∏—Ç—å!

**üìã –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:**
1. –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏ –ø—Ä–æ–≤–µ—Å—Ç–∏ "–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É"
2. –ù–∞–π—Ç–∏ –≤—Å–µ –ø—Ä–æ–±–ª–µ–º—ã –≤ –¥–∞–Ω–Ω—ã—Ö
3. –í—ã–ª–µ—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ—à–∞–≥–æ–≤–æ
4. –°–æ–∑–¥–∞—Ç—å –æ—Ç—á–µ—Ç –æ –ø—Ä–æ–¥–µ–ª–∞–Ω–Ω–æ–π —Ä–∞–±–æ—Ç–µ

**üìÅ –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ñ–∞–π–ª—ã:** `files/messy_ecommerce_data.csv`, `files/data-cleaning-template.py`

### üöÄ **–®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ä–∞–±–æ—á–µ–≥–æ –º–µ—Å—Ç–∞**

**üíª –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é –ø–∞–ø–∫—É –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞ –∏ –æ—Ç–∫—Ä–æ–π—Ç–µ Python:**

```python
import pandas as pd
import numpy as np
from datetime import datetime
import matplotlib.pyplot as plt

print("üè• –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –∫–ª–∏–Ω–∏–∫—É –¥–∞–Ω–Ω—ã—Ö!")
print("–°–µ–≥–æ–¥–Ω—è –º—ã –±—É–¥–µ–º –ª–µ—á–∏—Ç—å –±–æ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ e-commerce –º–∞–≥–∞–∑–∏–Ω–∞")
```

### üîç **–®–∞–≥ 2: –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø–∞—Ü–∏–µ–Ω—Ç–∞**

```python
# –ó–∞–≥—Ä—É–∂–∞–µ–º "–±–æ–ª—å–Ω–æ–≥–æ –ø–∞—Ü–∏–µ–Ω—Ç–∞"
try:
    df = pd.read_csv('files/messy_ecommerce_data.csv')
    print(f"‚úÖ –ü–∞—Ü–∏–µ–Ω—Ç –∑–∞–≥—Ä—É–∂–µ–Ω: {len(df)} –∑–∞–ø–∏—Å–µ–π")
except FileNotFoundError:
    print("‚ùå –§–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω! –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ messy_ecommerce_data.csv –≤ –ø–∞–ø–∫–µ files/")
    exit()

# –ü–µ—Ä–≤–∏—á–Ω—ã–π –æ—Å–º–æ—Ç—Ä –ø–∞—Ü–∏–µ–Ω—Ç–∞
print(f"\nüîç –ü–ï–†–í–ò–ß–ù–ê–Ø –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê")
print("=" * 30)
print(f"üìè –†–∞–∑–º–µ—Ä: {df.shape[0]} —Å—Ç—Ä–æ–∫, {df.shape[1]} —Å—Ç–æ–ª–±—Ü–æ–≤")
print(f"üìã –°—Ç–æ–ª–±—Ü—ã: {list(df.columns)}")

# –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—ã–µ —Å—Ç—Ä–æ–∫–∏ (–∫–∞–∫ —Å–Ω–∏–º–æ–∫)
print(f"\nüì∏ –°–Ω–∏–º–æ–∫ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–∞—Ü–∏–µ–Ω—Ç–∞:")
print(df.head())

# –ò—â–µ–º —Å–∏–º–ø—Ç–æ–º—ã –±–æ–ª–µ–∑–Ω–∏
print(f"\nü©∫ –ü–û–ò–°–ö –°–ò–ú–ü–¢–û–ú–û–í:")
print(f"‚ùå –ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è: {df.isnull().sum().sum()}")
print(f"üîÑ –î—É–±–ª–∏–∫–∞—Ç—ã: {df.duplicated().sum()}")
print(f"üìä –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö:")
for col, dtype in df.dtypes.items():
    print(f"   {col}: {dtype}")
```

### üßπ **–®–∞–≥ 3: –õ–µ—á–µ–Ω–∏–µ ‚Äî —ç—Ç–∞–ø –∑–∞ —ç—Ç–∞–ø–æ–º**

**–õ–µ—á–µ–Ω–∏–µ 1: –£–¥–∞–ª—è–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã**
```python
print(f"\nüíä –õ–ï–ß–ï–ù–ò–ï 1: –£–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤")
print("-" * 35)

–¥—É–±–ª–∏–∫–∞—Ç—ã_–¥–æ = df.duplicated().sum()
print(f"üîç –ù–∞–π–¥–µ–Ω–æ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤: {–¥—É–±–ª–∏–∫–∞—Ç—ã_–¥–æ}")

# –£–¥–∞–ª—è–µ–º –ø–æ–ª–Ω—ã–µ –¥—É–±–ª–∏–∫–∞—Ç—ã
df = df.drop_duplicates()

# –£–¥–∞–ª—è–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã –ø–æ ID –∑–∞–∫–∞–∑–∞ (–æ—Å—Ç–∞–≤–ª—è–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–π)
if 'order_id' in df.columns:
    –¥—É–±–ª–∏–∫–∞—Ç—ã_id_–¥–æ = df.duplicated(subset=['order_id']).sum()
    df = df.drop_duplicates(subset=['order_id'], keep='last')
    print(f"üßπ –£–¥–∞–ª–µ–Ω–æ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –ø–æ order_id: {–¥—É–±–ª–∏–∫–∞—Ç—ã_id_–¥–æ}")

—Å—Ç—Ä–æ–∫_—É–¥–∞–ª–µ–Ω–æ = –¥—É–±–ª–∏–∫–∞—Ç—ã_–¥–æ - df.duplicated().sum()
print(f"‚úÖ –£–¥–∞–ª–µ–Ω–æ —Å—Ç—Ä–æ–∫: {—Å—Ç—Ä–æ–∫_—É–¥–∞–ª–µ–Ω–æ}")
print(f"üìä –û—Å—Ç–∞–ª–æ—Å—å —Å—Ç—Ä–æ–∫: {len(df)}")
```

**–õ–µ—á–µ–Ω–∏–µ 2: –ò—Å–ø—Ä–∞–≤–ª—è–µ–º —Ñ–æ—Ä–º–∞—Ç—ã –¥–∞–Ω–Ω—ã—Ö**
```python
print(f"\nüíä –õ–ï–ß–ï–ù–ò–ï 2: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–æ–≤")
print("-" * 32)

# –õ–µ—á–∏–º —Ü–µ–Ω—ã (—É–±–∏—Ä–∞–µ–º —Å–∏–º–≤–æ–ª—ã –≤–∞–ª—é—Ç)
if 'price' in df.columns:
    print("üîß –õ–µ—á–∏–º —Å—Ç–æ–ª–±–µ—Ü 'price'...")
    
    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–æ–±–ª–µ–º—ã
    print(f"   –ü—Ä–∏–º–µ—Ä—ã –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö —Ü–µ–Ω: {df['price'].head().tolist()}")
    
    # –°–æ–∑–¥–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é –ª–µ—á–µ–Ω–∏—è —Ü–µ–Ω
    def –ª–µ—á–∏—Ç—å_—Ü–µ–Ω—É(—Ü–µ–Ω–∞):
        if pd.isna(—Ü–µ–Ω–∞) or —Ü–µ–Ω–∞ == '':
            return np.nan
        
        # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ —Å—Ç—Ä–æ–∫—É –∏ —á–∏—Å—Ç–∏–º
        —Ü–µ–Ω–∞_str = str(—Ü–µ–Ω–∞)
        —Ü–µ–Ω–∞_str = —Ü–µ–Ω–∞_str.replace('$', '').replace('‚ÇΩ', '').replace(' USD', '')
        —Ü–µ–Ω–∞_str = —Ü–µ–Ω–∞_str.replace(',', '.').replace(' ', '')
        
        # –£–±–∏—Ä–∞–µ–º –≤—Å–µ –∫—Ä–æ–º–µ —Ü–∏—Ñ—Ä, —Ç–æ—á–µ–∫ –∏ –º–∏–Ω—É—Å–æ–≤
        import re
        —Ü–µ–Ω–∞_str = re.sub(r'[^\d.\-]', '', —Ü–µ–Ω–∞_str)
        
        try:
            return float(—Ü–µ–Ω–∞_str)
        except:
            return np.nan
    
    # –ü—Ä–∏–º–µ–Ω—è–µ–º –ª–µ—á–µ–Ω–∏–µ
    df['price'] = df['price'].apply(–ª–µ—á–∏—Ç—å_—Ü–µ–Ω—É)
    —É—Å–ø–µ—à–Ω—ã—Ö_—Ü–µ–Ω = df['price'].notna().sum()
    print(f"   ‚úÖ –í—ã–ª–µ—á–µ–Ω–æ —Ü–µ–Ω: {—É—Å–ø–µ—à–Ω—ã—Ö_—Ü–µ–Ω}")

# –õ–µ—á–∏–º –¥–∞—Ç—ã
if 'order_date' in df.columns:
    print("üîß –õ–µ—á–∏–º —Å—Ç–æ–ª–±–µ—Ü 'order_date'...")
    
    # –ü—Ä–∏–º–µ–Ω—è–µ–º –ª–µ—á–µ–Ω–∏–µ –¥–∞—Ç
    df['order_date'] = pd.to_datetime(df['order_date'], 
                                     infer_datetime_format=True, 
                                     errors='coerce')
    —É—Å–ø–µ—à–Ω—ã—Ö_–¥–∞—Ç = df['order_date'].notna().sum()
    print(f"   ‚úÖ –í—ã–ª–µ—á–µ–Ω–æ –¥–∞—Ç: {—É—Å–ø–µ—à–Ω—ã—Ö_–¥–∞—Ç}")

# –õ–µ—á–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞
if 'quantity' in df.columns:
    print("üîß –õ–µ—á–∏–º —Å—Ç–æ–ª–±–µ—Ü 'quantity'...")
    
    # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ —á–∏—Å–ª–∞
    df['quantity'] = pd.to_numeric(df['quantity'], errors='coerce')
    
    # –£–±–∏—Ä–∞–µ–º –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ (—ç—Ç–æ –æ—à–∏–±–∫–∏)
    –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö = (df['quantity'] < 0).sum()
    df = df[df['quantity'] >= 0]
    print(f"   üóëÔ∏è –£–¥–∞–ª–µ–Ω–æ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö –∫–æ–ª–∏—á–µ—Å—Ç–≤: {–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö}")
```

**–õ–µ—á–µ–Ω–∏–µ 3: –ó–∞–ø–æ–ª–Ω—è–µ–º –ø—Ä–æ–ø—É—Å–∫–∏**
```python
print(f"\nüíä –õ–ï–ß–ï–ù–ò–ï 3: –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–ø—É—Å–∫–æ–≤")
print("-" * 30)

# –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –ø—Ä–æ–ø—É—Å–∫–∏ –ø–æ —Å—Ç–æ–ª–±—Ü–∞–º
–ø—Ä–æ–ø—É—Å–∫–∏ = df.isnull().sum()
print("üîç –ü—Ä–æ–ø—É—Å–∫–∏ –ø–æ —Å—Ç–æ–ª–±—Ü–∞–º:")
for —Å—Ç–æ–ª–±–µ—Ü, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ in –ø—Ä–æ–ø—É—Å–∫–∏[–ø—Ä–æ–ø—É—Å–∫–∏ > 0].items():
    –ø—Ä–æ—Ü–µ–Ω—Ç = (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ / len(df)) * 100
    print(f"   {—Å—Ç–æ–ª–±–µ—Ü}: {–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ} ({–ø—Ä–æ—Ü–µ–Ω—Ç:.1f}%)")

# –õ–µ—á–∏–º –ø—Ä–æ–ø—É—Å–∫–∏ –≤ –∏–º–µ–Ω–∞—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤
if 'customer_name' in df.columns:
    –ø—É—Å—Ç—ã—Ö_–∏–º–µ–Ω = df['customer_name'].isnull().sum()
    df = df.dropna(subset=['customer_name'])  # –£–¥–∞–ª—è–µ–º —Å—Ç—Ä–æ–∫–∏ –±–µ–∑ –∏–º–µ–Ω–∏ –∫–ª–∏–µ–Ω—Ç–∞
    print(f"üóëÔ∏è –£–¥–∞–ª–µ–Ω–æ —Å—Ç—Ä–æ–∫ –±–µ–∑ –∏–º–µ–Ω–∏ –∫–ª–∏–µ–Ω—Ç–∞: {–ø—É—Å—Ç—ã—Ö_–∏–º–µ–Ω}")

# –õ–µ—á–∏–º –ø—Ä–æ–ø—É—Å–∫–∏ –≤ —Ü–µ–Ω–∞—Ö (–∑–∞–ø–æ–ª–Ω—è–µ–º —Å—Ä–µ–¥–Ω–µ–π —Ü–µ–Ω–æ–π –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏)
if 'price' in df.columns and 'category' in df.columns:
    —Å—Ä–µ–¥–Ω–∏–µ_—Ü–µ–Ω—ã = df.groupby('category')['price'].median()
    
    def –∑–∞–ø–æ–ª–Ω–∏—Ç—å_—Ü–µ–Ω—É(row):
        if pd.isna(row['price']) and not pd.isna(row['category']):
            return —Å—Ä–µ–¥–Ω–∏–µ_—Ü–µ–Ω—ã.get(row['category'], df['price'].median())
        return row['price']
    
    –∑–∞–ø–æ–ª–Ω–µ–Ω–æ_—Ü–µ–Ω = df['price'].isnull().sum()
    df['price'] = df.apply(–∑–∞–ø–æ–ª–Ω–∏—Ç—å_—Ü–µ–Ω—É, axis=1)
    print(f"üíä –ó–∞–ø–æ–ª–Ω–µ–Ω–æ –ø—Ä–æ–ø—É—Å–∫–æ–≤ –≤ —Ü–µ–Ω–∞—Ö: {–∑–∞–ø–æ–ª–Ω–µ–Ω–æ_—Ü–µ–Ω}")

# –õ–µ—á–∏–º –ø—Ä–æ–ø—É—Å–∫–∏ –≤ –∞–¥—Ä–µ—Å–∞—Ö
if 'shipping_address' in df.columns:
    df['shipping_address'] = df['shipping_address'].fillna('–ù–µ —É–∫–∞–∑–∞–Ω')
    print(f"üíä –ó–∞–ø–æ–ª–Ω–µ–Ω—ã –ø—Ä–æ–ø—É—Å–∫–∏ –≤ –∞–¥—Ä–µ—Å–∞—Ö")
```

**–õ–µ—á–µ–Ω–∏–µ 4: –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞**
```python
print(f"\nüíä –õ–ï–ß–ï–ù–ò–ï 4: –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞")
print("-" * 32)

# –õ–µ—á–∏–º –Ω–∞–∑–≤–∞–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π
if 'category' in df.columns:
    print("üîß –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä—É–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∏...")
    
    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–æ–±–ª–µ–º—ã
    —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ_–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ = df['category'].unique()
    print(f"   –ë—ã–ª–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–π: {len(—É–Ω–∏–∫–∞–ª—å–Ω—ã–µ_–∫–∞—Ç–µ–≥–æ—Ä–∏–∏)}")
    print(f"   –ü—Ä–∏–º–µ—Ä—ã: {—É–Ω–∏–∫–∞–ª—å–Ω—ã–µ_–∫–∞—Ç–µ–≥–æ—Ä–∏–∏[:5]}")
    
    # –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä—É–µ–º
    df['category'] = df['category'].str.strip().str.title()
    
    # –ò—Å–ø—Ä–∞–≤–ª—è–µ–º —Ç–∏–ø–∏—á–Ω—ã–µ –æ–ø–µ—á–∞—Ç–∫–∏
    –∑–∞–º–µ–Ω—ã_–∫–∞—Ç–µ–≥–æ—Ä–∏–π = {
        'Electronics': 'Electronics',
        'Electronic': 'Electronics', 
        'Elektronics': 'Electronics',
        'Clothing': 'Clothing',
        'Clothes': 'Clothing',
        'Home Garden': 'Home & Garden',
        'Home & Garden': 'Home & Garden'
    }
    
    df['category'] = df['category'].replace(–∑–∞–º–µ–Ω—ã_–∫–∞—Ç–µ–≥–æ—Ä–∏–π)
    
    —Å—Ç–∞–ª–æ_–∫–∞—Ç–µ–≥–æ—Ä–∏–π = df['category'].nunique()
    print(f"   ‚úÖ –°—Ç–∞–ª–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–π: {—Å—Ç–∞–ª–æ_–∫–∞—Ç–µ–≥–æ—Ä–∏–π}")

# –õ–µ—á–∏–º –∏–º–µ–Ω–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤
if 'customer_name' in df.columns:
    print("üîß –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä—É–µ–º –∏–º–µ–Ω–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤...")
    
    # –£–±–∏—Ä–∞–µ–º –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã –∏ –ø—Ä–∏–≤–æ–¥–∏–º –∫ –µ–¥–∏–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—É
    df['customer_name'] = df['customer_name'].str.strip().str.title()
    print(f"   ‚úÖ –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –∏–º–µ–Ω–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤")
```

### üìä **–®–∞–≥ 4: –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–π –æ—Å–º–æ—Ç—Ä –ø–æ—Å–ª–µ –ª–µ—á–µ–Ω–∏—è**

```python
print(f"\nü©∫ –ö–û–ù–¢–†–û–õ–¨–ù–´–ô –û–°–ú–û–¢–† –ü–û–°–õ–ï –õ–ï–ß–ï–ù–ò–Ø")
print("=" * 40)

print(f"üìè –§–∏–Ω–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä: {df.shape[0]} —Å—Ç—Ä–æ–∫, {df.shape[1]} —Å—Ç–æ–ª–±—Ü–æ–≤")
print(f"‚ùå –û—Å—Ç–∞–≤—à–∏–µ—Å—è –ø—Ä–æ–ø—É—Å–∫–∏: {df.isnull().sum().sum()}")
print(f"üîÑ –û—Å—Ç–∞–≤—à–∏–µ—Å—è –¥—É–±–ª–∏–∫–∞—Ç—ã: {df.duplicated().sum()}")

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞—á–µ—Å—Ç–≤–æ –¥–∞–Ω–Ω—ã—Ö
–ø—Ä–æ–±–ª–µ–º—ã = []

if 'price' in df.columns:
    –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö_—Ü–µ–Ω = (df['price'] < 0).sum()
    if –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö_—Ü–µ–Ω > 0:
        –ø—Ä–æ–±–ª–µ–º—ã.append(f"–û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ —Ü–µ–Ω—ã: {–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö_—Ü–µ–Ω}")

if 'quantity' in df.columns:
    –Ω—É–ª–µ–≤—ã—Ö_–∫–æ–ª–∏—á–µ—Å—Ç–≤ = (df['quantity'] == 0).sum()
    if –Ω—É–ª–µ–≤—ã—Ö_–∫–æ–ª–∏—á–µ—Å—Ç–≤ > 0:
        –ø—Ä–æ–±–ª–µ–º—ã.append(f"–ù—É–ª–µ–≤—ã–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞: {–Ω—É–ª–µ–≤—ã—Ö_–∫–æ–ª–∏—á–µ—Å—Ç–≤}")

if –ø—Ä–æ–±–ª–µ–º—ã:
    print(f"‚ö†Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:")
    for –ø—Ä–æ–±–ª–µ–º–∞ in –ø—Ä–æ–±–ª–µ–º—ã:
        print(f"   ‚Ä¢ {–ø—Ä–æ–±–ª–µ–º–∞}")
else:
    print(f"‚úÖ –ü–∞—Ü–∏–µ–Ω—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–¥–æ—Ä–æ–≤!")

# –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–ª–µ—á–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
df.to_csv('cleaned_ecommerce_data.csv', index=False, encoding='utf-8-sig')
print(f"\nüíæ –í—ã–ª–µ—á–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã: cleaned_ecommerce_data.csv")
```

**‚ùì –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã:**
1. –°–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫ –¥–∞–Ω–Ω—ã—Ö –±—ã–ª–æ –¥–æ –∏ –ø–æ—Å–ª–µ –ª–µ—á–µ–Ω–∏—è?
2. –ö–∞–∫–∏–µ —Ç–∏–ø—ã –ø—Ä–æ–±–ª–µ–º –±—ã–ª–∏ —Å–∞–º—ã–º–∏ —á–∞—Å—Ç—ã–º–∏?
3. –ú–æ–∂–Ω–æ –ª–∏ –±—ã–ª–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å —ç—Ç–∏ –ø—Ä–æ–±–ª–µ–º—ã –Ω–∞ —ç—Ç–∞–ø–µ —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö?

---

## üîç –ó–∞–¥–∞–Ω–∏–µ 2: "–î–µ—Ç–µ–∫—Ç–∏–≤ –¥–∞–Ω–Ω—ã—Ö" ‚Äî –∏—â–µ–º –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏

**üé¨ –í–∞—à–∞ —Ä–æ–ª—å:** –í—ã –¥–µ—Ç–µ–∫—Ç–∏–≤, –∫–æ—Ç–æ—Ä—ã–π –¥–æ–ª–∂–µ–Ω –Ω–∞–π—Ç–∏ —Å–∫—Ä—ã—Ç—ã–µ –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏ –≤ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ–¥–∞–∂. –ö—Ç–æ –ª—É—á—à–∏–π –∫–ª–∏–µ–Ω—Ç? –ö–∞–∫–æ–π —Ç–æ–≤–∞—Ä –ø—Ä–∏–Ω–æ—Å–∏—Ç –±–æ–ª—å—à–µ –ø—Ä–∏–±—ã–ª–∏?

**üìã –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:**
1. –ó–∞–≥—Ä—É–∑–∏—Ç—å –æ—á–∏—â–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è
2. –ü—Ä–æ–≤–µ—Å—Ç–∏ –¥–µ—Ç–µ–∫—Ç–∏–≤–Ω–æ–µ —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é –≥—Ä—É–ø–ø–∏—Ä–æ–≤–æ–∫
3. –ù–∞–π—Ç–∏ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏
4. –°–æ–∑–¥–∞—Ç—å –¥–æ—Å—å–µ –Ω–∞ –∫–∞–∂–¥—É—é –Ω–∞—Ö–æ–¥–∫—É

**üìÅ –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ñ–∞–π–ª—ã:** –†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è `cleaned_ecommerce_data.csv`

### üïµÔ∏è **–®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–µ—Ç–µ–∫—Ç–∏–≤–Ω–æ–≥–æ —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è**

```python
print("üïµÔ∏è –î–µ—Ç–µ–∫—Ç–∏–≤–Ω–æ–µ –∞–≥–µ–Ω—Ç—Å—Ç–≤–æ 'Pandas –•–æ–ª–º—Å'")
print("–î–µ–ª–æ: –ü–æ–∏—Å–∫ –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–µ–π –≤ –¥–∞–Ω–Ω—ã—Ö e-commerce")
print("=" * 50)

# –ó–∞–≥—Ä—É–∂–∞–µ–º –≤—ã–ª–µ—á–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
df = pd.read_csv('cleaned_ecommerce_data.csv')

# –ì–æ—Ç–æ–≤–∏–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è
df['order_date'] = pd.to_datetime(df['order_date'])
df['–º–µ—Å—è—Ü'] = df['order_date'].dt.month
df['–¥–µ–Ω—å_–Ω–µ–¥–µ–ª–∏'] = df['order_date'].dt.day_name()
df['–≤—ã—Ä—É—á–∫–∞'] = df['price'] * df['quantity']

print(f"üìä –ë–∞–∑–∞ –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤: {len(df)} –∑–∞–ø–∏—Å–µ–π")
print(f"üìÖ –ü–µ—Ä–∏–æ–¥ —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è: {df['order_date'].min()} - {df['order_date'].max()}")
print(f"üí∞ –û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞: {df['–≤—ã—Ä—É—á–∫–∞'].sum():,.2f}")
```

### üîç **–®–∞–≥ 2: –†–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–æ–≤**

```python
print(f"\nüîç –†–ê–°–°–õ–ï–î–û–í–ê–ù–ò–ï 1: –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–æ–≤")
print("-" * 42)

# –°–æ–∑–¥–∞–µ–º –¥–æ—Å—å–µ –Ω–∞ –∫–∞–∂–¥–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞
–¥–æ—Å—å–µ_–∫–ª–∏–µ–Ω—Ç–æ–≤ = df.groupby('customer_name').agg({
    '–≤—ã—Ä—É—á–∫–∞': ['sum', 'count', 'mean'],
    'quantity': 'sum',
    'order_date': ['min', 'max']
}).round(2)

# –£–ø—Ä–æ—â–∞–µ–º –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤
–¥–æ—Å—å–µ_–∫–ª–∏–µ–Ω—Ç–æ–≤.columns = ['–æ–±—â–∞—è_–≤—ã—Ä—É—á–∫–∞', '–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–∑–∞–∫–∞–∑–æ–≤', '—Å—Ä–µ–¥–Ω–∏–π_—á–µ–∫', '–æ–±—â–µ–µ_–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ', '–ø–µ—Ä–≤—ã–π_–∑–∞–∫–∞–∑', '–ø–æ—Å–ª–µ–¥–Ω–∏–π_–∑–∞–∫–∞–∑']

# –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –≤—ã—Ä—É—á–∫–µ
–¥–æ—Å—å–µ_–∫–ª–∏–µ–Ω—Ç–æ–≤ = –¥–æ—Å—å–µ_–∫–ª–∏–µ–Ω—Ç–æ–≤.sort_values('–æ–±—â–∞—è_–≤—ã—Ä—É—á–∫–∞', ascending=False)

print("üèÜ –¢–û–ü-5 –ö–õ–ò–ï–ù–¢–û–í –ü–û –í–´–†–£–ß–ö–ï:")
for i, (–∫–ª–∏–µ–Ω—Ç, –¥–∞–Ω–Ω—ã–µ) in enumerate(–¥–æ—Å—å–µ_–∫–ª–∏–µ–Ω—Ç–æ–≤.head().iterrows(), 1):
    print(f"{i}. {–∫–ª–∏–µ–Ω—Ç}")
    print(f"   üí∞ –û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞: {–¥–∞–Ω–Ω—ã–µ['–æ–±—â–∞—è_–≤—ã—Ä—É—á–∫–∞']:,.2f}")
    print(f"   üõí –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤: {–¥–∞–Ω–Ω—ã–µ['–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–∑–∞–∫–∞–∑–æ–≤']}")
    print(f"   üí≥ –°—Ä–µ–¥–Ω–∏–π —á–µ–∫: {–¥–∞–Ω–Ω—ã–µ['—Å—Ä–µ–¥–Ω–∏–π_—á–µ–∫']:,.2f}")
    print()

# –°–µ–≥–º–µ–Ω—Ç–∏—Ä—É–µ–º –∫–ª–∏–µ–Ω—Ç–æ–≤
def –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å_–∫–ª–∞—Å—Å_–∫–ª–∏–µ–Ω—Ç–∞(row):
    if row['–æ–±—â–∞—è_–≤—ã—Ä—É—á–∫–∞'] > 20000 and row['–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–∑–∞–∫–∞–∑–æ–≤'] > 5:
        return 'VIP üëë'
    elif row['–æ–±—â–∞—è_–≤—ã—Ä—É—á–∫–∞'] > 10000:
        return '–¶–µ–Ω–Ω—ã–π üíé'
    elif row['–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–∑–∞–∫–∞–∑–æ–≤'] > 3:
        return '–ê–∫—Ç–∏–≤–Ω—ã–π ‚ö°'
    else:
        return '–û–±—ã—á–Ω—ã–π üë§'

–¥–æ—Å—å–µ_–∫–ª–∏–µ–Ω—Ç–æ–≤['–∫–ª–∞—Å—Å'] = –¥–æ—Å—å–µ_–∫–ª–∏–µ–Ω—Ç–æ–≤.apply(–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å_–∫–ª–∞—Å—Å_–∫–ª–∏–µ–Ω—Ç–∞, axis=1)

print("üìä –†–ê–°–ü–†–ï–î–ï–õ–ï–ù–ò–ï –ö–õ–ò–ï–ù–¢–û–í –ü–û –ö–õ–ê–°–°–ê–ú:")
—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ = –¥–æ—Å—å–µ_–∫–ª–∏–µ–Ω—Ç–æ–≤['–∫–ª–∞—Å—Å'].value_counts()
for –∫–ª–∞—Å—Å, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ in —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ.items():
    –ø—Ä–æ—Ü–µ–Ω—Ç = (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ / len(–¥–æ—Å—å–µ_–∫–ª–∏–µ–Ω—Ç–æ–≤)) * 100
    print(f"   {–∫–ª–∞—Å—Å}: {–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ} –∫–ª–∏–µ–Ω—Ç–æ–≤ ({–ø—Ä–æ—Ü–µ–Ω—Ç:.1f}%)")
```

### üõçÔ∏è **–®–∞–≥ 3: –†–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤**

```python
print(f"\nüîç –†–ê–°–°–õ–ï–î–û–í–ê–ù–ò–ï 2: –ê–Ω–∞–ª–∏–∑ —Ç–æ–≤–∞—Ä–Ω–æ–≥–æ –ø–æ—Ä—Ç—Ñ–µ–ª—è")
print("-" * 45)

# –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Ç–æ–≤–∞—Ä—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
–∞–Ω–∞–ª–∏–∑_–∫–∞—Ç–µ–≥–æ—Ä–∏–π = df.groupby('category').agg({
    '–≤—ã—Ä—É—á–∫–∞': ['sum', 'mean', 'count'],
    'quantity': 'sum',
    'price': 'mean'
}).round(2)

–∞–Ω–∞–ª–∏–∑_–∫–∞—Ç–µ–≥–æ—Ä–∏–π.columns = ['–æ–±—â–∞—è_–≤—ã—Ä—É—á–∫–∞', '—Å—Ä–µ–¥–Ω—è—è_–≤—ã—Ä—É—á–∫–∞_–∑–∞–∫–∞–∑–∞', '–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–∑–∞–∫–∞–∑–æ–≤', '–æ–±—â–µ–µ_–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ', '—Å—Ä–µ–¥–Ω—è—è_—Ü–µ–Ω–∞']

print("üì¶ –ê–ù–ê–õ–ò–ó –ü–û –ö–ê–¢–ï–ì–û–†–ò–Ø–ú –¢–û–í–ê–†–û–í:")
for –∫–∞—Ç–µ–≥–æ—Ä–∏—è, –¥–∞–Ω–Ω—ã–µ in –∞–Ω–∞–ª–∏–∑_–∫–∞—Ç–µ–≥–æ—Ä–∏–π.iterrows():
    –¥–æ–ª—è_–≤—ã—Ä—É—á–∫–∏ = (–¥–∞–Ω–Ω—ã–µ['–æ–±—â–∞—è_–≤—ã—Ä—É—á–∫–∞'] / df['–≤—ã—Ä—É—á–∫–∞'].sum()) * 100
    print(f"\nüè∑Ô∏è {–∫–∞—Ç–µ–≥–æ—Ä–∏—è}:")
    print(f"   üí∞ –û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞: {–¥–∞–Ω–Ω—ã–µ['–æ–±—â–∞—è_–≤—ã—Ä—É—á–∫–∞']:,.2f} ({–¥–æ–ª—è_–≤—ã—Ä—É—á–∫–∏:.1f}%)")
    print(f"   üõí –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤: {–¥–∞–Ω–Ω—ã–µ['–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–∑–∞–∫–∞–∑–æ–≤']}")
    print(f"   üì¶ –°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤ –∑–∞–∫–∞–∑–µ: {–¥–∞–Ω–Ω—ã–µ['–æ–±—â–µ–µ_–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ']/–¥–∞–Ω–Ω—ã–µ['–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–∑–∞–∫–∞–∑–æ–≤']:.1f}")
    print(f"   üí≥ –°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞: {–¥–∞–Ω–Ω—ã–µ['—Å—Ä–µ–¥–Ω—è—è_—Ü–µ–Ω–∞']:,.2f}")

# –ò—â–µ–º —Å–∞–º—ã–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã
–ø–æ–ø—É–ª—è—Ä–Ω—ã–µ_—Ç–æ–≤–∞—Ä—ã = df.groupby('product').agg({
    'quantity': 'sum',
    '–≤—ã—Ä—É—á–∫–∞': 'sum'
}).sort_values('–≤—ã—Ä—É—á–∫–∞', ascending=False)

print(f"\nüéØ –¢–û–ü-5 –¢–û–í–ê–†–û–í –ü–û –í–´–†–£–ß–ö–ï:")
for i, (—Ç–æ–≤–∞—Ä, –¥–∞–Ω–Ω—ã–µ) in enumerate(–ø–æ–ø—É–ª—è—Ä–Ω—ã–µ_—Ç–æ–≤–∞—Ä—ã.head().iterrows(), 1):
    print(f"{i}. {—Ç–æ–≤–∞—Ä}")
    print(f"   üí∞ –í—ã—Ä—É—á–∫–∞: {–¥–∞–Ω–Ω—ã–µ['–≤—ã—Ä—É—á–∫–∞']:,.2f}")
    print(f"   üì¶ –ü—Ä–æ–¥–∞–Ω–æ —à—Ç—É–∫: {–¥–∞–Ω–Ω—ã–µ['quantity']}")
```

### üìÖ **–®–∞–≥ 4: –í—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ**

```python
print(f"\nüîç –†–ê–°–°–õ–ï–î–û–í–ê–ù–ò–ï 3: –í—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏")
print("-" * 42)

# –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –ø—Ä–æ–¥–∞–∂–∏ –ø–æ –º–µ—Å—è—Ü–∞–º
–ø—Ä–æ–¥–∞–∂–∏_–ø–æ_–º–µ—Å—è—Ü–∞–º = df.groupby('–º–µ—Å—è—Ü').agg({
    '–≤—ã—Ä—É—á–∫–∞': 'sum',
    'quantity': 'sum',
    'customer_name': 'nunique'
}).round(2)

–ø—Ä–æ–¥–∞–∂–∏_–ø–æ_–º–µ—Å—è—Ü–∞–º.columns = ['–≤—ã—Ä—É—á–∫–∞', '–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ', '—É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö_–∫–ª–∏–µ–Ω—Ç–æ–≤']

print("üìÖ –°–ï–ó–û–ù–ù–û–°–¢–¨ –ü–†–û–î–ê–ñ:")
–º–µ—Å—è—Ü—ã = ['', '–Ø–Ω–≤', '–§–µ–≤', '–ú–∞—Ä', '–ê–ø—Ä', '–ú–∞–π', '–ò—é–Ω', 
          '–ò—é–ª', '–ê–≤–≥', '–°–µ–Ω', '–û–∫—Ç', '–ù–æ—è', '–î–µ–∫']

for –º–µ—Å—è—Ü_–Ω–æ–º–µ—Ä, –¥–∞–Ω–Ω—ã–µ in –ø—Ä–æ–¥–∞–∂–∏_–ø–æ_–º–µ—Å—è—Ü–∞–º.iterrows():
    –º–µ—Å—è—Ü_–Ω–∞–∑–≤–∞–Ω–∏–µ = –º–µ—Å—è—Ü—ã[–º–µ—Å—è—Ü_–Ω–æ–º–µ—Ä]
    –¥–æ–ª—è = (–¥–∞–Ω–Ω—ã–µ['–≤—ã—Ä—É—á–∫–∞'] / –ø—Ä–æ–¥–∞–∂–∏_–ø–æ_–º–µ—Å—è—Ü–∞–º['–≤—ã—Ä—É—á–∫–∞'].sum()) * 100
    print(f"{–º–µ—Å—è—Ü_–Ω–∞–∑–≤–∞–Ω–∏–µ}: {–¥–∞–Ω–Ω—ã–µ['–≤—ã—Ä—É—á–∫–∞']:,.2f} ({–¥–æ–ª—è:.1f}%) - {–¥–∞–Ω–Ω—ã–µ['—É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö_–∫–ª–∏–µ–Ω—Ç–æ–≤']} –∫–ª–∏–µ–Ω—Ç–æ–≤")

# –ù–∞—Ö–æ–¥–∏–º –ª—É—á—à–∏–π –∏ —Ö—É–¥—à–∏–π –º–µ—Å—è—Ü—ã
–ª—É—á—à–∏–π_–º–µ—Å—è—Ü = –ø—Ä–æ–¥–∞–∂–∏_–ø–æ_–º–µ—Å—è—Ü–∞–º['–≤—ã—Ä—É—á–∫–∞'].idxmax()
—Ö—É–¥—à–∏–π_–º–µ—Å—è—Ü = –ø—Ä–æ–¥–∞–∂–∏_–ø–æ_–º–µ—Å—è—Ü–∞–º['–≤—ã—Ä—É—á–∫–∞'].idxmin()

print(f"\nüèÜ –õ—É—á—à–∏–π –º–µ—Å—è—Ü: {–º–µ—Å—è—Ü—ã[–ª—É—á—à–∏–π_–º–µ—Å—è—Ü]} ({–ø—Ä–æ–¥–∞–∂–∏_–ø–æ_–º–µ—Å—è—Ü–∞–º.loc[–ª—É—á—à–∏–π_–º–µ—Å—è—Ü, '–≤—ã—Ä—É—á–∫–∞']:,.2f})")
print(f"üìâ –•—É–¥—à–∏–π –º–µ—Å—è—Ü: {–º–µ—Å—è—Ü—ã[—Ö—É–¥—à–∏–π_–º–µ—Å—è—Ü]} ({–ø—Ä–æ–¥–∞–∂–∏_–ø–æ_–º–µ—Å—è—Ü–∞–º.loc[—Ö—É–¥—à–∏–π_–º–µ—Å—è—Ü, '–≤—ã—Ä—É—á–∫–∞']:,.2f})")

# –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –¥–Ω–∏ –Ω–µ–¥–µ–ª–∏
–ø—Ä–æ–¥–∞–∂–∏_–ø–æ_–¥–Ω—è–º = df.groupby('–¥–µ–Ω—å_–Ω–µ–¥–µ–ª–∏')['–≤—ã—Ä—É—á–∫–∞'].sum().sort_values(ascending=False)

print(f"\nüìä –ü–†–û–î–ê–ñ–ò –ü–û –î–ù–Ø–ú –ù–ï–î–ï–õ–ò:")
for –¥–µ–Ω—å, –≤—ã—Ä—É—á–∫–∞ in –ø—Ä–æ–¥–∞–∂–∏_–ø–æ_–¥–Ω—è–º.items():
    –¥–æ–ª—è = (–≤—ã—Ä—É—á–∫–∞ / –ø—Ä–æ–¥–∞–∂–∏_–ø–æ_–¥–Ω—è–º.sum()) * 100
    print(f"{–¥–µ–Ω—å}: {–≤—ã—Ä—É—á–∫–∞:,.2f} ({–¥–æ–ª—è:.1f}%)")

–ª—É—á—à–∏–π_–¥–µ–Ω—å = –ø—Ä–æ–¥–∞–∂–∏_–ø–æ_–¥–Ω—è–º.index[0]
print(f"\nüéØ –°–∞–º—ã–π –ø—Ä–∏–±—ã–ª—å–Ω—ã–π –¥–µ–Ω—å: {–ª—É—á—à–∏–π_–¥–µ–Ω—å}")
```

### üìä **–®–∞–≥ 5: –°–æ—Å—Ç–∞–≤–ª—è–µ–º –¥–µ—Ç–µ–∫—Ç–∏–≤–Ω—ã–π –æ—Ç—á–µ—Ç**

```python
print(f"\nüìã –î–ï–¢–ï–ö–¢–ò–í–ù–´–ô –û–¢–ß–ï–¢")
print("=" * 20)

# –ù–∞—Ö–æ–¥–∫–∏ —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è
–Ω–∞—Ö–æ–¥–∫–∏ = []

# –ù–∞—Ö–æ–¥–∫–∞ 1: VIP –∫–ª–∏–µ–Ω—Ç—ã
vip_–∫–ª–∏–µ–Ω—Ç—ã = len(–¥–æ—Å—å–µ_–∫–ª–∏–µ–Ω—Ç–æ–≤[–¥–æ—Å—å–µ_–∫–ª–∏–µ–Ω—Ç–æ–≤['–∫–ª–∞—Å—Å'] == 'VIP üëë'])
vip_–≤—ã—Ä—É—á–∫–∞ = –¥–æ—Å—å–µ_–∫–ª–∏–µ–Ω—Ç–æ–≤[–¥–æ—Å—å–µ_–∫–ª–∏–µ–Ω—Ç–æ–≤['–∫–ª–∞—Å—Å'] == 'VIP üëë']['–æ–±—â–∞—è_–≤—ã—Ä—É—á–∫–∞'].sum()
vip_–¥–æ–ª—è = (vip_–≤—ã—Ä—É—á–∫–∞ / df['–≤—ã—Ä—É—á–∫–∞'].sum()) * 100

if vip_–¥–æ–ª—è > 40:
    –Ω–∞—Ö–æ–¥–∫–∏.append(f"üîç –ù–ê–•–û–î–ö–ê: {vip_–∫–ª–∏–µ–Ω—Ç—ã} VIP –∫–ª–∏–µ–Ω—Ç–æ–≤ ({vip_–∫–ª–∏–µ–Ω—Ç—ã/len(–¥–æ—Å—å–µ_–∫–ª–∏–µ–Ω—Ç–æ–≤)*100:.1f}%) –¥–∞—é—Ç {vip_–¥–æ–ª—è:.1f}% –≤—ã—Ä—É—á–∫–∏!")

# –ù–∞—Ö–æ–¥–∫–∞ 2: –õ–∏–¥–∏—Ä—É—é—â–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è
–ª–∏–¥–µ—Ä_–∫–∞—Ç–µ–≥–æ—Ä–∏—è = –∞–Ω–∞–ª–∏–∑_–∫–∞—Ç–µ–≥–æ—Ä–∏–π['–æ–±—â–∞—è_–≤—ã—Ä—É—á–∫–∞'].idxmax()
–ª–∏–¥–µ—Ä_–¥–æ–ª—è = (–∞–Ω–∞–ª–∏–∑_–∫–∞—Ç–µ–≥–æ—Ä–∏–π.loc[–ª–∏–¥–µ—Ä_–∫–∞—Ç–µ–≥–æ—Ä–∏—è, '–æ–±—â–∞—è_–≤—ã—Ä—É—á–∫–∞'] / df['–≤—ã—Ä—É—á–∫–∞'].sum()) * 100

if –ª–∏–¥–µ—Ä_–¥–æ–ª—è > 30:
    –Ω–∞—Ö–æ–¥–∫–∏.append(f"üîç –ù–ê–•–û–î–ö–ê: –ö–∞—Ç–µ–≥–æ—Ä–∏—è '{–ª–∏–¥–µ—Ä_–∫–∞—Ç–µ–≥–æ—Ä–∏—è}' –¥–æ–º–∏–Ω–∏—Ä—É–µ—Ç —Å {–ª–∏–¥–µ—Ä_–¥–æ–ª—è:.1f}% –æ—Ç –æ–±—â–µ–π –≤—ã—Ä—É—á–∫–∏!")

# –ù–∞—Ö–æ–¥–∫–∞ 3: –°–µ–∑–æ–Ω–Ω–æ—Å—Ç—å
—Ä–∞–∑–±—Ä–æ—Å_–º–µ—Å—è—Ü–µ–≤ = (–ø—Ä–æ–¥–∞–∂–∏_–ø–æ_–º–µ—Å—è—Ü–∞–º['–≤—ã—Ä—É—á–∫–∞'].max() - –ø—Ä–æ–¥–∞–∂–∏_–ø–æ_–º–µ—Å—è—Ü–∞–º['–≤—ã—Ä—É—á–∫–∞'].min()) / –ø—Ä–æ–¥–∞–∂–∏_–ø–æ_–º–µ—Å—è—Ü–∞–º['–≤—ã—Ä—É—á–∫–∞'].mean()

if —Ä–∞–∑–±—Ä–æ—Å_–º–µ—Å—è—Ü–µ–≤ > 0.5:
    –Ω–∞—Ö–æ–¥–∫–∏.append(f"üîç –ù–ê–•–û–î–ö–ê: –í—ã—Ä–∞–∂–µ–Ω–Ω–∞—è —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç—å! –†–∞–∑–±—Ä–æ—Å –ø—Ä–æ–¥–∞–∂ –ø–æ –º–µ—Å—è—Ü–∞–º {—Ä–∞–∑–±—Ä–æ—Å_–º–µ—Å—è—Ü–µ–≤:.1f}x")

# –í—ã–≤–æ–¥–∏–º –Ω–∞—Ö–æ–¥–∫–∏
print("üïµÔ∏è –ö–õ–Æ–ß–ï–í–´–ï –ù–ê–•–û–î–ö–ò –†–ê–°–°–õ–ï–î–û–í–ê–ù–ò–Ø:")
for i, –Ω–∞—Ö–æ–¥–∫–∞ in enumerate(–Ω–∞—Ö–æ–¥–∫–∏, 1):
    print(f"{i}. {–Ω–∞—Ö–æ–¥–∫–∞}")

if not –Ω–∞—Ö–æ–¥–∫–∏:
    print("ü§î –Ø–≤–Ω—ã—Ö –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–µ–π –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ. –î–∞–Ω–Ω—ã–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ.")

# –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
print(f"\nüí° –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –î–õ–Ø –ë–ò–ó–ù–ï–°–ê:")
print("1. üëë –°–æ—Å—Ä–µ–¥–æ—Ç–æ—á—å—Ç–µ—Å—å –Ω–∞ —É–¥–µ—Ä–∂–∞–Ω–∏–∏ VIP –∫–ª–∏–µ–Ω—Ç–æ–≤")
print("2. üì¶ –†–∞–∑–≤–∏–≤–∞–π—Ç–µ –ª–∏–¥–∏—Ä—É—é—â–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤")
print("3. üìÖ –ü–ª–∞–Ω–∏—Ä—É–π—Ç–µ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥ —Å —É—á–µ—Ç–æ–º —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç–∏")
print("4. üéØ –ò–∑—É—á–∏—Ç–µ –ø—Ä–∏—á–∏–Ω—ã —É—Å–ø–µ—Ö–∞ –≤ –ª—É—á—à–∏–µ –¥–Ω–∏ –Ω–µ–¥–µ–ª–∏")

# –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–æ—Å—å–µ –∫–ª–∏–µ–Ω—Ç–æ–≤
–¥–æ—Å—å–µ_–∫–ª–∏–µ–Ω—Ç–æ–≤.to_csv('customer_profiles.csv', encoding='utf-8-sig')
print(f"\nüíæ –î–æ—Å—å–µ –∫–ª–∏–µ–Ω—Ç–æ–≤ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ: customer_profiles.csv")
```

**‚ùì –î–µ—Ç–µ–∫—Ç–∏–≤–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã:**
1. –ö—Ç–æ –≤–∞—à —Å–∞–º—ã–π —Ü–µ–Ω–Ω—ã–π –∫–ª–∏–µ–Ω—Ç –∏ –ø–æ—á–µ–º—É?
2. –ö–∞–∫–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è —Ç–æ–≤–∞—Ä–æ–≤ –∏–º–µ–µ—Ç –Ω–∞–∏–±–æ–ª—å—à–∏–π –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª?
3. –í –∫–∞–∫–∏–µ –¥–Ω–∏ –Ω–µ–¥–µ–ª–∏ —Å—Ç–æ–∏—Ç –ø—Ä–æ–≤–æ–¥–∏—Ç—å –∞–∫—Ü–∏–∏?

---

## ü§ù –ó–∞–¥–∞–Ω–∏–µ 3: "–ü–µ—Ä–µ–≥–æ–≤–æ—Ä—â–∏–∫ –¥–∞–Ω–Ω—ã—Ö" ‚Äî –æ–±—ä–µ–¥–∏–Ω—è–µ–º –∏—Å—Ç–æ—á–Ω–∏–∫–∏

**üé¨ –í–∞—à–∞ —Ä–æ–ª—å:** –í—ã –¥–∏–ø–ª–æ–º–∞—Ç, –∫–æ—Ç–æ—Ä—ã–π –¥–æ–ª–∂–µ–Ω "–ø–æ–¥—Ä—É–∂–∏—Ç—å" –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ä–∞–∑–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤. –£ –≤–∞—Å –µ—Å—Ç—å –æ—Å–Ω–æ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ–¥–∞–∂ –∏ –±–æ–ª—å—à–æ–π –¥–∞—Ç–∞—Å–µ—Ç –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è.

**üìã –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:**
1. –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ä–∞–∑–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
2. –ò–∑—É—á–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–∞–∂–¥–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞
3. –ù–∞–π—Ç–∏ –æ–±—â–∏–µ "–∫–ª—é—á–∏" –¥–ª—è –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è
4. –°–æ–∑–¥–∞—Ç—å –µ–¥–∏–Ω—É—é —Å–≤–æ–¥–Ω—É—é —Ç–∞–±–ª–∏—Ü—É
5. –ü–æ–ª—É—á–∏—Ç—å –Ω–æ–≤—ã–µ –∏–Ω—Å–∞–π—Ç—ã –∏–∑ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**üìÅ –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ñ–∞–π–ª—ã:** `files/large_dataset_sample.csv`, —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –∑–∞–¥–∞–Ω–∏–π

### ü§ù **–®–∞–≥ 1: –ó–Ω–∞–∫–æ–º—Å—Ç–≤–æ —Å "–ø–µ—Ä–µ–≥–æ–≤–æ—Ä—â–∏–∫–∞–º–∏"**

```python
print("ü§ù –î–∏–ø–ª–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –º–∏—Å—Å–∏—è: –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö")
print("=" * 45)

# –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ä–∞–∑–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
print("üì• –ó–∞–≥—Ä—É–∂–∞–µ–º —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –ø–µ—Ä–µ–≥–æ–≤–æ—Ä–æ–≤...")

# –£—á–∞—Å—Ç–Ω–∏–∫ 1: –ù–∞—à–∏ –æ—á–∏—â–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–º–∞–ª—ã–µ)
try:
    df_small = pd.read_csv('cleaned_ecommerce_data.csv')
    print(f"üõí –û—á–∏—â–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: {len(df_small)} –∑–∞–ø–∏—Å–µ–π")
    print(f"   –°—Ç–æ–ª–±—Ü—ã: {list(df_small.columns)}")
except:
    print("‚ö†Ô∏è –ù–µ –Ω–∞–π–¥–µ–Ω —Ñ–∞–π–ª –æ—á–∏—â–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, —Å–æ–∑–¥–∞–µ–º –æ–±—Ä–∞–∑–µ—Ü...")
    df_small = pd.DataFrame({
        'customer_name': ['John Smith', 'Mary Davis', 'Alice Brown'],
        'product': ['iPhone 14', 'Samsung Galaxy', 'MacBook Pro'],
        'category': ['Electronics', 'Electronics', 'Electronics'],
        'price': [999, 899, 1299],
        'quantity': [1, 2, 1]
    })

# –£—á–∞—Å—Ç–Ω–∏–∫ 2: –ë–æ–ª—å—à–æ–π –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç
try:
    df_big = pd.read_csv('files/large_dataset_sample.csv')
    print(f"üåç –ë–æ–ª—å—à–æ–π –¥–∞—Ç–∞—Å–µ—Ç: {len(df_big)} –∑–∞–ø–∏—Å–µ–π")
    print(f"   –°—Ç–æ–ª–±—Ü—ã: {list(df_big.columns)}")
except FileNotFoundError:
    print("‚ùå –§–∞–π–ª large_dataset_sample.csv –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –ø–∞–ø–∫–µ files/")
    exit()

# –ì–æ—Ç–æ–≤–∏–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è
df_small['source'] = 'Local Store'
df_big['source'] = 'Global Network'

print(f"\nüìä –†–∞–∑–º–µ—Ä—ã –¥–∞–Ω–Ω—ã—Ö:")
print(f"   –õ–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: {len(df_small):,} –∑–∞–ø–∏—Å–µ–π")
print(f"   –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: {len(df_big):,} –∑–∞–ø–∏—Å–µ–π")
```

### üîç **–®–∞–≥ 2: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –ø–µ—Ä–µ–≥–æ–≤–æ—Ä–∞–º**

```python
print(f"\nüîç –ü–û–î–ì–û–¢–û–í–ö–ê –ö –ü–ï–†–ï–ì–û–í–û–†–ê–ú")
print("-" * 25)

# –ò–∑—É—á–∞–µ–º –æ–±—â–∏–µ –ø–æ–ª—è –¥–ª—è –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è
print("üîë –ê–Ω–∞–ª–∏–∑ —Å—Ö–æ–∂–∏—Ö –ø–æ–ª–µ–π:")

# –ü—Ä–∏–≤–æ–¥–∏–º –∫ –æ–±—â–µ–º—É –≤–∏–¥—É —Å—Ç–æ–ª–±—Ü—ã
if 'customer_name' in df_small.columns and 'customer_id' in df_big.columns:
    print("   –ö–ª–∏–µ–Ω—Ç—ã: customer_name (–ª–æ–∫–∞–ª) vs customer_id (–≥–ª–æ–±–∞–ª)")

if 'product' in df_small.columns and 'product_name' in df_big.columns:
    print("   –¢–æ–≤–∞—Ä—ã: product (–ª–æ–∫–∞–ª) vs product_name (–≥–ª–æ–±–∞–ª)")

if 'category' in df_small.columns and 'category' in df_big.columns:
    print("   ‚úÖ –û–±—â–µ–µ –ø–æ–ª–µ: category")

# –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä—É–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–ª—è –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è
df_small_std = df_small.copy()
df_big_std = df_big.copy()

# –ü—Ä–∏–≤–æ–¥–∏–º –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤ –∫ –µ–¥–∏–Ω–æ–º—É –≤–∏–¥—É
if 'product_name' in df_big_std.columns:
    df_big_std = df_big_std.rename(columns={'product_name': 'product'})

if 'final_price' in df_big_std.columns:
    df_big_std = df_big_std.rename(columns={'final_price': 'total_amount'})

# –î–æ–±–∞–≤–ª—è–µ–º –≤—ã—á–∏—Å–ª—è–µ–º—ã–µ –ø–æ–ª—è –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
df_small_std['total_amount'] = df_small_std['price'] * df_small_std['quantity']
df_small_std['region'] = 'Local Region'
df_small_std['country'] = 'Local Country'

print(f"\nüìä –ü–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã:")
print("–õ–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:", list(df_small_std.columns))
print("–ì–ª–æ–±–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:", list(df_big_std.columns))
```

### ü§ù **–®–∞–≥ 3: –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º —Ç–æ–≤–∞—Ä–æ–≤**

```python
print(f"\nü§ù –ü–ï–†–ï–ì–û–í–û–†–´ 1: –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º")
print("-" * 40)

# –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
local_categories = df_small_std.groupby('category').agg({
    'total_amount': ['sum', 'mean', 'count'],
    'quantity': 'sum'
}).round(2)

local_categories.columns = ['local_revenue', 'local_avg_order', 'local_orders', 'local_quantity']
local_categories['source'] = 'Local'

# –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
if 'category' in df_big_std.columns:
    global_categories = df_big_std.groupby('category').agg({
        'total_amount': ['sum', 'mean', 'count'],
        'quantity': 'sum'
    }).round(2)
    
    global_categories.columns = ['global_revenue', 'global_avg_order', 'global_orders', 'global_quantity']
    global_categories['source'] = 'Global'
    
    # –û–±—ä–µ–¥–∏–Ω—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
    combined_categories = pd.merge(
        local_categories.reset_index(),
        global_categories.reset_index(),
        on='category',
        how='outer',
        suffixes=('_local', '_global')
    )
    
    print("üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π (–ª–æ–∫–∞–ª vs –≥–ª–æ–±–∞–ª):")
    print(combined_categories[['category', 'local_revenue', 'global_revenue', 'local_avg_order', 'global_avg_order']])
    
    # –ù–∞—Ö–æ–¥–∏–º —Ä–∞–∑–ª–∏—á–∏—è
    print(f"\nüîç –ö–õ–Æ–ß–ï–í–´–ï –†–ê–ó–õ–ò–ß–ò–Ø:")
    for _, row in combined_categories.iterrows():
        if not pd.isna(row['local_revenue']) and not pd.isna(row['global_revenue']):
            local_rev = row['local_revenue']
            global_rev = row['global_revenue']
            if global_rev > 0:
                ratio = local_rev / (global_rev / len(df_big_std) * len(df_small_std))  # –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –ø–æ —Ä–∞–∑–º–µ—Ä—É
                print(f"   {row['category']}: –ª–æ–∫–∞–ª—å–Ω–∞—è vs –≥–ª–æ–±–∞–ª—å–Ω–∞—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å = {ratio:.2f}x")
```

### üìà **–®–∞–≥ 4: –ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑**

```python
print(f"\nü§ù –ü–ï–†–ï–ì–û–í–û–†–´ 2: –ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ")
print("-" * 43)

# –ê–Ω–∞–ª–∏–∑ –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º (–∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ –±–æ–ª—å—à–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞)
if 'region' in df_big_std.columns and 'country' in df_big_std.columns:
    
    regional_performance = df_big_std.groupby(['region', 'country']).agg({
        'total_amount': ['sum', 'mean', 'count'],
        'customer_id': 'nunique'
    }).round(2)
    
    regional_performance.columns = ['total_revenue', 'avg_order', 'orders_count', 'unique_customers']
    regional_performance = regional_performance.reset_index()
    
    print("üåç –¢–û–ü-5 –°–¢–†–ê–ù –ü–û –í–´–†–£–ß–ö–ï:")
    top_countries = regional_performance.nlargest(5, 'total_revenue')
    for _, row in top_countries.iterrows():
        print(f"   {row['country']} ({row['region']}): ${row['total_revenue']:,.2f}")
        print(f"      –°—Ä–µ–¥–Ω–∏–π —á–µ–∫: ${row['avg_order']:,.2f}, –ö–ª–∏–µ–Ω—Ç–æ–≤: {row['unique_customers']}")
    
    # –†–µ–≥–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
    print(f"\nüìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê –ü–û –†–ï–ì–ò–û–ù–ê–ú:")
    regional_summary = regional_performance.groupby('region').agg({
        'total_revenue': 'sum',
        'orders_count': 'sum',
        'unique_customers': 'sum'
    }).sort_values('total_revenue', ascending=False)
    
    for region, data in regional_summary.iterrows():
        avg_revenue_per_customer = data['total_revenue'] / data['unique_customers']
        print(f"   {region}:")
        print(f"      üí∞ –í—ã—Ä—É—á–∫–∞: ${data['total_revenue']:,.2f}")
        print(f"      üë• –ö–ª–∏–µ–Ω—Ç–æ–≤: {data['unique_customers']:,}")
        print(f"      üí≥ –í—ã—Ä—É—á–∫–∞ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–∞: ${avg_revenue_per_customer:,.2f}")
```

### üéØ **–®–∞–≥ 5: –û–±—ä–µ–¥–∏–Ω–µ–Ω–Ω–∞—è —Å–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞**

```python
print(f"\nüéØ –§–ò–ù–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ì–û–í–û–†–´: –°–æ–∑–¥–∞–Ω–∏–µ —Å–≤–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã")
print("=" * 50)

# –°–æ–∑–¥–∞–µ–º –æ–±—â–∏–µ –ø–æ–ª—è –¥–ª—è –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö
df_small_final = df_small_std[['category', 'total_amount', 'quantity', 'source']].copy()
df_big_final = df_big_std[['category', 'total_amount', 'quantity', 'source']].copy()

# –û–±—ä–µ–¥–∏–Ω—è–µ–º –≤—Å–µ –¥–∞–Ω–Ω—ã–µ
unified_data = pd.concat([df_small_final, df_big_final], ignore_index=True)

print(f"üìä –û–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç: {len(unified_data):,} –∑–∞–ø–∏—Å–µ–π")

# –°–æ–∑–¥–∞–µ–º –º–µ–≥–∞-—Å–≤–æ–¥–Ω—É—é —Ç–∞–±–ª–∏—Ü—É
mega_pivot = pd.pivot_table(
    unified_data,
    values=['total_amount', 'quantity'],
    index='category',
    columns='source',
    aggfunc='sum',
    fill_value=0,
    margins=True
)

print(f"\nüìã –ú–ï–ì–ê-–°–í–û–î–ù–ê–Ø –¢–ê–ë–õ–ò–¶–ê:")
print(mega_pivot)

# –ê–Ω–∞–ª–∏–∑ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º
source_comparison = unified_data.groupby(['category', 'source']).agg({
    'total_amount': ['sum', 'mean'],
    'quantity': 'sum'
}).round(2)

print(f"\nüí° –ö–õ–Æ–ß–ï–í–´–ï –ò–ù–°–ê–ô–¢–´ –ü–ï–†–ï–ì–û–í–û–†–û–í:")

# –ù–∞—Ö–æ–¥–∏–º —Å–∞–º—ã–µ –ø—Ä–∏–±—ã–ª—å–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –≤ –∫–∞–∂–¥–æ–º –∏—Å—Ç–æ—á–Ω–∏–∫–µ
for source in unified_data['source'].unique():
    source_data = unified_data[unified_data['source'] == source]
    top_category = source_data.groupby('category')['total_amount'].sum().idxmax()
    top_revenue = source_data.groupby('category')['total_amount'].sum().max()
    print(f"üèÜ {source}: –õ–∏–¥–µ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏—è '{top_category}' (${top_revenue:,.2f})")

# –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
unified_data.to_csv('unified_analysis.csv', index=False, encoding='utf-8-sig')
mega_pivot.to_csv('mega_pivot_table.csv', encoding='utf-8-sig')

print(f"\nüíæ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–µ—Ä–µ–≥–æ–≤–æ—Ä–æ–≤ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã:")
print("   - unified_analysis.csv")
print("   - mega_pivot_table.csv")
print("‚úÖ –î–∏–ø–ª–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –º–∏—Å—Å–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ!")
```

**‚ùì –î–∏–ø–ª–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã:**
1. –ö–∞–∫–∏–µ –Ω–æ–≤—ã–µ –∏–Ω—Å–∞–π—Ç—ã –ø–æ—è–≤–∏–ª–∏—Å—å –ø–æ—Å–ª–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö?
2. –ö–∞–∫–∏–µ —Ä–∞–∑–ª–∏—á–∏—è –º–µ–∂–¥—É –ª–æ–∫–∞–ª—å–Ω—ã–º –∏ –≥–ª–æ–±–∞–ª—å–Ω—ã–º —Ä—ã–Ω–∫–∞–º–∏ –Ω–∞–∏–±–æ–ª–µ–µ –∑–Ω–∞—á–∏–º—ã?
3. –°—Ç–æ–∏—Ç –ª–∏ –º–µ–Ω—è—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –Ω–∞ –æ—Å–Ω–æ–≤–µ –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö —Ç—Ä–µ–Ω–¥–æ–≤?

---

## üóÑÔ∏è –ó–∞–¥–∞–Ω–∏–µ 4: "IT-–∞—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä" ‚Äî —Å—Ç—Ä–æ–∏–º –º–æ—Å—Ç —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö

**üé¨ –í–∞—à–∞ —Ä–æ–ª—å:** –í—ã IT-–∞—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π –¥–æ–ª–∂–µ–Ω –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –º–æ—Å—Ç –º–µ–∂–¥—É –º–∏—Ä–æ–º Python –∏ –º–∏—Ä–æ–º –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö. –ù—É–∂–Ω–æ –Ω–∞—É—á–∏—Ç—å—Å—è –∑–∞–≥—Ä—É–∂–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ –ë–î –∏ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±—Ä–∞—Ç–Ω–æ.

**üìã –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:**
1. –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö SQLite
2. –ò–∑—É—á–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
3. –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —Å –ø–æ–º–æ—â—å—é SQL –∑–∞–ø—Ä–æ—Å–æ–≤
4. –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ Pandas
5. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±—Ä–∞—Ç–Ω–æ –≤ –±–∞–∑—É

**üìÅ –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ñ–∞–π–ª—ã:** `files/sample_database.db`, `files/sql-connection-example.py`

### üèóÔ∏è **–®–∞–≥ 1: –°—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ –º–æ—Å—Ç–∞**

```python
import sqlite3
import pandas as pd
from datetime import datetime

print("üèóÔ∏è IT-–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–µ –±—é—Ä–æ 'Pandas & SQL'")
print("–ü—Ä–æ–µ–∫—Ç: –ú–æ—Å—Ç –º–µ–∂–¥—É Python –∏ –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö")
print("=" * 50)

# –ü–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
try:
    conn = sqlite3.connect('files/sample_database.db')
    print("‚úÖ –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ")
except Exception as e:
    print(f"‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è: {e}")
    print("–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª sample_database.db –≤ –ø–∞–ø–∫–µ files/")
    exit()

# –ò–∑—É—á–∞–µ–º –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
print(f"\nüèõÔ∏è –ò–ó–£–ß–ï–ù–ò–ï –ê–†–•–ò–¢–ï–ö–¢–£–†–´ –ë–ê–ó–´ –î–ê–ù–ù–´–•")
print("-" * 35)

# –ü–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ —Ç–∞–±–ª–∏—Ü
tables_query = "SELECT name FROM sqlite_master WHERE type='table';"
tables = pd.read_sql_query(tables_query, conn)

print("üìã –î–æ—Å—Ç—É–ø–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã:")
for table in tables['name']:
    print(f"   üìä {table}")
    
    # –ü–æ–ª—É—á–∞–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–∞–∂–¥–æ–π —Ç–∞–±–ª–∏—Ü—ã
    structure_query = f"PRAGMA table_info({table});"
    structure = pd.read_sql_query(structure_query, conn)
    
    print("      –°—Ç–æ–ª–±—Ü—ã:")
    for _, col in structure.iterrows():
        print(f"         ‚Ä¢ {col['name']} ({col['type']})")
    
    # –°—á–∏—Ç–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π
    count_query = f"SELECT COUNT(*) as count FROM {table};"
    count = pd.read_sql_query(count_query, conn)
    print(f"      –ó–∞–ø–∏—Å–µ–π: {count['count'].iloc[0]:,}")
    print()
```

### üì• **–®–∞–≥ 2: –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ —á–∞—Å—Ç—è–º**

```python
print(f"\nüì• –ó–ê–ì–†–£–ó–ö–ê –î–ê–ù–ù–´–• –ò–ó –ë–ê–ó–´")
print("-" * 25)

# –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–ª–∏–µ–Ω—Ç–æ–≤
–∫–ª–∏–µ–Ω—Ç—ã_query = """
SELECT 
    customer_id,
    customer_name,
    city,
    country,
    customer_segment,
    total_spent,
    registration_date
FROM customers
ORDER BY total_spent DESC
"""

df_customers = pd.read_sql_query(–∫–ª–∏–µ–Ω—Ç—ã_query, conn)
print(f"üë• –ó–∞–≥—Ä—É–∂–µ–Ω–æ –∫–ª–∏–µ–Ω—Ç–æ–≤: {len(df_customers)}")
print("–¢–æ–ø-3 –∫–ª–∏–µ–Ω—Ç–∞ –ø–æ —Ç—Ä–∞—Ç–∞–º:")
print(df_customers[['customer_name', 'total_spent', 'customer_segment']].head(3))

# –ó–∞–≥—Ä—É–∂–∞–µ–º –∑–∞–∫–∞–∑—ã —Å JOIN'–∞–º–∏
–∑–∞–∫–∞–∑—ã_query = """
SELECT 
    o.order_id,
    o.customer_id,
    c.customer_name,
    c.city,
    c.country,
    o.order_date,
    o.total_amount,
    o.status
FROM orders o
JOIN customers c ON o.customer_id = c.customer_id
WHERE o.status IN ('Completed', 'Shipped')
ORDER BY o.order_date DESC
"""

df_orders = pd.read_sql_query(–∑–∞–∫–∞–∑—ã_query, conn)
print(f"\nüõí –ó–∞–≥—Ä—É–∂–µ–Ω–æ –∑–∞–∫–∞–∑–æ–≤: {len(df_orders)}")
print("–ü–æ—Å–ª–µ–¥–Ω–∏–µ 3 –∑–∞–∫–∞–∑–∞:")
print(df_orders[['customer_name', 'order_date', 'total_amount', 'status']].head(3))

# –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–µ—Ç–∞–ª–∏ –∑–∞–∫–∞–∑–æ–≤ —Å —Ç–æ–≤–∞—Ä–∞–º–∏
–¥–µ—Ç–∞–ª–∏_query = """
SELECT 
    oi.order_id,
    oi.product_id,
    p.product_name,
    p.supplier,
    c.category_name,
    oi.quantity,
    oi.unit_price,
    oi.total_price,
    p.unit_cost,
    (oi.total_price - (oi.quantity * p.unit_cost)) as profit
FROM order_items oi
JOIN products p ON oi.product_id = p.product_id
JOIN categories c ON p.category_id = c.category_id
ORDER BY oi.total_price DESC
"""

df_order_items = pd.read_sql_query(–¥–µ—Ç–∞–ª–∏_query, conn)
print(f"\nüì¶ –ó–∞–≥—Ä—É–∂–µ–Ω–æ –ø–æ–∑–∏—Ü–∏–π –∑–∞–∫–∞–∑–æ–≤: {len(df_order_items)}")
print("–¢–æ–ø-3 –ø–æ–∑–∏—Ü–∏–∏ –ø–æ –≤—ã—Ä—É—á–∫–µ:")
print(df_order_items[['product_name', 'quantity', 'total_price', 'profit']].head(3))
```

### üîÑ **–®–∞–≥ 3: –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ Pandas**

```python
print(f"\nüîÑ –û–ë–†–ê–ë–û–¢–ö–ê –î–ê–ù–ù–´–• –í PANDAS")
print("-" * 28)

# –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –¥–∞—Ç—ã
df_orders['order_date'] = pd.to_datetime(df_orders['order_date'])
df_customers['registration_date'] = pd.to_datetime(df_customers['registration_date'])

# –î–æ–±–∞–≤–ª—è–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
df_orders['–≥–æ–¥'] = df_orders['order_date'].dt.year
df_orders['–º–µ—Å—è—Ü'] = df_orders['order_date'].dt.month
df_orders['–∫–≤–∞—Ä—Ç–∞–ª'] = df_orders['order_date'].dt.quarter
df_orders['–¥–µ–Ω—å_–Ω–µ–¥–µ–ª–∏'] = df_orders['order_date'].dt.day_name()

print("üìÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∫ –∑–∞–∫–∞–∑–∞–º")

# –°–æ–∑–¥–∞–µ–º –∫–æ–º–ø–ª–µ–∫—Å–Ω—É—é –∞–Ω–∞–ª–∏—Ç–∏–∫—É –∫–ª–∏–µ–Ω—Ç–æ–≤
print(f"\nüìä –°–û–ó–î–ê–ù–ò–ï –ö–û–ú–ü–õ–ï–ö–°–ù–û–ô –ê–ù–ê–õ–ò–¢–ò–ö–ò")
print("-" * 32)

customer_analytics = df_orders.groupby(['customer_id', 'customer_name', 'city', 'country']).agg({
    'order_id': 'count',
    'total_amount': ['sum', 'mean'],
    'order_date': ['min', 'max']
}).round(2)

# –£–ø—Ä–æ—â–∞–µ–º –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤
customer_analytics.columns = ['orders_count', 'total_revenue', 'avg_order_value', 'first_order', 'last_order']
customer_analytics = customer_analytics.reset_index()

# –î–æ–±–∞–≤–ª—è–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏
customer_analytics['customer_lifetime_days'] = (
    customer_analytics['last_order'] - customer_analytics['first_order']
).dt.days

# –ò–∑–±–µ–≥–∞–µ–º –¥–µ–ª–µ–Ω–∏—è –Ω–∞ –Ω–æ–ª—å
customer_analytics['orders_per_month'] = customer_analytics['orders_count'] / np.maximum(
    customer_analytics['customer_lifetime_days'] / 30.44, 1
)

# RFM –∞–Ω–∞–ª–∏–∑
def calculate_rfm_score(row):
    """–†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º RFM –æ—Ü–µ–Ω–∫—É –∫–ª–∏–µ–Ω—Ç–∞"""
    recency = (datetime.now() - row['last_order']).days
    frequency = row['orders_count']
    monetary = row['total_revenue']
    
    # –ü—Ä–æ—Å—Ç–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ—Ü–µ–Ω–æ–∫ –æ—Ç 1 –¥–æ 5
    r_score = 5 if recency <= 30 else 4 if recency <= 90 else 3 if recency <= 180 else 2 if recency <= 365 else 1
    f_score = 5 if frequency >= 5 else 4 if frequency >= 3 else 3 if frequency >= 2 else 2 if frequency > 1 else 1
    m_score = 5 if monetary >= 5000 else 4 if monetary >= 2000 else 3 if monetary >= 1000 else 2 if monetary >= 500 else 1
    
    return f"{r_score}{f_score}{m_score}"

customer_analytics['rfm_score'] = customer_analytics.apply(calculate_rfm_score, axis=1)

# –°–µ–≥–º–µ–Ω—Ç–∏—Ä—É–µ–º –∫–ª–∏–µ–Ω—Ç–æ–≤
def categorize_customer(rfm):
    """–ö–∞—Ç–µ–≥–æ—Ä–∏–∑–∏—Ä—É–µ–º –∫–ª–∏–µ–Ω—Ç–æ–≤ –ø–æ RFM"""
    if rfm in ['555', '554', '544', '545', '454', '455', '445']:
        return 'Champions üèÜ'
    elif rfm in ['543', '444', '435', '355', '354', '345', '344', '335']:
        return 'Loyal Customers üíé'
    elif rfm in ['512', '511', '422', '421', '412', '411']:
        return 'New Customers üåü'
    elif rfm in ['155', '154', '144', '214', '215', '115', '114']:
        return 'At Risk ‚ö†Ô∏è'
    else:
        return 'Others üë§'

customer_analytics['customer_category'] = customer_analytics['rfm_score'].apply(categorize_customer)

print("‚úÖ RFM –∞–Ω–∞–ª–∏–∑ –∏ —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤ –∑–∞–≤–µ—Ä—à–µ–Ω—ã")

# –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
print(f"\nüìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏:")
segmentation = customer_analytics['customer_category'].value_counts()
for category, count in segmentation.items():
    avg_revenue = customer_analytics[customer_analytics['customer_category'] == category]['total_revenue'].mean()
    print(f"   {category}: {count} –∫–ª–∏–µ–Ω—Ç–æ–≤ (—Å—Ä–µ–¥–Ω—è—è –≤—ã—Ä—É—á–∫–∞: ${avg_revenue:,.2f})")
```

### üìä **–®–∞–≥ 4: –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤**

```python
print(f"\nüì¶ –ê–ù–ê–õ–ò–ó –¢–û–í–ê–†–ù–û–ì–û –ü–û–†–¢–§–ï–õ–Ø")
print("-" * 25)

# –û–±—ä–µ–¥–∏–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –æ —Ç–æ–≤–∞—Ä–∞—Ö —Å –∑–∞–∫–∞–∑–∞–º–∏ –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
product_analysis = df_order_items.groupby(['product_name', 'category_name', 'supplier']).agg({
    'quantity': 'sum',
    'total_price': 'sum',
    'profit': 'sum',
    'order_id': 'count'
}).round(2)

product_analysis.columns = ['total_quantity', 'total_revenue', 'total_profit', 'times_ordered']
product_analysis = product_analysis.reset_index()

# –î–æ–±–∞–≤–ª—è–µ–º –º–µ—Ç—Ä–∏–∫–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
product_analysis['profit_margin'] = (product_analysis['total_profit'] / product_analysis['total_revenue'] * 100).round(1)
product_analysis['avg_order_size'] = (product_analysis['total_quantity'] / product_analysis['times_ordered']).round(1)

print("üèÜ –¢–û–ü-5 –¢–û–í–ê–†–û–í –ü–û –ü–†–ò–ë–´–õ–ò:")
top_products = product_analysis.nlargest(5, 'total_profit')
for _, product in top_products.iterrows():
    print(f"   {product['product_name']} ({product['category_name']})")
    print(f"      –ü—Ä–∏–±—ã–ª—å: ${product['total_profit']:,.2f}")
    print(f"      –ú–∞—Ä–∂–∞: {product['profit_margin']}%")
    print(f"      –ó–∞–∫–∞–∑–æ–≤: {product['times_ordered']}")
    print()

# –ê–Ω–∞–ª–∏–∑ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
category_analysis = product_analysis.groupby('category_name').agg({
    'total_revenue': 'sum',
    'total_profit': 'sum',
    'times_ordered': 'sum'
}).round(2)

category_analysis['category_margin'] = (category_analysis['total_profit'] / category_analysis['total_revenue'] * 100).round(1)

print("üìä –ê–ù–ê–õ–ò–ó –ü–û –ö–ê–¢–ï–ì–û–†–ò–Ø–ú:")
for category, data in category_analysis.iterrows():
    print(f"   {category}:")
    print(f"      –í—ã—Ä—É—á–∫–∞: ${data['total_revenue']:,.2f}")
    print(f"      –ü—Ä–∏–±—ã–ª—å: ${data['total_profit']:,.2f}")
    print(f"      –ú–∞—Ä–∂–∞: {data['category_margin']}%")
```

### üì§ **–®–∞–≥ 5: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö**

```python
print(f"\nüì§ –°–û–•–†–ê–ù–ï–ù–ò–ï –†–ï–ó–£–õ–¨–¢–ê–¢–û–í –í –ë–ê–ó–£ –î–ê–ù–ù–´–•")
print("-" * 38)

try:
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∞–Ω–∞–ª–∏—Ç–∏–∫—É –∫–ª–∏–µ–Ω—Ç–æ–≤
    customer_analytics.to_sql('customer_analytics', conn, if_exists='replace', index=False)
    print("‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ —Ç–∞–±–ª–∏—Ü–∞ customer_analytics")
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∞–Ω–∞–ª–∏–∑ —Ç–æ–≤–∞—Ä–æ–≤
    product_analysis.to_sql('product_analytics', conn, if_exists='replace', index=False)
    print("‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ —Ç–∞–±–ª–∏—Ü–∞ product_analytics")
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∞–Ω–∞–ª–∏–∑ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
    category_analysis.reset_index().to_sql('category_analytics', conn, if_exists='replace', index=False)
    print("‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ —Ç–∞–±–ª–∏—Ü–∞ category_analytics")
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–∏–ª–∏—Å—å
    verification_query = """
    SELECT name, 
           (SELECT COUNT(*) FROM customer_analytics) as customer_count,
           (SELECT COUNT(*) FROM product_analytics) as product_count,
           (SELECT COUNT(*) FROM category_analytics) as category_count
    FROM sqlite_master 
    WHERE type='table' AND name LIKE '%analytics%'
    """
    
    verification = pd.read_sql_query(verification_query, conn)
    print(f"\nüìä –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:")
    for _, row in verification.iterrows():
        print(f"   customer_analytics: {row['customer_count']} –∑–∞–ø–∏—Å–µ–π")
        print(f"   product_analytics: {row['product_count']} –∑–∞–ø–∏—Å–µ–π")  
        print(f"   category_analytics: {row['category_count']} –∑–∞–ø–∏—Å–µ–π")
        break
    
except Exception as e:
    print(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏: {e}")

# –°–æ–∑–¥–∞–µ–º –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –¥–∞—à–±–æ—Ä–¥ –≤ –≤–∏–¥–µ SQL –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è
dashboard_query = """
CREATE VIEW IF NOT EXISTS executive_dashboard AS
SELECT 
    'Total Revenue' as metric,
    printf('$%.2f', SUM(o.total_amount)) as value
FROM orders o
WHERE o.status IN ('Completed', 'Shipped')

UNION ALL

SELECT 
    'Total Customers' as metric,
    CAST(COUNT(DISTINCT c.customer_id) AS TEXT) as value
FROM customers c

UNION ALL

SELECT 
    'Average Order Value' as metric,
    printf('$%.2f', AVG(o.total_amount)) as value
FROM orders o
WHERE o.status IN ('Completed', 'Shipped')

UNION ALL

SELECT 
    'Total Orders' as metric,
    CAST(COUNT(*) AS TEXT) as value
FROM orders o
WHERE o.status IN ('Completed', 'Shipped')
"""

try:
    conn.execute(dashboard_query)
    conn.commit()
    
    dashboard = pd.read_sql_query("SELECT * FROM executive_dashboard", conn)
    print(f"\nüìä –ò–°–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ô –î–ê–®–ë–û–†–î:")
    for _, row in dashboard.iterrows():
        print(f"   {row['metric']}: {row['value']}")
    
    print("‚úÖ –°–æ–∑–¥–∞–Ω–æ SQL –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ executive_dashboard")
    
except Exception as e:
    print(f"‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –¥–∞—à–±–æ—Ä–¥: {e}")

# –ó–∞–∫—Ä—ã–≤–∞–µ–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
conn.close()
print(f"\nüîí –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö –∑–∞–∫—Ä—ã—Ç–æ")
print("‚úÖ IT-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ!")
```

**‚ùì –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã:**
1. –ö–∞–∫–∏–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –¥–∞–µ—Ç –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ SQL –∏ Pandas?
2. –ö–æ–≥–¥–∞ –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å SQL, –∞ –∫–æ–≥–¥–∞ Pandas?
3. –ö–∞–∫ –º–æ–∂–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–æ—Ç –ø—Ä–æ—Ü–µ—Å—Å –¥–ª—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞–±–æ—Ç—ã?

---

## üìä –ó–∞–¥–∞–Ω–∏–µ 5: "–î–∏—Ä–µ–∫—Ç–æ—Ä –ø–æ –∞–Ω–∞–ª–∏—Ç–∏–∫–µ" ‚Äî —Å–æ–∑–¥–∞–µ–º –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –¥–∞—à–±–æ—Ä–¥

**üé¨ –í–∞—à–∞ —Ä–æ–ª—å:** –í—ã –¥–∏—Ä–µ–∫—Ç–æ—Ä –ø–æ –∞–Ω–∞–ª–∏—Ç–∏–∫–µ. –ù—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –æ—Ç—á–µ—Ç –¥–ª—è —Å–æ–≤–µ—Ç–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–æ–≤ —Å –∫–ª—é—á–µ–≤—ã–º–∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º–∏, —Ç—Ä–µ–Ω–¥–∞–º–∏ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏.

**üìã –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:**
1. –û–±—ä–µ–¥–∏–Ω–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –∑–∞–¥–∞–Ω–∏–π
2. –°–æ–∑–¥–∞—Ç—å —Å–∏—Å—Ç–µ–º—É KPI
3. –ù–∞–π—Ç–∏ —Ç—Ä–µ–Ω–¥—ã –∏ –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏
4. –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —Ä–µ–∑—é–º–µ
5. –î–∞—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

**üìÅ –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ñ–∞–π–ª—ã:** –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—Å–µ—Ö –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –∑–∞–¥–∞–Ω–∏–π

### üìä **–®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã**

```python
import pandas as pd
import numpy as np
from datetime import datetime, timedelta
import warnings
warnings.filterwarnings('ignore')

print("üìä –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π —Ü–µ–Ω—Ç—Ä 'Executive Dashboard'")
print("–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ—Ç—á–µ—Ç–∞ –¥–ª—è —Å–æ–≤–µ—Ç–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–æ–≤")
print("=" * 50)

# –ó–∞–≥—Ä—É–∂–∞–µ–º –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
datasets = {}

files_to_load = [
    ('cleaned_ecommerce_data.csv', 'cleaned_local'),
    ('customer_profiles.csv', 'customer_profiles'),
    ('unified_analysis.csv', 'unified'),
    ('files/large_dataset_sample.csv', 'global')
]

for filename, key in files_to_load:
    try:
        datasets[key] = pd.read_csv(filename)
        print(f"‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω {key}: {len(datasets[key]):,} –∑–∞–ø–∏—Å–µ–π")
    except FileNotFoundError:
        print(f"‚ö†Ô∏è –§–∞–π–ª {filename} –Ω–µ –Ω–∞–π–¥–µ–Ω")

# –í—ã–±–∏—Ä–∞–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π –¥–∞—Ç–∞—Å–µ—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
if 'global' in datasets:
    df_main = datasets['global'].copy()
    source_name = "–ì–ª–æ–±–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ"
elif 'unified' in datasets:
    df_main = datasets['unified'].copy()
    source_name = "–û–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ"
elif 'cleaned_local' in datasets:
    df_main = datasets['cleaned_local'].copy()
    source_name = "–õ–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ"
else:
    print("‚ùå –ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞")
    exit()

print(f"\nüéØ –û—Å–Ω–æ–≤–Ω–æ–π –¥–∞—Ç–∞—Å–µ—Ç: {source_name}")
print(f"üìä –†–∞–∑–º–µ—Ä: {len(df_main):,} –∑–∞–ø–∏—Å–µ–π, {len(df_main.columns)} —Å—Ç–æ–ª–±—Ü–æ–≤")

# –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
if 'order_date' in df_main.columns:
    df_main['order_date'] = pd.to_datetime(df_main['order_date'], errors='coerce')

# –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–æ–ª–µ —Å —Å—É–º–º–æ–π –∑–∞–∫–∞–∑–∞
amount_column = None
for col in ['final_price', 'total_amount', 'price']:
    if col in df_main.columns:
        amount_column = col
        break

if amount_column:
    df_main['revenue'] = df_main[amount_column]
    if 'quantity' in df_main.columns:
        df_main['revenue'] = df_main[amount_column] * df_main['quantity']
else:
    print("‚ö†Ô∏è –ù–µ –Ω–∞–π–¥–µ–Ω–æ –ø–æ–ª–µ —Å —Å—É–º–º–æ–π –∑–∞–∫–∞–∑–∞, —Å–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤–æ–µ")
    df_main['revenue'] = np.random.uniform(100, 2000, len(df_main))

print(f"üí∞ –û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞ –≤ –∞–Ω–∞–ª–∏–∑–µ: ${df_main['revenue'].sum():,.2f}")
```

### üìà **–®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã KPI**

```python
print(f"\nüìà –ö–õ–Æ–ß–ï–í–´–ï –ü–û–ö–ê–ó–ê–¢–ï–õ–ò –≠–§–§–ï–ö–¢–ò–í–ù–û–°–¢–ò (KPI)")
print("=" * 45)

# –û—Å–Ω–æ–≤–Ω—ã–µ KPI
kpi = {}

# –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ KPI
kpi['–æ–±—â–∞—è_–≤—ã—Ä—É—á–∫–∞'] = df_main['revenue'].sum()
kpi['—Å—Ä–µ–¥–Ω–∏–π_—á–µ–∫'] = df_main['revenue'].mean()
kpi['–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–∑–∞–∫–∞–∑–æ–≤'] = len(df_main)

# –ö–ª–∏–µ–Ω—Ç—Å–∫–∏–µ KPI
customer_column = None
for col in ['customer_id', 'customer_name']:
    if col in df_main.columns:
        customer_column = col
        break

if customer_column:
    kpi['–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–∫–ª–∏–µ–Ω—Ç–æ–≤'] = df_main[customer_column].nunique()
    kpi['–≤—ã—Ä—É—á–∫–∞_–Ω–∞_–∫–ª–∏–µ–Ω—Ç–∞'] = kpi['–æ–±—â–∞—è_–≤—ã—Ä—É—á–∫–∞'] / kpi['–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–∫–ª–∏–µ–Ω—Ç–æ–≤']
    kpi['–∑–∞–∫–∞–∑–æ–≤_–Ω–∞_–∫–ª–∏–µ–Ω—Ç–∞'] = kpi['–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–∑–∞–∫–∞–∑–æ–≤'] / kpi['–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–∫–ª–∏–µ–Ω—Ç–æ–≤']

# –¢–æ–≤–∞—Ä–Ω—ã–µ KPI
if 'category' in df_main.columns:
    kpi['–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–∫–∞—Ç–µ–≥–æ—Ä–∏–π'] = df_main['category'].nunique()

if 'product' in df_main.columns or 'product_name' in df_main.columns:
    product_col = 'product' if 'product' in df_main.columns else 'product_name'
    kpi['–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_—Ç–æ–≤–∞—Ä–æ–≤'] = df_main[product_col].nunique()

# –ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ KPI
if 'region' in df_main.columns:
    kpi['–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_—Ä–µ–≥–∏–æ–Ω–æ–≤'] = df_main['region'].nunique()

if 'country' in df_main.columns:
    kpi['–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_—Å—Ç—Ä–∞–Ω'] = df_main['country'].nunique()

# –í—ã–≤–æ–¥–∏–º KPI
print("üíº –§–ò–ù–ê–ù–°–û–í–´–ï –ü–û–ö–ê–ó–ê–¢–ï–õ–ò:")
print(f"   üí∞ –û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞: ${kpi['–æ–±—â–∞—è_–≤—ã—Ä—É—á–∫–∞']:,.2f}")
print(f"   üí≥ –°—Ä–µ–¥–Ω–∏–π —á–µ–∫: ${kpi['—Å—Ä–µ–¥–Ω–∏–π_—á–µ–∫']:,.2f}")
print(f"   üõí –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤: {kpi['–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–∑–∞–∫–∞–∑–æ–≤']:,}")

if customer_column:
    print(f"\nüë• –ö–õ–ò–ï–ù–¢–°–ö–ò–ï –ü–û–ö–ê–ó–ê–¢–ï–õ–ò:")
    print(f"   üë§ –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤: {kpi['–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–∫–ª–∏–µ–Ω—Ç–æ–≤']:,}")
    print(f"   üí∞ –í—ã—Ä—É—á–∫–∞ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–∞: ${kpi['–≤—ã—Ä—É—á–∫–∞_–Ω–∞_–∫–ª–∏–µ–Ω—Ç–∞']:,.2f}")
    print(f"   üìà –ó–∞–∫–∞–∑–æ–≤ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–∞: {kpi['–∑–∞–∫–∞–∑–æ–≤_–Ω–∞_–∫–ª–∏–µ–Ω—Ç–∞']:.1f}")

print(f"\nüì¶ –¢–û–í–ê–†–ù–´–ï –ü–û–ö–ê–ó–ê–¢–ï–õ–ò:")
if '–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–∫–∞—Ç–µ–≥–æ—Ä–∏–π' in kpi:
    print(f"   üè∑Ô∏è –ö–∞—Ç–µ–≥–æ—Ä–∏–π —Ç–æ–≤–∞—Ä–æ–≤: {kpi['–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–∫–∞—Ç–µ–≥–æ—Ä–∏–π']}")
if '–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_—Ç–æ–≤–∞—Ä–æ–≤' in kpi:
    print(f"   üì¶ –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤: {kpi['–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_—Ç–æ–≤–∞—Ä–æ–≤']}")

if '–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_—Ä–µ–≥–∏–æ–Ω–æ–≤' in kpi:
    print(f"\nüåç –ì–ï–û–ì–†–ê–§–ò–ß–ï–°–ö–ò–ï –ü–û–ö–ê–ó–ê–¢–ï–õ–ò:")
    print(f"   üó∫Ô∏è –†–µ–≥–∏–æ–Ω–æ–≤: {kpi['–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_—Ä–µ–≥–∏–æ–Ω–æ–≤']}")
    if '–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_—Å—Ç—Ä–∞–Ω' in kpi:
        print(f"   üèÅ –°—Ç—Ä–∞–Ω: {kpi['–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_—Å—Ç—Ä–∞–Ω']}")
```

### üìä **–®–∞–≥ 3: –í—Ä–µ–º–µ–Ω–Ω–æ–π –∞–Ω–∞–ª–∏–∑ –∏ —Ç—Ä–µ–Ω–¥—ã**

```python
print(f"\nüìä –ê–ù–ê–õ–ò–ó –¢–†–ï–ù–î–û–í –ò –í–†–ï–ú–ï–ù–ù–´–• –ü–ê–¢–¢–ï–†–ù–û–í")
print("=" * 40)

if 'order_date' in df_main.columns and df_main['order_date'].notna().sum() > 100:
    
    # –ì–æ—Ç–æ–≤–∏–º –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
    df_temp = df_main[df_main['order_date'].notna()].copy()
    df_temp['year'] = df_temp['order_date'].dt.year
    df_temp['month'] = df_temp['order_date'].dt.month
    df_temp['quarter'] = df_temp['order_date'].dt.quarter
    df_temp['day_of_week'] = df_temp['order_date'].dt.day_name()
    
    # –ê–Ω–∞–ª–∏–∑ –ø–æ –≥–æ–¥–∞–º
    if df_temp['year'].nunique() > 1:
        yearly_trends = df_temp.groupby('year').agg({
            'revenue': ['sum', 'mean', 'count'],
            customer_column: 'nunique' if customer_column else lambda x: len(x)
        }).round(2)
        
        yearly_trends.columns = ['total_revenue', 'avg_order', 'orders_count', 'unique_customers']
        
        print("üìÖ –¢–†–ï–ù–î–´ –ü–û –ì–û–î–ê–ú:")
        for year, data in yearly_trends.iterrows():
            print(f"   {year}: ${data['total_revenue']:,.2f} –≤—ã—Ä—É—á–∫–∞, {data['orders_count']:,} –∑–∞–∫–∞–∑–æ–≤")
        
        # –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —Ä–æ—Å—Ç –≥–æ–¥ –∫ –≥–æ–¥—É
        if len(yearly_trends) >= 2:
            years = sorted(yearly_trends.index)
            current_year = years[-1]
            previous_year = years[-2]
            
            revenue_growth = ((yearly_trends.loc[current_year, 'total_revenue'] - 
                             yearly_trends.loc[previous_year, 'total_revenue']) / 
                             yearly_trends.loc[previous_year, 'total_revenue']) * 100
            
            print(f"\nüìà –†–æ—Å—Ç –≤—ã—Ä—É—á–∫–∏ {previous_year} ‚Üí {current_year}: {revenue_growth:+.1f}%")
    
    # –°–µ–∑–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑
    seasonal_analysis = df_temp.groupby('month').agg({
        'revenue': ['sum', 'mean'],
        'order_date': 'count'
    }).round(2)
    
    seasonal_analysis.columns = ['monthly_revenue', 'avg_monthly_order', 'orders_count']
    
    months = ['', '–Ø–Ω–≤', '–§–µ–≤', '–ú–∞—Ä', '–ê–ø—Ä', '–ú–∞–π', '–ò—é–Ω',
              '–ò—é–ª', '–ê–≤–≥', '–°–µ–Ω', '–û–∫—Ç', '–ù–æ—è', '–î–µ–∫']
    
    print(f"\nüìä –°–ï–ó–û–ù–ù–û–°–¢–¨ –ü–†–û–î–ê–ñ:")
    for month_num, data in seasonal_analysis.iterrows():
        month_name = months[month_num] if month_num <= 12 else f"–ú{month_num}"
        share = (data['monthly_revenue'] / seasonal_analysis['monthly_revenue'].sum()) * 100
        print(f"   {month_name}: ${data['monthly_revenue']:,.2f} ({share:.1f}%)")
    
    # –ù–∞—Ö–æ–¥–∏–º –ø–∏–∫–∏ –∏ —Å–ø–∞–¥—ã
    best_month = seasonal_analysis['monthly_revenue'].idxmax()
    worst_month = seasonal_analysis['monthly_revenue'].idxmin()
    
    print(f"\nüèÜ –õ—É—á—à–∏–π –º–µ—Å—è—Ü: {months[best_month]} (${seasonal_analysis.loc[best_month, 'monthly_revenue']:,.2f})")
    print(f"üìâ –•—É–¥—à–∏–π –º–µ—Å—è—Ü: {months[worst_month]} (${seasonal_analysis.loc[worst_month, 'monthly_revenue']:,.2f})")
    
    # –ê–Ω–∞–ª–∏–∑ –ø–æ –¥–Ω—è–º –Ω–µ–¥–µ–ª–∏
    weekday_analysis = df_temp.groupby('day_of_week')['revenue'].sum().sort_values(ascending=False)
    
    print(f"\nüìä –ü–†–û–î–ê–ñ–ò –ü–û –î–ù–Ø–ú –ù–ï–î–ï–õ–ò:")
    for day, revenue in weekday_analysis.items():
        share = (revenue / weekday_analysis.sum()) * 100
        print(f"   {day}: ${revenue:,.2f} ({share:.1f}%)")

else:
    print("‚ö†Ô∏è –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞")
```

### üéØ **–®–∞–≥ 4: –°–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑**

```python
print(f"\nüéØ –°–ï–ì–ú–ï–ù–¢–ê–¶–ò–û–ù–ù–´–ô –ê–ù–ê–õ–ò–ó")
print("=" * 25)

# –ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è
if 'region' in df_main.columns and 'country' in df_main.columns:
    print("üåç –ì–ï–û–ì–†–ê–§–ò–ß–ï–°–ö–ò–ô –ê–ù–ê–õ–ò–ó:")
    
    geo_analysis = df_main.groupby(['region', 'country']).agg({
        'revenue': ['sum', 'mean', 'count'],
        customer_column: 'nunique' if customer_column else lambda x: len(x)
    }).round(2)
    
    geo_analysis.columns = ['total_revenue', 'avg_order', 'orders_count', 'unique_customers']
    geo_analysis = geo_analysis.reset_index().sort_values('total_revenue', ascending=False)
    
    print("\nüèÜ –¢–û–ü-5 –°–¢–†–ê–ù –ü–û –í–´–†–£–ß–ö–ï:")
    for i, (_, row) in enumerate(geo_analysis.head().iterrows(), 1):
        share = (row['total_revenue'] / df_main['revenue'].sum()) * 100
        efficiency = row['total_revenue'] / row['unique_customers'] if row['unique_customers'] > 0 else 0
        
        print(f"{i}. {row['country']} ({row['region']})")
        print(f"   üí∞ –í—ã—Ä—É—á–∫–∞: ${row['total_revenue']:,.2f} ({share:.1f}%)")
        print(f"   üë• –ö–ª–∏–µ–Ω—Ç–æ–≤: {row['unique_customers']:,}")
        print(f"   üìä –í—ã—Ä—É—á–∫–∞/–∫–ª–∏–µ–Ω—Ç: ${efficiency:,.2f}")
        print()

# –¢–æ–≤–∞—Ä–Ω–∞—è —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è
if 'category' in df_main.columns:
    print("üì¶ –ê–ù–ê–õ–ò–ó –ü–û –ö–ê–¢–ï–ì–û–†–ò–Ø–ú –¢–û–í–ê–†–û–í:")
    
    category_analysis = df_main.groupby('category').agg({
        'revenue': ['sum', 'mean', 'count'],
        'quantity': 'sum' if 'quantity' in df_main.columns else lambda x: len(x)
    }).round(2)
    
    category_analysis.columns = ['total_revenue', 'avg_order', 'orders_count', 'total_quantity']
    category_analysis = category_analysis.sort_values('total_revenue', ascending=False)
    
    for category, data in category_analysis.iterrows():
        share = (data['total_revenue'] / df_main['revenue'].sum()) * 100
        print(f"\nüè∑Ô∏è {category}:")
        print(f"   üí∞ –í—ã—Ä—É—á–∫–∞: ${data['total_revenue']:,.2f} ({share:.1f}%)")
        print(f"   üõí –ó–∞–∫–∞–∑–æ–≤: {data['orders_count']:,}")
        print(f"   üì¶ –ï–¥–∏–Ω–∏—Ü –ø—Ä–æ–¥–∞–Ω–æ: {data['total_quantity']:,}")
        print(f"   üí≥ –°—Ä–µ–¥–Ω–∏–π —á–µ–∫: ${data['avg_order']:,.2f}")

# –ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è (–µ—Å–ª–∏ –µ—Å—Ç—å –ø—Ä–æ—Ñ–∏–ª–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤)
if 'customer_profiles' in datasets:
    profiles = datasets['customer_profiles']
    
    if '–∫–ª–∞—Å—Å' in profiles.columns:
        print(f"\nüë• –°–ï–ì–ú–ï–ù–¢–ê–¶–ò–Ø –ö–õ–ò–ï–ù–¢–û–í:")
        
        client_segments = profiles['–∫–ª–∞—Å—Å'].value_counts()
        total_revenue_profiles = profiles['–æ–±—â–∞—è_–≤—ã—Ä—É—á–∫–∞'].sum()
        
        for segment, count in client_segments.items():
            segment_revenue = profiles[profiles['–∫–ª–∞—Å—Å'] == segment]['–æ–±—â–∞—è_–≤—ã—Ä—É—á–∫–∞'].sum()
            share = (segment_revenue / total_revenue_profiles) * 100
            avg_revenue = segment_revenue / count
            
            print(f"   {segment}:")
            print(f"      –ö–ª–∏–µ–Ω—Ç–æ–≤: {count} ({count/len(profiles)*100:.1f}%)")
            print(f"      –í—ã—Ä—É—á–∫–∞: ${segment_revenue:,.2f} ({share:.1f}%)")
            print(f"      –°—Ä–µ–¥–Ω—è—è –≤—ã—Ä—É—á–∫–∞/–∫–ª–∏–µ–Ω—Ç: ${avg_revenue:,.2f}")
```

### üìã **–®–∞–≥ 5: –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —Ä–µ–∑—é–º–µ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏**

```python
print(f"\nüìã –ò–°–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–û–ï –†–ï–ó–Æ–ú–ï")
print("=" * 25)

# –°–æ–∑–¥–∞–µ–º —Å–≤–æ–¥–∫—É –∫–ª—é—á–µ–≤—ã—Ö –º–µ—Ç—Ä–∏–∫
executive_summary = {
    '–§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏': {
        '–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞': f"${kpi['–æ–±—â–∞—è_–≤—ã—Ä—É—á–∫–∞']:,.2f}",
        '–°—Ä–µ–¥–Ω–∏–π —á–µ–∫': f"${kpi['—Å—Ä–µ–¥–Ω–∏–π_—á–µ–∫']:,.2f}",
        '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤': f"{kpi['–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–∑–∞–∫–∞–∑–æ–≤']:,}"
    }
}

if customer_column:
    executive_summary['–ö–ª–∏–µ–Ω—Ç—Å–∫–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏'] = {
        '–í—Å–µ–≥–æ –∫–ª–∏–µ–Ω—Ç–æ–≤': f"{kpi['–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–∫–ª–∏–µ–Ω—Ç–æ–≤']:,}",
        '–í—ã—Ä—É—á–∫–∞ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–∞': f"${kpi['–≤—ã—Ä—É—á–∫–∞_–Ω–∞_–∫–ª–∏–µ–Ω—Ç–∞']:,.2f}",
        '–ó–∞–∫–∞–∑–æ–≤ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–∞': f"{kpi['–∑–∞–∫–∞–∑–æ–≤_–Ω–∞_–∫–ª–∏–µ–Ω—Ç–∞']:.1f}"
    }

# –í—ã–≤–æ–¥–∏–º —Ä–µ–∑—é–º–µ
for category, metrics in executive_summary.items():
    print(f"\nüìä {category.upper()}:")
    for metric, value in metrics.items():
        print(f"   ‚Ä¢ {metric}: {value}")

# –ö–ª—é—á–µ–≤—ã–µ –Ω–∞—Ö–æ–¥–∫–∏
print(f"\nüîç –ö–õ–Æ–ß–ï–í–´–ï –ù–ê–•–û–î–ö–ò:")

findings = []

# –ù–∞—Ö–æ–¥–∫–∞ 1: –ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è
if 'region' in df_main.columns:
    top_region_revenue = df_main.groupby('region')['revenue'].sum().max()
    total_revenue = df_main['revenue'].sum()
    concentration = (top_region_revenue / total_revenue) * 100
    
    if concentration > 40:
        top_region = df_main.groupby('region')['revenue'].sum().idxmax()
        findings.append(f"üåç –í—ã—Å–æ–∫–∞—è –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è: {top_region} –¥–∞–µ—Ç {concentration:.1f}% –≤—ã—Ä—É—á–∫–∏")

# –ù–∞—Ö–æ–¥–∫–∞ 2: –¢–æ–≤–∞—Ä–Ω–∞—è –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è  
if 'category' in df_main.columns:
    top_category_revenue = df_main.groupby('category')['revenue'].sum().max()
    category_concentration = (top_category_revenue / total_revenue) * 100
    
    if category_concentration > 30:
        top_category = df_main.groupby('category')['revenue'].sum().idxmax()
        findings.append(f"üì¶ –î–æ–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏: {top_category} —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç {category_concentration:.1f}% –≤—ã—Ä—É—á–∫–∏")

# –ù–∞—Ö–æ–¥–∫–∞ 3: –°–µ–∑–æ–Ω–Ω–æ—Å—Ç—å
if 'order_date' in df_main.columns and df_main['order_date'].notna().sum() > 100:
    df_temp = df_main[df_main['order_date'].notna()].copy()
    monthly_revenues = df_temp.groupby(df_temp['order_date'].dt.month)['revenue'].sum()
    
    if len(monthly_revenues) >= 3:
        seasonality_ratio = monthly_revenues.max() / monthly_revenues.min()
        if seasonality_ratio > 1.5:
            findings.append(f"üìÖ –í—ã—Ä–∞–∂–µ–Ω–Ω–∞—è —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç—å: —Ä–∞–∑–±—Ä–æ—Å –ø—Ä–æ–¥–∞–∂ –ø–æ –º–µ—Å—è—Ü–∞–º {seasonality_ratio:.1f}x")

# –í—ã–≤–æ–¥–∏–º –Ω–∞—Ö–æ–¥–∫–∏
for i, finding in enumerate(findings, 1):
    print(f"{i}. {finding}")

if not findings:
    print("üìä –ë–∏–∑–Ω–µ—Å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ –±–µ–∑ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–π")

# –°—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
print(f"\nüí° –°–¢–†–ê–¢–ï–ì–ò–ß–ï–°–ö–ò–ï –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò:")

recommendations = [
    "üìà –†–∞–∑–≤–∏–≤–∞–π—Ç–µ –ª–∏–¥–∏—Ä—É—é—â–∏–µ —Å–µ–≥–º–µ–Ω—Ç—ã —Å –≤—ã—Å–æ–∫–æ–π –º–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å—é",
    "üåç –î–∏–≤–µ—Ä—Å–∏—Ñ–∏—Ü–∏—Ä—É–π—Ç–µ –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–µ –¥–ª—è —Å–Ω–∏–∂–µ–Ω–∏—è —Ä–∏—Å–∫–æ–≤",
    "üë• –í–Ω–µ–¥—Ä–∏—Ç–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏ –¥–ª—è —É–¥–µ—Ä–∂–∞–Ω–∏—è –∫–ª—é—á–µ–≤—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤",
    "üì¶ –û–ø—Ç–∏–º–∏–∑–∏—Ä—É–π—Ç–µ —Ç–æ–≤–∞—Ä–Ω—ã–π –ø–æ—Ä—Ç—Ñ–µ–ª—å –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–∏–±—ã–ª—å–Ω–æ—Å—Ç–∏",
    "üìÖ –ü–ª–∞–Ω–∏—Ä—É–π—Ç–µ –∑–∞–ø–∞—Å—ã –∏ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥ —Å —É—á–µ—Ç–æ–º —Å–µ–∑–æ–Ω–Ω—ã—Ö –∫–æ–ª–µ–±–∞–Ω–∏–π",
    "üìä –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–π—Ç–µ —Å–±–æ—Ä –∏ –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π"
]

for i, rec in enumerate(recommendations, 1):
    print(f"{i}. {rec}")

# –°–æ–∑–¥–∞–µ–º —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –¥–∞—à–±–æ—Ä–¥
dashboard_data = []

for category, metrics in executive_summary.items():
    for metric, value in metrics.items():
        dashboard_data.append({
            'Category': category,
            'Metric': metric,
            'Value': value,
            'Report_Date': datetime.now().strftime('%Y-%m-%d')
        })

dashboard_df = pd.DataFrame(dashboard_data)

# –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç
dashboard_df.to_csv('executive_dashboard.csv', index=False, encoding='utf-8-sig')

# –°–æ–∑–¥–∞–µ–º —Ç–µ–∫—Å—Ç–æ–≤—ã–π –æ—Ç—á–µ—Ç
report_text = f"""
–ò–°–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ô –û–¢–ß–ï–¢ –ü–û –ê–ù–ê–õ–ò–¢–ò–ö–ï –î–ê–ù–ù–´–•
–î–∞—Ç–∞: {datetime.now().strftime('%d.%m.%Y %H:%M')}
–ò—Å—Ç–æ—á–Ω–∏–∫: {source_name}

–ö–õ–Æ–ß–ï–í–´–ï –ü–û–ö–ê–ó–ê–¢–ï–õ–ò:
‚Ä¢ –û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞: ${kpi['–æ–±—â–∞—è_–≤—ã—Ä—É—á–∫–∞']:,.2f}
‚Ä¢ –°—Ä–µ–¥–Ω–∏–π —á–µ–∫: ${kpi['—Å—Ä–µ–¥–Ω–∏–π_—á–µ–∫']:,.2f}
‚Ä¢ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤: {kpi['–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–∑–∞–∫–∞–∑–æ–≤']:,}
"""

if customer_column:
    report_text += f"""‚Ä¢ –ö–ª–∏–µ–Ω—Ç–æ–≤: {kpi['–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–∫–ª–∏–µ–Ω—Ç–æ–≤']:,}
‚Ä¢ –í—ã—Ä—É—á–∫–∞ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–∞: ${kpi['–≤—ã—Ä—É—á–∫–∞_–Ω–∞_–∫–ª–∏–µ–Ω—Ç–∞']:,.2f}
"""

report_text += f"""
–ö–õ–Æ–ß–ï–í–´–ï –ù–ê–•–û–î–ö–ò:
"""

for i, finding in enumerate(findings, 1):
    report_text += f"{i}. {finding}\n"

report_text += f"""
–†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò:
"""

for i, rec in enumerate(recommendations, 1):
    report_text += f"{i}. {rec}\n"

with open('executive_report.txt', 'w', encoding='utf-8') as f:
    f.write(report_text)

print(f"\nüíæ –û–¢–ß–ï–¢–´ –°–û–•–†–ê–ù–ï–ù–´:")
print("   ‚Ä¢ executive_dashboard.csv - –¢–∞–±–ª–∏—á–Ω—ã–π –¥–∞—à–±–æ—Ä–¥")
print("   ‚Ä¢ executive_report.txt - –¢–µ–∫—Å—Ç–æ–≤—ã–π –æ—Ç—á–µ—Ç")

print(f"\nüéâ –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –æ—Ç—á–µ—Ç –¥–ª—è —Å–æ–≤–µ—Ç–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–æ–≤ –≥–æ—Ç–æ–≤!")
print("‚úÖ –í—Å–µ –∑–∞–¥–∞–Ω–∏—è –≥–ª–∞–≤—ã 14 —É—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã!")
```

**‚ùì –°—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã:**
1. –ö–∞–∫–∏–µ –∫–ª—é—á–µ–≤—ã–µ —Ä–∏—Å–∫–∏ –≤—ã –≤—ã—è–≤–∏–ª–∏ –¥–ª—è –±–∏–∑–Ω–µ—Å–∞?
2. –ö–∞–∫–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Ä–æ—Å—Ç–∞ –∏–º–µ—é—Ç –Ω–∞–∏–±–æ–ª—å—à–∏–π –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª?
3. –ö–∞–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏ —Å–ª–µ–¥—É–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –µ–∂–µ–¥–Ω–µ–≤–Ω–æ –¥–ª—è –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è?

---

- üîô [–ü—Ä–µ–¥—ã–¥—É—â–∞—è –≥–ª–∞–≤–∞: –ì–ª–∞–≤–∞ 13 - –û—Å–Ω–æ–≤—ã DAX: –≤—ã—á–∏—Å–ª—è–µ–º—ã–µ —Å—Ç–æ–ª–±—Ü—ã –∏ –º–µ—Ä—ã](../chapter-13/README.md)
- üîú [–°–ª–µ–¥—É—é—â–∞—è –≥–ª–∞–≤–∞: –ì–ª–∞–≤–∞ 15 - –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤ Python: Matplotlib –∏ Seaborn](../chapter-15/README.md)

---

- üì¢ –ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Ç–µ—Å—å –∫ —á–∞—Ç—É –∫—É—Ä—Å–∞: [https://t.me/analytics_course_chat](https://t.me/analytics_course_chat)
- üì¢ –ö–∞–Ω–∞–ª –∫—É—Ä—Å–∞: [https://t.me/analytics_course_channel](https://t.me/analytics_course_channel)