# üìä DAX –§–æ—Ä–º—É–ª—ã –¥–ª—è Power Pivot - –ü—Ä–∏–º–µ—Ä—ã –∏ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è

## üéØ –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–ë–∞–∑–æ–≤—ã–µ –∞–≥—Ä–µ–≥–∞—Ç–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏](#–±–∞–∑–æ–≤—ã–µ-–∞–≥—Ä–µ–≥–∞—Ç–Ω—ã–µ-—Ñ—É–Ω–∫—Ü–∏–∏)
2. [–§—É–Ω–∫—Ü–∏–∏ –≤—Ä–µ–º–µ–Ω–∏](#—Ñ—É–Ω–∫—Ü–∏–∏-–≤—Ä–µ–º–µ–Ω–∏)
3. [–£—Å–ª–æ–≤–Ω—ã–µ —Ä–∞—Å—á–µ—Ç—ã](#—É—Å–ª–æ–≤–Ω—ã–µ-—Ä–∞—Å—á–µ—Ç—ã)
4. [–†–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Ç–æ–ø-N](#—Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ-–∏-—Ç–æ–ø-n)
5. [–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏](#–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ-—Ç–µ—Ö–Ω–∏–∫–∏)

---

## üìà –ë–∞–∑–æ–≤—ã–µ –∞–≥—Ä–µ–≥–∞—Ç–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### üí∞ –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ä—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–æ–¥–∞–∂

```dax
// –û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞
–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞ = SUM(Sales[sales_amount])

// –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–¥–µ–ª–æ–∫ = COUNTROWS(Sales)

// –°—Ä–µ–¥–Ω–∏–π —á–µ–∫
–°—Ä–µ–¥–Ω–∏–π —á–µ–∫ = DIVIDE([–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞], [–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–¥–µ–ª–æ–∫], 0)

// –û–±—â–∞—è —Å–∫–∏–¥–∫–∞
–û–±—â–∞—è —Å–∫–∏–¥–∫–∞ = SUM(Sales[discount_amount])

// –î–æ–ª—è —Å–∫–∏–¥–∫–∏ –≤ –≤—ã—Ä—É—á–∫–µ
–î–æ–ª—è —Å–∫–∏–¥–∫–∏ % = DIVIDE([–û–±—â–∞—è —Å–∫–∏–¥–∫–∞], [–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞] + [–û–±—â–∞—è —Å–∫–∏–¥–∫–∞], 0) * 100

// –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤
–£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ = DISTINCTCOUNT(Sales[customer_id])

// –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤
–£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ = DISTINCTCOUNT(Sales[product_name])

// –°—Ä–µ–¥–Ω—è—è –º–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å
–°—Ä–µ–¥–Ω—è—è –º–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å = AVERAGE(Sales[profit_margin_pct])
```

### üìä –ú–µ—Ä—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ç–æ–≤–∞—Ä–æ–≤

```dax
// –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥–∞–Ω–Ω—ã—Ö –µ–¥–∏–Ω–∏—Ü
–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ = SUM(Sales[quantity])

// –°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞ –∑–∞ –µ–¥–∏–Ω–∏—Ü—É
–°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞ = DIVIDE(SUM(Sales[sales_amount]), SUM(Sales[quantity]), 0)

// –î–æ–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –≤ –æ–±—â–∏—Ö –ø—Ä–æ–¥–∞–∂–∞—Ö
–î–æ–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ % = 
DIVIDE(
    [–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞], 
    CALCULATE([–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞], ALL(Products[category])), 
    0
) * 100

// –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤
–ê–∫—Ç–∏–≤–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ = 
CALCULATE(
    DISTINCTCOUNT(Products[product_id]),
    Products[status] = "Active"
)
```

---

## ‚è∞ –§—É–Ω–∫—Ü–∏–∏ –≤—Ä–µ–º–µ–Ω–∏

### üìÖ –°—Ä–∞–≤–Ω–µ–Ω–∏—è —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º–∏ –ø–µ—Ä–∏–æ–¥–∞–º–∏

```dax
// –ü—Ä–æ–¥–∞–∂–∏ –∑–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–π –º–µ—Å—è—Ü
–ü—Ä–æ–¥–∞–∂–∏ –ø—Ä–æ—à–ª—ã–π –º–µ—Å—è—Ü = 
CALCULATE(
    [–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞],
    PREVIOUSMONTH(Sales[date])
)

// –ü—Ä–æ–¥–∞–∂–∏ –∑–∞ —Ç–æ—Ç –∂–µ –º–µ—Å—è—Ü –ø—Ä–æ—à–ª–æ–≥–æ –≥–æ–¥–∞
–ü—Ä–æ–¥–∞–∂–∏ –ø—Ä–æ—à–ª—ã–π –≥–æ–¥ = 
CALCULATE(
    [–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞],
    SAMEPERIODLASTYEAR(Sales[date])
)

// –†–æ—Å—Ç –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–º—É –º–µ—Å—è—Ü—É
–†–æ—Å—Ç –∫ –ø—Ä–µ–¥. –º–µ—Å—è—Ü—É % = 
DIVIDE(
    [–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞] - [–ü—Ä–æ–¥–∞–∂–∏ –ø—Ä–æ—à–ª—ã–π –º–µ—Å—è—Ü],
    [–ü—Ä–æ–¥–∞–∂–∏ –ø—Ä–æ—à–ª—ã–π –º–µ—Å—è—Ü],
    0
) * 100

// –†–æ—Å—Ç –∫ –ø—Ä–æ—à–ª–æ–º—É –≥–æ–¥—É
–†–æ—Å—Ç –∫ –ø—Ä–æ—à–ª–æ–º—É –≥–æ–¥—É % = 
DIVIDE(
    [–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞] - [–ü—Ä–æ–¥–∞–∂–∏ –ø—Ä–æ—à–ª—ã–π –≥–æ–¥],
    [–ü—Ä–æ–¥–∞–∂–∏ –ø—Ä–æ—à–ª—ã–π –≥–æ–¥],
    0
) * 100
```

### üìà –ù–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω—ã–µ –∏—Ç–æ–≥–∏

```dax
// –ü—Ä–æ–¥–∞–∂–∏ —Å –Ω–∞—á–∞–ª–∞ –≥–æ–¥–∞ (YTD)
–ü—Ä–æ–¥–∞–∂–∏ YTD = 
TOTALYTD(
    [–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞],
    Sales[date]
)

// –ü—Ä–æ–¥–∞–∂–∏ YTD –∑–∞ –ø—Ä–æ—à–ª—ã–π –≥–æ–¥
–ü—Ä–æ–¥–∞–∂–∏ YTD –ø—Ä–æ—à–ª—ã–π –≥–æ–¥ = 
CALCULATE(
    [–ü—Ä–æ–¥–∞–∂–∏ YTD],
    SAMEPERIODLASTYEAR(Sales[date])
)

// –°–∫–æ–ª—å–∑—è—â–∏–µ –ø—Ä–æ–¥–∞–∂–∏ –∑–∞ 3 –º–µ—Å—è—Ü–∞
–ü—Ä–æ–¥–∞–∂–∏ 3–ú —Å–∫–æ–ª—å–∑—è—â–∏–µ = 
CALCULATE(
    [–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞],
    DATESINPERIOD(
        Sales[date],
        MAX(Sales[date]),
        -3,
        MONTH
    )
)

// –°–∫–æ–ª—å–∑—è—â–∏–µ –ø—Ä–æ–¥–∞–∂–∏ –∑–∞ 12 –º–µ—Å—è—Ü–µ–≤
–ü—Ä–æ–¥–∞–∂–∏ 12–ú —Å–∫–æ–ª—å–∑—è—â–∏–µ = 
CALCULATE(
    [–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞],
    DATESINPERIOD(
        Sales[date],
        MAX(Sales[date]),
        -12,
        MONTH
    )
)
```

### üóì –ê–Ω–∞–ª–∏–∑ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ç—Ä–µ–Ω–¥–æ–≤

```dax
// –ù–æ–º–µ—Ä –Ω–µ–¥–µ–ª–∏ –≤ –≥–æ–¥—É
–ù–µ–¥–µ–ª—è –≥–æ–¥–∞ = WEEKNUM(Sales[date])

// –ö–≤–∞—Ä—Ç–∞–ª
–ö–≤–∞—Ä—Ç–∞–ª = "Q" & QUARTER(Sales[date])

// –†–∞–±–æ—á–∏–π –¥–µ–Ω—å (–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫-–ø—è—Ç–Ω–∏—Ü–∞)
–†–∞–±–æ—á–∏–π –¥–µ–Ω—å = 
IF(
    WEEKDAY(Sales[date], 2) <= 5,
    "–†–∞–±–æ—á–∏–π –¥–µ–Ω—å",
    "–í—ã—Ö–æ–¥–Ω–æ–π"
)

// –ü—Ä–æ–¥–∞–∂–∏ —Ç–æ–ª—å–∫–æ –ø–æ —Ä–∞–±–æ—á–∏–º –¥–Ω—è–º
–ü—Ä–æ–¥–∞–∂–∏ —Ä–∞–±–æ—á–∏–µ –¥–Ω–∏ = 
CALCULATE(
    [–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞],
    WEEKDAY(Sales[date], 2) <= 5
)
```

---

## üéØ –£—Å–ª–æ–≤–Ω—ã–µ —Ä–∞—Å—á–µ—Ç—ã

### üíé –°–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤

```dax
// –ü—Ä–æ–¥–∞–∂–∏ VIP –∫–ª–∏–µ–Ω—Ç–∞–º
–ü—Ä–æ–¥–∞–∂–∏ VIP = 
CALCULATE(
    [–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞],
    Customers[segment] = "VIP"
)

// –ü—Ä–æ–¥–∞–∂–∏ B2B —Å–µ–≥–º–µ–Ω—Ç—É
–ü—Ä–æ–¥–∞–∂–∏ B2B = 
CALCULATE(
    [–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞],
    Customers[customer_type] = "B2B"
)

// –°—Ä–µ–¥–Ω–∏–π —á–µ–∫ Premium –∫–ª–∏–µ–Ω—Ç–æ–≤
–°—Ä–µ–¥–Ω–∏–π —á–µ–∫ Premium = 
CALCULATE(
    [–°—Ä–µ–¥–Ω–∏–π —á–µ–∫],
    Customers[segment] = "Premium"
)

// –î–æ–ª—è Premium –∫–ª–∏–µ–Ω—Ç–æ–≤
–î–æ–ª—è Premium –∫–ª–∏–µ–Ω—Ç–æ–≤ % = 
DIVIDE(
    CALCULATE(DISTINCTCOUNT(Sales[customer_id]), Customers[segment] = "Premium"),
    [–£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤],
    0
) * 100
```

### üè™ –ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑

```dax
// –ü—Ä–æ–¥–∞–∂–∏ –ø–æ –ú–æ—Å–∫–≤–µ
–ü—Ä–æ–¥–∞–∂–∏ –ú–æ—Å–∫–≤–∞ = 
CALCULATE(
    [–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞],
    Regions[city] = "–ú–æ—Å–∫–≤–∞"
)

// –ü—Ä–æ–¥–∞–∂–∏ –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –§–û
–ü—Ä–æ–¥–∞–∂–∏ –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –§–û = 
CALCULATE(
    [–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞],
    Regions[federal_district] = "–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –§–û"
)

// –î–æ–ª—è —Ä–µ–≥–∏–æ–Ω–∞ –≤ –æ–±—â–∏—Ö –ø—Ä–æ–¥–∞–∂–∞—Ö
–î–æ–ª—è —Ä–µ–≥–∏–æ–Ω–∞ % = 
DIVIDE(
    [–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞],
    CALCULATE([–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞], ALL(Regions[region])),
    0
) * 100

// –õ—É—á—à–∏–π —Ä–µ–≥–∏–æ–Ω (–ø–æ –≤—ã—Ä—É—á–∫–µ)
–õ—É—á—à–∏–π —Ä–µ–≥–∏–æ–Ω = 
CALCULATE(
    VALUES(Regions[region]),
    TOPN(1, ALL(Regions[region]), [–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞], DESC)
)
```

### üì± –¢–æ–≤–∞—Ä–Ω—ã–π –∞–Ω–∞–ª–∏–∑

```dax
// –ü—Ä–æ–¥–∞–∂–∏ —ç–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∏
–ü—Ä–æ–¥–∞–∂–∏ —ç–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∏ = 
CALCULATE(
    [–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞],
    Products[category] = "–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞"
)

// –ü—Ä–æ–¥–∞–∂–∏ Premium —Ç–æ–≤–∞—Ä–æ–≤
–ü—Ä–æ–¥–∞–∂–∏ Premium —Ç–æ–≤–∞—Ä–æ–≤ = 
CALCULATE(
    [–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞],
    Products[price_segment] = "Premium"
)

// –ü—Ä–æ–¥–∞–∂–∏ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤
–ü—Ä–æ–¥–∞–∂–∏ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ = 
CALCULATE(
    [–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞],
    Products[status] = "Active"
)

// –°—Ä–µ–¥–Ω—è—è –º–∞—Ä–∂–∞ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
–°—Ä–µ–¥–Ω—è—è –º–∞—Ä–∂–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ = 
AVERAGEX(
    VALUES(Products[category]),
    CALCULATE([–°—Ä–µ–¥–Ω—è—è –º–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å])
)
```

---

## üèÜ –†–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Ç–æ–ø-N

### ü•á –¢–æ–ø –∫–ª–∏–µ–Ω—Ç—ã –∏ —Ç–æ–≤–∞—Ä—ã

```dax
// –†–∞–Ω–≥ –∫–ª–∏–µ–Ω—Ç–∞ –ø–æ –≤—ã—Ä—É—á–∫–µ
–†–∞–Ω–≥ –∫–ª–∏–µ–Ω—Ç–∞ = 
RANKX(
    ALL(Customers[customer_id]),
    [–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞],
    ,
    DESC
)

// –¢–æ–ø-10 –∫–ª–∏–µ–Ω—Ç–æ–≤ (–ª–æ–≥–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞)
–¢–æ–ø 10 –∫–ª–∏–µ–Ω—Ç–æ–≤ = 
IF([–†–∞–Ω–≥ –∫–ª–∏–µ–Ω—Ç–∞] <= 10, "–¢–æ–ø-10", "–û—Å—Ç–∞–ª—å–Ω—ã–µ")

// –í—ã—Ä—É—á–∫–∞ –æ—Ç —Ç–æ–ø-20% –∫–ª–∏–µ–Ω—Ç–æ–≤
–í—ã—Ä—É—á–∫–∞ —Ç–æ–ø 20% –∫–ª–∏–µ–Ω—Ç–æ–≤ = 
CALCULATE(
    [–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞],
    TOPN(
        0.2 * [–£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤],
        ALL(Customers[customer_id]),
        [–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞],
        DESC
    )
)

// –†–∞–Ω–≥ —Ç–æ–≤–∞—Ä–∞ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –ø—Ä–æ–¥–∞–∂
–†–∞–Ω–≥ —Ç–æ–≤–∞—Ä–∞ = 
RANKX(
    ALL(Products[product_name]),
    [–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ],
    ,
    DESC
)
```

### üìä ABC –∞–Ω–∞–ª–∏–∑

```dax
// –ù–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω–∞—è –¥–æ–ª—è –≤—ã—Ä—É—á–∫–∏
–ù–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω–∞—è –¥–æ–ª—è % = 
VAR CurrentValue = [–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞]
VAR TotalValue = CALCULATE([–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞], ALL(Products[product_name]))
VAR RankValue = [–†–∞–Ω–∫ —Ç–æ–≤–∞—Ä–∞]

RETURN
DIVIDE(
    SUMX(
        TOPN(RankValue, ALL(Products[product_name]), [–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞], DESC),
        CALCULATE([–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞])
    ),
    TotalValue,
    0
) * 100

// ABC –∫–∞—Ç–µ–≥–æ—Ä–∏—è
ABC –∫–∞—Ç–µ–≥–æ—Ä–∏—è = 
SWITCH(
    TRUE(),
    [–ù–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω–∞—è –¥–æ–ª—è %] <= 80, "A",
    [–ù–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω–∞—è –¥–æ–ª—è %] <= 95, "B",
    "C"
)

// –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ A
–¢–æ–≤–∞—Ä–æ–≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ A = 
CALCULATE(
    DISTINCTCOUNT(Products[product_name]),
    [ABC –∫–∞—Ç–µ–≥–æ—Ä–∏—è] = "A"
)
```

### üéØ –ü–∞—Ä–µ—Ç–æ –∞–Ω–∞–ª–∏–∑

```dax
// 80% –≤—ã—Ä—É—á–∫–∏ (–ø–æ—Ä–æ–≥ –ü–∞—Ä–µ—Ç–æ)
–ü–∞—Ä–µ—Ç–æ 80% –≤—ã—Ä—É—á–∫–∏ = 
CALCULATE([–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞], ALL()) * 0.8

// –¢–æ–ø —Ç–æ–≤–∞—Ä—ã –¥–æ 80% –≤—ã—Ä—É—á–∫–∏
–ü–∞—Ä–µ—Ç–æ —Ç–æ–≤–∞—Ä—ã = 
VAR CumulativeTable = 
ADDCOLUMNS(
    ALL(Products[product_name]),
    "Revenue", CALCULATE([–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞]),
    "CumulativeRevenue", 
    SUMX(
        TOPN(
            EARLIER([–†–∞–Ω–≥ —Ç–æ–≤–∞—Ä–∞]),
            ALL(Products[product_name]),
            [–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞],
            DESC
        ),
        CALCULATE([–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞])
    )
)

RETURN
COUNTROWS(
    FILTER(
        CumulativeTable,
        [CumulativeRevenue] <= [–ü–∞—Ä–µ—Ç–æ 80% –≤—ã—Ä—É—á–∫–∏]
    )
)
```

---

## üöÄ –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏

### üîÑ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è

```dax
// –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–∞—Ç–∞ –≤ –¥–∞–Ω–Ω—ã—Ö
–ü–æ—Å–ª–µ–¥–Ω—è—è –¥–∞—Ç–∞ = MAX(Sales[date])

// –ü–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π
–ü—Ä–æ–¥–∞–∂–∏ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π = 
CALCULATE(
    [–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞],
    Sales[date] > [–ü–æ—Å–ª–µ–¥–Ω—è—è –¥–∞—Ç–∞] - 30
)

// –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π —Å –ø—Ä–æ–¥–∞–∂–∞–º–∏
–î–Ω–µ–π —Å –ø—Ä–æ–¥–∞–∂–∞–º–∏ = 
COUNTROWS(
    SUMMARIZE(
        Sales,
        Sales[date]
    )
)

// –°—Ä–µ–¥–Ω–∏–µ –ø—Ä–æ–¥–∞–∂–∏ –≤ –¥–µ–Ω—å
–°—Ä–µ–¥–Ω–∏–µ –ø—Ä–æ–¥–∞–∂–∏ –≤ –¥–µ–Ω—å = 
DIVIDE(
    [–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞],
    [–î–Ω–µ–π —Å –ø—Ä–æ–¥–∞–∂–∞–º–∏],
    0
)
```

### üìà –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Ç—Ä–µ–Ω–¥—ã

```dax
// –õ–∏–Ω–µ–π–Ω—ã–π —Ç—Ä–µ–Ω–¥ (—É–ø—Ä–æ—â–µ–Ω–Ω—ã–π)
–¢—Ä–µ–Ω–¥ –ø—Ä–æ–¥–∞–∂ = 
VAR StartValue = CALCULATE([–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞], STARTOFYEAR(Sales[date]))
VAR EndValue = CALCULATE([–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞], ENDOFYEAR(Sales[date]))
VAR DaysInYear = DATEDIFF(STARTOFYEAR(Sales[date]), ENDOFYEAR(Sales[date]), DAY)
VAR CurrentDayOfYear = DATEDIFF(STARTOFYEAR(Sales[date]), MAX(Sales[date]), DAY)

RETURN
StartValue + (EndValue - StartValue) * CurrentDayOfYear / DaysInYear

// –û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –æ—Ç —Ç—Ä–µ–Ω–¥–∞
–û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –æ—Ç —Ç—Ä–µ–Ω–¥–∞ % = 
DIVIDE(
    [–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞] - [–¢—Ä–µ–Ω–¥ –ø—Ä–æ–¥–∞–∂],
    [–¢—Ä–µ–Ω–¥ –ø—Ä–æ–¥–∞–∂],
    0
) * 100
```

### üé® –£—Å–ª–æ–≤–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```dax
// –¶–≤–µ—Ç –¥–ª—è KPI (–∫—Ä–∞—Å–Ω—ã–π/–∂–µ–ª—Ç—ã–π/–∑–µ–ª–µ–Ω—ã–π)
–¶–≤–µ—Ç KPI = 
SWITCH(
    TRUE(),
    [–†–æ—Å—Ç –∫ –ø—Ä–æ—à–ª–æ–º—É –≥–æ–¥—É %] < -5, "üî¥ –ü–ª–æ—Ö–æ",
    [–†–æ—Å—Ç –∫ –ø—Ä–æ—à–ª–æ–º—É –≥–æ–¥—É %] < 5, "üü° –ù–æ—Ä–º–∞", 
    "üü¢ –û—Ç–ª–∏—á–Ω–æ"
)

// –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–ª–∞–Ω–∞
–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–ª–∞–Ω–∞ = 
VAR Plan = 20000000  // –£—Å–ª–æ–≤–Ω—ã–π –ø–ª–∞–Ω
VAR Execution = [–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞] / Plan

RETURN
SWITCH(
    TRUE(),
    Execution >= 1, "‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω",
    Execution >= 0.95, "‚ö†Ô∏è –ü–æ—á—Ç–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω",
    "‚ùå –ù–µ –≤—ã–ø–æ–ª–Ω–µ–Ω"
)
```

### üîç –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è

```dax
// –ü—Ä–æ–¥–∞–∂–∏ —Ç–æ–ª—å–∫–æ –Ω–æ–≤—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ (—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ —ç—Ç–æ–º –≥–æ–¥—É)
–ü—Ä–æ–¥–∞–∂–∏ –Ω–æ–≤—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ = 
CALCULATE(
    [–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞],
    YEAR(Customers[registration_date]) = YEAR(MAX(Sales[date]))
)

// –ü—Ä–æ–¥–∞–∂–∏ —Ç–æ–ø –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤ (—Ç–æ–ø-50% –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º)
–ü—Ä–æ–¥–∞–∂–∏ —Ç–æ–ø –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤ = 
VAR TopManagersCount = ROUND([–£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤] * 0.5, 0)

RETURN
CALCULATE(
    [–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞],
    TOPN(
        TopManagersCount,
        ALL(Managers[manager_id]),
        [–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞],
        DESC
    )
)

// –ü—Ä–æ–¥–∞–∂–∏ –±–µ–∑ –≤—ã–±—Ä–æ—Å–æ–≤ (–∏—Å–∫–ª—é—á–∞–µ–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ >99 –ø–µ—Ä—Ü–µ–Ω—Ç–∏–ª—è)
–ü—Ä–æ–¥–∞–∂–∏ –±–µ–∑ –≤—ã–±—Ä–æ—Å–æ–≤ = 
VAR P99 = PERCENTILE.INC(Sales[sales_amount], 0.99)

RETURN
CALCULATE(
    [–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞],
    Sales[sales_amount] <= P99
)
```

---

## üìö –ü–æ–ª–µ–∑–Ω—ã–µ —Å–æ–≤–µ—Ç—ã –ø–æ DAX

### ‚úÖ –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏:

1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (VAR)** –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π
2. **–ò–∑–±–µ–≥–∞–π—Ç–µ –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö CALCULATE** - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ FILTER
3. **–ü—Ä–∏–º–µ–Ω—è–π—Ç–µ DIVIDE** –≤–º–µ—Å—Ç–æ –ø—Ä–æ—Å—Ç–æ–≥–æ –¥–µ–ª–µ–Ω–∏—è –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –æ—à–∏–±–æ–∫
4. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ BLANK()** –≤–º–µ—Å—Ç–æ 0 –¥–ª—è –ø—É—Å—Ç—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
5. **–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Ñ–æ—Ä–º—É–ª—ã** –Ω–∞ –Ω–µ–±–æ–ª—å—à–∏—Ö –≤—ã–±–æ—Ä–∫–∞—Ö –¥–∞–Ω–Ω—ã—Ö

### ‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏:

1. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç —Ñ–∏–ª—å—Ç—Ä–∞** - –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è ALL(), VALUES()
2. **–°–º–µ—à–∏–≤–∞–Ω–∏–µ —Å—Ç—Ä–æ–∫–æ–≤–æ–≥–æ –∏ —á–∏—Å–ª–æ–≤–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞** - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ X-—Ñ—É–Ω–∫—Ü–∏–∏
3. **–ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏** - –∏–∑–±–µ–≥–∞–π—Ç–µ —Å–ª–æ–∂–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –≤ —Å—Ç–æ–ª–±—Ü–∞—Ö
4. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Å–≤—è–∑–∏** –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏
5. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫** –¥–µ–ª–µ–Ω–∏—è –Ω–∞ –Ω–æ–ª—å

### üöÄ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:

```dax
// –ü–ª–æ—Ö–æ - –º–µ–¥–ª–µ–Ω–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞
–ü–ª–æ—Ö–∞—è —Ñ–æ—Ä–º—É–ª–∞ = 
SUMX(
    Sales,
    IF(Sales[category] = "–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞", Sales[sales_amount], 0)
)

// –•–æ—Ä–æ—à–æ - –±—ã—Å—Ç—Ä–∞—è —Ñ–æ—Ä–º—É–ª–∞
–•–æ—Ä–æ—à–∞—è —Ñ–æ—Ä–º—É–ª–∞ = 
CALCULATE(
    SUM(Sales[sales_amount]),
    Products[category] = "–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞"
)
```

---

## üéØ –ì–æ—Ç–æ–≤—ã–µ —à–∞–±–ª–æ–Ω—ã –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è

### üìä –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –Ω–∞–±–æ—Ä –º–µ—Ä –¥–ª—è –ª—é–±–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞:

```dax
// === –ë–ê–ó–û–í–´–ï –ú–ï–†–´ ===
–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞ = SUM(Sales[sales_amount])
–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–¥–µ–ª–æ–∫ = COUNTROWS(Sales)
–°—Ä–µ–¥–Ω–∏–π —á–µ–∫ = DIVIDE([–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞], [–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–¥–µ–ª–æ–∫], 0)
–£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ = DISTINCTCOUNT(Sales[customer_id])

// === –í–†–ï–ú–ï–ù–ù–´–ï –°–†–ê–í–ù–ï–ù–ò–Ø ===
–ü—Ä–æ—à–ª—ã–π –ø–µ—Ä–∏–æ–¥ = CALCULATE([–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞], PREVIOUSMONTH(Sales[date]))
–†–æ—Å—Ç % = DIVIDE([–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞] - [–ü—Ä–æ—à–ª—ã–π –ø–µ—Ä–∏–æ–¥], [–ü—Ä–æ—à–ª—ã–π –ø–µ—Ä–∏–æ–¥], 0) * 100
YTD = TOTALYTD([–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞], Sales[date])

// === –î–û–õ–ò –ò –ü–†–û–¶–ï–ù–¢–´ ===
–î–æ–ª—è –≤ –æ–±—â–µ–º % = DIVIDE([–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞], CALCULATE([–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞], ALL()), 0) * 100

// === –†–ê–ù–ñ–ò–†–û–í–ê–ù–ò–ï ===
–†–∞–Ω–≥ = RANKX(ALL(Table[Column]), [–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞], , DESC)
–¢–æ–ø 10 = IF([–†–∞–Ω–≥] <= 10, "–¢–æ–ø-10", "–û—Å—Ç–∞–ª—å–Ω—ã–µ")
```

–≠—Ç–∏ —Ñ–æ—Ä–º—É–ª—ã –º–æ–∂–Ω–æ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥ –ª—é–±—É—é –ø—Ä–µ–¥–º–µ—Ç–Ω—É—é –æ–±–ª–∞—Å—Ç—å, –∑–∞–º–µ–Ω–∏–≤ –Ω–∞–∑–≤–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü –∏ —Å—Ç–æ–ª–±—Ü–æ–≤ –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –≤–∞—à–∏–º –¥–∞–Ω–Ω—ã–º!