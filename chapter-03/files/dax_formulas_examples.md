# üìä –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ DAX-—Ñ–æ—Ä–º—É–ª –¥–ª—è Power Pivot

## üìã –û–±–∑–æ—Ä –±–∏–±–ª–∏–æ—Ç–µ–∫–∏

–≠—Ç–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ DAX-—Ñ–æ—Ä–º—É–ª—ã –¥–ª—è —Ç–∏–ø–æ–≤—ã—Ö –±–∏–∑–Ω–µ—Å-—Ä–∞—Å—á–µ—Ç–æ–≤ –≤ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –º–æ–¥–µ–ª—è—Ö. –í—Å–µ —Ñ–æ—Ä–º—É–ª—ã –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ —Å–æ–¥–µ—Ä–∂–∞—Ç –ø–æ–¥—Ä–æ–±–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –ª–æ–≥–∏–∫–∏ —Ä–∞–±–æ—Ç—ã.

---

## üî¢ –ë–∞–∑–æ–≤—ã–µ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è

### üìà **–û—Å–Ω–æ–≤–Ω—ã–µ –∞–≥—Ä–µ–≥–∞—Ç–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏**

#### üí∞ –û–±—â–∞—è —Å—É–º–º–∞ –ø—Ä–æ–¥–∞–∂
```dax
Total_Sales = SUM(Sales[sales_amount])
```
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ë–∞–∑–æ–≤–∞—è –º–µ—Ä–∞ –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –æ–±—â–µ–π —Å—É–º–º—ã –ø—Ä–æ–¥–∞–∂  
**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** –û—Å–Ω–æ–≤–∞ –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –¥—Ä—É–≥–∏—Ö —Ä–∞—Å—á–µ—Ç–æ–≤

#### üõí –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤
```dax
Total_Orders = DISTINCTCOUNT(Sales[order_id])
```
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–¥—Å—á–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤ (–Ω–µ —Å—Ç—Ä–æ–∫ –≤ —Ç–∞–±–ª–∏—Ü–µ)  
**–í–∞–∂–Ω–æ:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è DISTINCTCOUNT –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –ø–æ–¥—Å—á–µ—Ç–∞

#### üë• –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤
```dax
Unique_Customers = DISTINCTCOUNT(Sales[customer_id])
```
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–¥—Å—á–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ –≤ –≤—ã–±—Ä–∞–Ω–Ω–æ–º –ø–µ—Ä–∏–æ–¥–µ  
**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:** –ê–Ω–∞–ª–∏–∑ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π –±–∞–∑—ã, —Ä–∞—Å—á–µ—Ç –∫–æ–Ω–≤–µ—Ä—Å–∏–π

#### üí≥ –°—Ä–µ–¥–Ω–∏–π —á–µ–∫
```dax
Average_Check = 
DIVIDE(
    [Total_Sales],
    [Total_Orders],
    0
)
```
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°—Ä–µ–¥–Ω—è—è —Å—É–º–º–∞ –æ–¥–Ω–æ–≥–æ –∑–∞–∫–∞–∑–∞  
**–§—É–Ω–∫—Ü–∏—è DIVIDE:** –ó–∞—â–∏—Ç–∞ –æ—Ç –¥–µ–ª–µ–Ω–∏—è –Ω–∞ –Ω–æ–ª—å (–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 0)  
**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:** –ê–Ω–∞–ª–∏–∑ –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è

---

### üéØ –†–∞—Å—á–µ—Ç—ã —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º (CALCULATE)

#### üìä –ü—Ä–æ–¥–∞–∂–∏ —Ç–µ–∫—É—â–µ–≥–æ –≥–æ–¥–∞
```dax
Sales_Current_Year = 
CALCULATE(
    [Total_Sales],
    YEAR(Sales[order_date]) = YEAR(TODAY())
)
```
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø—Ä–æ–¥–∞–∂ —Ç–æ–ª—å–∫–æ –∑–∞ —Ç–µ–∫—É—â–∏–π –≥–æ–¥  
**–î–∏–Ω–∞–º–∏—á–Ω–æ—Å—Ç—å:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ —Å–º–µ–Ω–µ –≥–æ–¥–∞

#### üè¢ –ü—Ä–æ–¥–∞–∂–∏ B2B —Å–µ–≥–º–µ–Ω—Ç–∞
```dax
Sales_B2B = 
CALCULATE(
    [Total_Sales],
    Customers[customer_type] = "B2B"
)
```
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–æ–¥–∞–∂–∏ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–º –∫–ª–∏–µ–Ω—Ç–∞–º  
**–°–≤—è–∑—å:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–≤—è–∑—å –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏ Sales –∏ Customers

#### üì± –ü—Ä–æ–¥–∞–∂–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞"
```dax
Sales_Electronics = 
CALCULATE(
    [Total_Sales],
    Products[category_level_1] = "–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞"
)
```
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–æ–¥–∞–∂–∏ –ø–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤  
**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:** –ê–Ω–∞–ª–∏–∑ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π

#### üåü –ü—Ä–æ–¥–∞–∂–∏ –ø—Ä–µ–º–∏—É–º –±—Ä–µ–Ω–¥–æ–≤
```dax
Sales_Premium_Brands = 
CALCULATE(
    [Total_Sales],
    Products[brand_tier] = "Premium"
)
```
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–æ–¥–∞–∂–∏ —Ç–æ–≤–∞—Ä–æ–≤ –ø—Ä–µ–º–∏—É–º —Å–µ–≥–º–µ–Ω—Ç–∞  
**–ë–∏–∑–Ω–µ—Å-—Ü–µ–Ω–Ω–æ—Å—Ç—å:** –ê–Ω–∞–ª–∏–∑ –º–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –ø–æ —Å–µ–≥–º–µ–Ω—Ç–∞–º

---

## ‚è∞ –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è

### üìÖ **–ö–∞–ª–µ–Ω–¥–∞—Ä–Ω—ã–µ —Ä–∞—Å—á–µ—Ç—ã**

#### üìä –ü—Ä–æ–¥–∞–∂–∏ —Å –Ω–∞—á–∞–ª–∞ –≥–æ–¥–∞ (YTD)
```dax
Sales_YTD = 
TOTALYTD(
    [Total_Sales],
    'Calendar'[Date]
)
```
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ù–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω–∞—è —Å—É–º–º–∞ —Å 1 —è–Ω–≤–∞—Ä—è  
**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:** –ù–µ–æ–±—Ö–æ–¥–∏–º–∞ —Å–≤—è–∑–∞–Ω–Ω–∞—è –∫–∞–ª–µ–Ω–¥–∞—Ä–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞  
**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:** –û—Ç—á–µ—Ç—ã —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤—É, –ø–ª–∞–Ω-—Ñ–∞–∫—Ç –∞–Ω–∞–ª–∏–∑

#### üìä –ü—Ä–æ–¥–∞–∂–∏ —Å –Ω–∞—á–∞–ª–∞ –º–µ—Å—è—Ü–∞ (MTD)
```dax
Sales_MTD = 
TOTALMTD(
    [Total_Sales],
    'Calendar'[Date]
)
```
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ù–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω–∞—è —Å—É–º–º–∞ —Å –Ω–∞—á–∞–ª–∞ —Ç–µ–∫—É—â–µ–≥–æ –º–µ—Å—è—Ü–∞  
**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:** –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–ª–∞–Ω–æ–≤

#### üìä –ü—Ä–æ–¥–∞–∂–∏ —Å –Ω–∞—á–∞–ª–∞ –∫–≤–∞—Ä—Ç–∞–ª–∞ (QTD)
```dax
Sales_QTD = 
TOTALQTD(
    [Total_Sales],
    'Calendar'[Date]
)
```
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ù–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω–∞—è —Å—É–º–º–∞ —Å –Ω–∞—á–∞–ª–∞ –∫–≤–∞—Ä—Ç–∞–ª–∞  
**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:** –ö–≤–∞—Ä—Ç–∞–ª—å–Ω–æ–µ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å

---

### üîÑ **–°—Ä–∞–≤–Ω–µ–Ω–∏—è –ø–µ—Ä–∏–æ–¥–æ–≤**

#### üìà –ü—Ä–æ–¥–∞–∂–∏ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –º–µ—Å—è—Ü–∞
```dax
Sales_Previous_Month = 
CALCULATE(
    [Total_Sales],
    DATEADD('Calendar'[Date], -1, MONTH)
)
```
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–æ–¥–∞–∂–∏ –∑–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–π –º–µ—Å—è—Ü –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è  
**–ö–æ–Ω—Ç–µ–∫—Å—Ç:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø—Ä–µ–¥—ã–¥—É—â–∏–π –ø–µ—Ä–∏–æ–¥

#### üìà –ü—Ä–æ–¥–∞–∂–∏ –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞ –ø—Ä–æ—à–ª–æ–≥–æ –≥–æ–¥–∞
```dax
Sales_Same_Period_Last_Year = 
CALCULATE(
    [Total_Sales],
    SAMEPERIODLASTYEAR('Calendar'[Date])
)
```
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–º –ø–µ—Ä–∏–æ–¥–æ–º –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –≥–æ–¥–∞  
**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:** –ê–Ω–∞–ª–∏–∑ —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç–∏ –∏ –≥–æ–¥–æ–≤—ã—Ö —Ç—Ä–µ–Ω–¥–æ–≤

#### üìä –†–æ—Å—Ç –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–º—É –º–µ—Å—è—Ü—É (–≤ —Ä—É–±–ª—è—Ö)
```dax
Sales_Growth_Amount = 
[Total_Sales] - [Sales_Previous_Month]
```
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ê–±—Å–æ–ª—é—Ç–Ω—ã–π –ø—Ä–∏—Ä–æ—Å—Ç –ø—Ä–æ–¥–∞–∂  
**–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:** –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ = —Ä–æ—Å—Ç, –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ = —Å–Ω–∏–∂–µ–Ω–∏–µ

#### üìä –†–æ—Å—Ç –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–º—É –º–µ—Å—è—Ü—É (–≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö)
```dax
Sales_Growth_Percent = 
DIVIDE(
    [Sales_Growth_Amount],
    [Sales_Previous_Month],
    0
) * 100
```
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –¢–µ–º–ø —Ä–æ—Å—Ç–∞ –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö  
**–ó–∞—â–∏—Ç–∞:** DIVIDE –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –Ω–æ–ª—å  
**–§–æ—Ä–º–∞—Ç:** –£–º–Ω–æ–∂–µ–Ω–∏–µ –Ω–∞ 100 –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö

#### üìä –ò–Ω–¥–µ–∫—Å —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç–∏
```dax
Seasonal_Index = 
VAR CurrentMonthSales = [Total_Sales]
VAR AverageMonthSales = 
    CALCULATE(
        AVERAGEX(VALUES('Calendar'[MonthNumber]), [Total_Sales]),
        ALL('Calendar'[Date])
    )
RETURN
DIVIDE(CurrentMonthSales, AverageMonthSales, 1)
```
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç–∏ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –º–µ—Å—è—Ü–∞  
**–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:** >1 = –≤—ã—à–µ —Å—Ä–µ–¥–Ω–µ–≥–æ, <1 = –Ω–∏–∂–µ —Å—Ä–µ–¥–Ω–µ–≥–æ  
**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:** –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## üìä –°–∫–æ–ª—å–∑—è—â–∏–µ —Å—Ä–µ–¥–Ω–∏–µ –∏ —Ç—Ä–µ–Ω–¥—ã

### üìà **–°–∫–æ–ª—å–∑—è—â–∏–µ —Å—Ä–µ–¥–Ω–∏–µ**

#### üìä 3-–º–µ—Å—è—á–Ω–æ–µ —Å–∫–æ–ª—å–∑—è—â–µ–µ —Å—Ä–µ–¥–Ω–µ–µ
```dax
Sales_3M_Moving_Average = 
VAR CurrentDate = MAX('Calendar'[Date])
VAR ThreeMonthsBack = EOMONTH(CurrentDate, -3) + 1
RETURN
CALCULATE(
    AVERAGEX(
        FILTER(
            'Calendar',
            'Calendar'[Date] >= ThreeMonthsBack &&
            'Calendar'[Date] <= CurrentDate
        ),
        [Total_Sales]
    )
)
```
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ –∫–æ–ª–µ–±–∞–Ω–∏–π –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è —Ç—Ä–µ–Ω–¥–∞  
**–õ–æ–≥–∏–∫–∞:** –°—Ä–µ–¥–Ω—è—è –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 –º–µ—Å—è—Ü–∞ –≤–∫–ª—é—á–∞—è —Ç–µ–∫—É—â–∏–π  
**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:** –ê–Ω–∞–ª–∏–∑ —Ç—Ä–µ–Ω–¥–æ–≤, —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ —Å–µ–∑–æ–Ω–Ω—ã—Ö –∫–æ–ª–µ–±–∞–Ω–∏–π

#### üìä 12-–º–µ—Å—è—á–Ω–æ–µ —Å–∫–æ–ª—å–∑—è—â–µ–µ —Å—Ä–µ–¥–Ω–µ–µ
```dax
Sales_12M_Moving_Average = 
VAR CurrentDate = MAX('Calendar'[Date])
VAR TwelveMonthsBack = EOMONTH(CurrentDate, -12) + 1
RETURN
CALCULATE(
    AVERAGEX(
        FILTER(
            'Calendar',
            'Calendar'[Date] >= TwelveMonthsBack &&
            'Calendar'[Date] <= CurrentDate
        ),
        [Total_Sales]
    )
)
```
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ì–æ–¥–æ–≤–æ–π —Ç—Ä–µ–Ω–¥ –±–µ–∑ –≤–ª–∏—è–Ω–∏—è —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç–∏  
**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:** –°—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–æ–µ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ, –∞–Ω–∞–ª–∏–∑ –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã—Ö —Ç—Ä–µ–Ω–¥–æ–≤

---

## üèÜ –†–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Ä–µ–π—Ç–∏–Ω–≥–∏

### üìä **–†–µ–π—Ç–∏–Ω–≥–∏ –∏ –¢–û–ü-—Å–ø–∏—Å–∫–∏**

#### ü•á –†–µ–π—Ç–∏–Ω–≥ —Ä–µ–≥–∏–æ–Ω–∞ –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º
```dax
Region_Sales_Rank = 
RANKX(
    ALL(Regions[region_name]),
    [Total_Sales],
    ,
    DESC
)
```
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–∑–∏—Ü–∏—è —Ä–µ–≥–∏–æ–Ω–∞ –≤ —Ä–µ–π—Ç–∏–Ω–≥–µ –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º  
**–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞:** DESC = –æ—Ç –±–æ–ª—å—à–µ–≥–æ –∫ –º–µ–Ω—å—à–µ–º—É (1 = –ª—É—á—à–∏–π)  
**ALL:** –ò–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç —Ç–µ–∫—É—â–∏–µ —Ñ–∏–ª—å—Ç—Ä—ã –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è

#### üèÜ –†–µ–π—Ç–∏–Ω–≥ —Ç–æ–≤–∞—Ä–∞ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
```dax
Product_Rank_In_Category = 
RANKX(
    FILTER(
        ALL(Products[product_name]),
        Products[category_level_1] = MAX(Products[category_level_1])
    ),
    [Total_Sales],
    ,
    DESC
)
```
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–∑–∏—Ü–∏—è —Ç–æ–≤–∞—Ä–∞ —Å—Ä–µ–¥–∏ —Ç–æ–≤–∞—Ä–æ–≤ —Ç–æ–π –∂–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏  
**–õ–æ–≥–∏–∫–∞:** –†–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏  
**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:** –ê–Ω–∞–ª–∏–∑ –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç–∞, ABC-–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è

#### üîù –¢–û–ü-5 –∫–ª–∏–µ–Ω—Ç–æ–≤ –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º
```dax
Top5_Customers_Sales = 
SUMX(
    TOPN(
        5,
        VALUES(Customers[customer_name]),
        [Total_Sales],
        DESC
    ),
    [Total_Sales]
)
```
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°—É–º–º–∞ –ø—Ä–æ–¥–∞–∂ –¢–û–ü-5 –∫–ª–∏–µ–Ω—Ç–æ–≤  
**TOPN:** –í—ã–±–∏—Ä–∞–µ—Ç 5 –ª—É—á—à–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤  
**SUMX:** –°—É–º–º–∏—Ä—É–µ—Ç –∏—Ö –ø—Ä–æ–¥–∞–∂–∏  
**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:** –ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑, –ø—Ä–∞–≤–∏–ª–æ 80/20

---

## üí∞ –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —Ä–∞—Å—á–µ—Ç—ã

### üìä **–ü—Ä–∏–±—ã–ª—å–Ω–æ—Å—Ç—å –∏ –º–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å**

#### üíµ –í–∞–ª–æ–≤–∞—è –ø—Ä–∏–±—ã–ª—å
```dax
Gross_Profit = 
SUMX(
    Sales,
    Sales[quantity] * (Sales[unit_price] - Sales[cost_price])
)
```
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–∏–±—ã–ª—å –¥–æ –≤—ã—á–µ—Ç–∞ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤  
**SUMX:** –ü–æ—Å—Ç—Ä–æ—á–Ω—ã–π —Ä–∞—Å—á–µ—Ç –¥–ª—è —Ç–æ—á–Ω–æ—Å—Ç–∏  
**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:** –ê–Ω–∞–ª–∏–∑ —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–æ–¥—É–∫—Ç–æ–≤

#### üìä –í–∞–ª–æ–≤–∞—è –º–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å
```dax
Gross_Margin_Percent = 
DIVIDE(
    [Gross_Profit],
    [Total_Sales],
    0
) * 100
```
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –í–∞–ª–æ–≤–∞—è –º–∞—Ä–∂–∞ –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö  
**–§–æ—Ä–º—É–ª–∞:** (–ü—Ä–æ–¥–∞–∂–∏ - –°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å) / –ü—Ä–æ–¥–∞–∂–∏ * 100  
**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:** –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–∏–±—ã–ª—å–Ω–æ—Å—Ç–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π/–ø—Ä–æ–¥—É–∫—Ç–æ–≤

#### üí∞ –°—Ä–µ–¥–Ω—è—è –º–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å –∫–ª–∏–µ–Ω—Ç–∞
```dax
Average_Customer_Margin = 
AVERAGEX(
    VALUES(Customers[customer_id]),
    DIVIDE([Gross_Profit], [Total_Sales], 0)
)
```
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°—Ä–µ–¥–Ω—è—è –º–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å –ø–æ –∫–ª–∏–µ–Ω—Ç–∞–º  
**AVERAGEX:** –†–∞—Å—á–µ—Ç –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞ –æ—Ç–¥–µ–ª—å–Ω–æ  
**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:** –°–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤ –ø–æ –ø—Ä–∏–±—ã–ª—å–Ω–æ—Å—Ç–∏

#### üéØ –ú–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å –≤—ã—à–µ —Å—Ä–µ–¥–Ω–µ–≥–æ
```dax
Above_Average_Margin = 
VAR AverageMargin = [Gross_Margin_Percent]
VAR CurrentMargin = [Gross_Margin_Percent]
RETURN
IF(CurrentMargin > AverageMargin, CurrentMargin, BLANK())
```
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –º–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –æ–Ω–∞ –≤—ã—à–µ —Å—Ä–µ–¥–Ω–µ–π  
**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:** –í—ã–¥–µ–ª–µ–Ω–∏–µ –≤—ã—Å–æ–∫–æ–º–∞—Ä–∂–∏–Ω–∞–ª—å–Ω—ã—Ö —Å–µ–≥–º–µ–Ω—Ç–æ–≤

---

## üë• –ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞

### üìä **RFM-–∞–Ω–∞–ª–∏–∑**

#### ‚è∞ –î–∞–≤–Ω–æ—Å—Ç—å –ø–æ—Å–ª–µ–¥–Ω–µ–π –ø–æ–∫—É–ø–∫–∏ (Recency)
```dax
Customer_Last_Purchase_Days = 
VAR LastPurchase = 
    CALCULATE(
        MAX(Sales[order_date]),
        ALLEXCEPT(Sales, Sales[customer_id])
    )
RETURN
DATEDIFF(LastPurchase, TODAY(), DAY)
```
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π –ø–æ–∫—É–ø–∫–∏ –∫–ª–∏–µ–Ω—Ç–∞  
**ALLEXCEPT:** –£–±–∏—Ä–∞–µ—Ç –≤—Å–µ —Ñ–∏–ª—å—Ç—Ä—ã –∫—Ä–æ–º–µ –∫–ª–∏–µ–Ω—Ç–∞  
**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:** –í—ã—è–≤–ª–µ–Ω–∏–µ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤

#### üõí –ß–∞—Å—Ç–æ—Ç–∞ –ø–æ–∫—É–ø–æ–∫ (Frequency)
```dax
Customer_Purchase_Frequency = 
CALCULATE(
    DISTINCTCOUNT(Sales[order_id]),
    ALLEXCEPT(Sales, Sales[customer_id])
)
```
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –∫–ª–∏–µ–Ω—Ç–∞ –∑–∞ –≤–µ—Å—å –ø–µ—Ä–∏–æ–¥  
**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:** –°–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏

#### üí∞ –û–±—â–∞—è —Å—É–º–º–∞ –ø–æ–∫—É–ø–æ–∫ –∫–ª–∏–µ–Ω—Ç–∞ (Monetary)
```dax
Customer_Total_Sales = 
CALCULATE(
    [Total_Sales],
    ALLEXCEPT(Sales, Sales[customer_id])
)
```
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–±—â–∏–π –æ–±—ä–µ–º –ø–æ–∫—É–ø–æ–∫ –∫–ª–∏–µ–Ω—Ç–∞  
**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:** –í—ã—è–≤–ª–µ–Ω–∏–µ VIP-–∫–ª–∏–µ–Ω—Ç–æ–≤

#### üéØ RFM-—Å–µ–≥–º–µ–Ω—Ç –∫–ª–∏–µ–Ω—Ç–∞
```dax
Customer_RFM_Segment = 
VAR RecencyScore = 
    IF([Customer_Last_Purchase_Days] <= 30, 3,
    IF([Customer_Last_Purchase_Days] <= 90, 2, 1))
VAR FrequencyScore = 
    IF([Customer_Purchase_Frequency] >= 10, 3,
    IF([Customer_Purchase_Frequency] >= 3, 2, 1))
VAR MonetaryScore = 
    IF([Customer_Total_Sales] >= 100000, 3,
    IF([Customer_Total_Sales] >= 30000, 2, 1))
VAR RFMScore = RecencyScore & FrequencyScore & MonetaryScore
RETURN
SWITCH(RFMScore,
    "333", "VIP –ö–ª–∏–µ–Ω—Ç—ã",
    "332", "–õ–æ—è–ª—å–Ω—ã–µ",
    "331", "–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª —Ä–æ—Å—Ç–∞",
    "322", "–ù—É–∂–¥–∞—é—Ç—Å—è –≤ –≤–Ω–∏–º–∞–Ω–∏–∏",
    "321", "–ù–æ–≤—ã–µ –∫–ª–∏–µ–Ω—Ç—ã",
    "233", "–†–∏—Å–∫—É—é—Ç —É–π—Ç–∏",
    "223", "–ù–µ –º–æ–≥—É—Ç –ø–æ—Ç–µ—Ä—è—Ç—å",
    "111", "–ü–æ—Ç–µ—Ä—è–Ω–Ω—ã–µ",
    "–ü—Ä–æ—á–∏–µ"
)
```
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤ –ø–æ RFM-–º–æ–¥–µ–ª–∏  
**–õ–æ–≥–∏–∫–∞:** –ö–æ–º–±–∏–Ω–∞—Ü–∏—è –æ—Ü–µ–Ω–æ–∫ –ø–æ –¥–∞–≤–Ω–æ—Å—Ç–∏, —á–∞—Å—Ç–æ—Ç–µ –∏ —Å—É–º–º–µ  
**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:** –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–∞, —É–¥–µ—Ä–∂–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–æ–≤

---

## üéØ –ö–æ–Ω–≤–µ—Ä—Å–∏–∏ –∏ –≤–æ—Ä–æ–Ω–∫–∏ –ø—Ä–æ–¥–∞–∂

### üìä **–ê–Ω–∞–ª–∏–∑ –≤–æ—Ä–æ–Ω–∫–∏**

#### üéØ –ö–æ–Ω–≤–µ—Ä—Å–∏—è –∏–∑ –ª–∏–¥–æ–≤ –≤ –∫–ª–∏–µ–Ω—Ç–æ–≤
```dax
Lead_to_Customer_Conversion = 
VAR TotalLeads = DISTINCTCOUNT(Leads[lead_id])
VAR ConvertedLeads = 
    CALCULATE(
        DISTINCTCOUNT(Leads[lead_id]),
        Leads[status] = "Converted"
    )
RETURN
DIVIDE(ConvertedLeads, TotalLeads, 0) * 100
```
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–æ—Ü–µ–Ω—Ç –ª–∏–¥–æ–≤, —Å—Ç–∞–≤—à–∏—Ö –∫–ª–∏–µ–Ω—Ç–∞–º–∏  
**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:** –û—Ü–µ–Ω–∫–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø—Ä–æ–¥–∞–∂

#### üí∞ –°—Ä–µ–¥–Ω–∏–π —á–µ–∫ –Ω–æ–≤—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤
```dax
New_Customer_Average_Check = 
VAR NewCustomers = 
    FILTER(
        Customers,
        Customers[registration_date] >= DATE(YEAR(TODAY()), 1, 1)
    )
RETURN
AVERAGEX(
    NewCustomers,
    CALCULATE([Total_Sales])
)
```
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°—Ä–µ–¥–Ω–∏–π —á–µ–∫ –∫–ª–∏–µ–Ω—Ç–æ–≤, –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –≤ —Ç–µ–∫—É—â–µ–º –≥–æ–¥—É  
**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:** –ê–Ω–∞–ª–∏–∑ –∫–∞—á–µ—Å—Ç–≤–∞ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤

---

## üìà –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

### üìä **–ü—Ä–æ—Å—Ç–æ–µ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ**

#### üìà –õ–∏–Ω–µ–π–Ω—ã–π —Ç—Ä–µ–Ω–¥ –ø—Ä–æ–¥–∞–∂
```dax
Sales_Linear_Trend = 
VAR SalesTable = 
    SUMMARIZE(
        'Calendar',
        'Calendar'[MonthYear],
        "Sales", [Total_Sales]
    )
VAR XValues = RANKX(SalesTable, 'Calendar'[MonthYear], , ASC)
VAR YValues = [Total_Sales]
VAR Count = COUNTROWS(SalesTable)
VAR SumX = SUMX(SalesTable, XValues)
VAR SumY = SUMX(SalesTable, YValues)
VAR SumXY = SUMX(SalesTable, XValues * YValues)
VAR SumX2 = SUMX(SalesTable, XValues * XValues)
VAR Slope = DIVIDE((Count * SumXY - SumX * SumY), (Count * SumX2 - SumX * SumX), 0)
VAR Intercept = DIVIDE((SumY - Slope * SumX), Count, 0)
RETURN
Slope * XValues + Intercept
```
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –†–∞—Å—á–µ—Ç –ª–∏–Ω–µ–π–Ω–æ–≥–æ —Ç—Ä–µ–Ω–¥–∞ –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è  
**–ú–µ—Ç–æ–¥:** –ú–µ—Ç–æ–¥ –Ω–∞–∏–º–µ–Ω—å—à–∏—Ö –∫–≤–∞–¥—Ä–∞—Ç–æ–≤  
**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:** –ü—Ä–æ—Å—Ç–æ–µ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö

#### üéØ –ü–ª–∞–Ω –≤—ã–ø–æ–ª–Ω–µ–Ω (–î–∞/–ù–µ—Ç)
```dax
Plan_Achieved = 
IF([Total_Sales] >= [Sales_Plan], "‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω", "‚ùå –ù–µ –≤—ã–ø–æ–ª–Ω–µ–Ω")
```
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–ª–∞–Ω–∞  
**–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —ç–º–æ–¥–∑–∏ –¥–ª—è –Ω–∞–≥–ª—è–¥–Ω–æ—Å—Ç–∏  
**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:** –î–∞—à–±–æ—Ä–¥—ã –¥–ª—è —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞

---

## üõ† –°–ª—É–∂–µ–±–Ω—ã–µ –∏ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ–æ—Ä–º—É–ª—ã

### üìä **–ü—Ä–æ–≤–µ—Ä–∫–∏ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è**

#### ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö
```dax
Data_Quality_Check = 
VAR EmptyValues = 
    CALCULATE(
        COUNTROWS(Sales),
        OR(
            ISBLANK(Sales[customer_id]),
            OR(
                ISBLANK(Sales[product_id]),
                ISBLANK(Sales[sales_amount])
            )
        )
    )
VAR TotalRows = COUNTROWS(Sales)
RETURN
IF(EmptyValues > 0, 
    "‚ö†Ô∏è –ù–∞–π–¥–µ–Ω—ã –ø—Ä–æ–ø—É—Å–∫–∏: " & EmptyValues & " –∏–∑ " & TotalRows,
    "‚úÖ –î–∞–Ω–Ω—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã"
)
```
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –ø—Ä–æ–ø—É—Å–∫–æ–≤ –≤ –∫–ª—é—á–µ–≤—ã—Ö –ø–æ–ª—è—Ö  
**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:** –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö

#### üîç –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ
```dax
Row_Count = COUNTROWS(Sales)
```
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–¥—Å—á–µ—Ç —Å—Ç—Ä–æ–∫ —Å —É—á–µ—Ç–æ–º —Ç–µ–∫—É—â–∏—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤  
**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:** –û—Ç–ª–∞–¥–∫–∞ DAX-—Ñ–æ—Ä–º—É–ª, –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

#### üìÖ –¢–µ–∫—É—â–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–∞—Ç—ã
```dax
Current_Date_Context = 
IF(
    HASONEVALUE('Calendar'[Date]),
    VALUES('Calendar'[Date]),
    "–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –¥–∞—Ç—ã"
)
```
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–µ–∫—É—â—É—é –¥–∞—Ç—É –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ  
**HASONEVALUE:** –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –≤—ã–±—Ä–∞–Ω–∞ –æ–¥–Ω–∞ –¥–∞—Ç–∞  
**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:** –û—Ç–ª–∞–¥–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä–∞—Å—á–µ—Ç–æ–≤

---

## üí° –°–æ–≤–µ—Ç—ã –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é DAX

### ‚úÖ **–õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏:**

#### üéØ **1. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (VAR) –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö —Ä–∞—Å—á–µ—Ç–æ–≤:**
```dax
// ‚úÖ –•–æ—Ä–æ—à–æ - —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏
Customer_Analysis = 
VAR CustomerSales = [Total_Sales]
VAR CustomerOrders = [Total_Orders]
VAR AverageCheck = DIVIDE(CustomerSales, CustomerOrders, 0)
RETURN
IF(AverageCheck > 50000, "VIP", "–û–±—ã—á–Ω—ã–π")

// ‚ùå –ü–ª–æ—Ö–æ - –±–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
Customer_Analysis_Bad = 
IF(DIVIDE([Total_Sales], [Total_Orders], 0) > 50000, "VIP", "–û–±—ã—á–Ω—ã–π")
```

#### üöÄ **2. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:**
```dax
// ‚úÖ –ë—ã—Å—Ç—Ä–æ - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∏–Ω–¥–µ–∫—Å
Fast_Calculation = 
CALCULATE(
    [Total_Sales],
    Products[category_level_1] = "–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞"
)

// ‚ùå –ú–µ–¥–ª–µ–Ω–Ω–æ - —Å–∫–∞–Ω–∏—Ä—É–µ—Ç –≤—Å—é —Ç–∞–±–ª–∏—Ü—É
Slow_Calculation = 
CALCULATE(
    [Total_Sales],
    CONTAINS(Products, Products[category_level_1], "–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞")
)
```

#### üîß **3. –ó–∞—â–∏—Ç–∞ –æ—Ç –æ—à–∏–±–æ–∫:**
```dax
// ‚úÖ –° –∑–∞—â–∏—Ç–æ–π –æ—Ç –¥–µ–ª–µ–Ω–∏—è –Ω–∞ –Ω–æ–ª—å
Safe_Division = DIVIDE([Numerator], [Denominator], 0)

// ‚úÖ –° –ø—Ä–æ–≤–µ—Ä–∫–æ–π –Ω–∞ –ø—É—Å—Ç—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
Safe_Calculation = 
IF(
    ISBLANK([Value]),
    0,
    [Value] * 1.2
)
```

### ‚ùå **–ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏:**

#### 1Ô∏è‚É£ **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏:**
```dax
// ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ
Wrong_Customer_Total = SUM(Sales[sales_amount])

// ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ
Correct_Customer_Total = 
CALCULATE(
    SUM(Sales[sales_amount]),
    ALLEXCEPT(Sales, Sales[customer_id])
)
```

#### 2Ô∏è‚É£ **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ SUMX –≤–º–µ—Å—Ç–æ SUM –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏:**
```dax
// ‚ùå –ú–µ–¥–ª–µ–Ω–Ω–æ –±–µ–∑ –ø—Ä–∏—á–∏–Ω—ã
Unnecessary_SUMX = SUMX(Sales, Sales[sales_amount])

// ‚úÖ –ë—ã—Å—Ç—Ä–µ–µ –¥–ª—è –ø—Ä–æ—Å—Ç–æ–π –∞–≥—Ä–µ–≥–∞—Ü–∏–∏
Simple_SUM = SUM(Sales[sales_amount])
```

#### 3Ô∏è‚É£ **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ BLANK():**
```dax
// ‚ùå –ú–æ–∂–µ—Ç –¥–∞—Ç—å –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
Risky_Calculation = [Value1] + [Value2]

// ‚úÖ –° –ø—Ä–æ–≤–µ—Ä–∫–æ–π
Safe_Calculation = 
IF(
    OR(ISBLANK([Value1]), ISBLANK([Value2])),
    BLANK(),
    [Value1] + [Value2]
)
```

---

## üìö –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

### üéØ **–≠—Ç–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ DAX-—Ñ–æ—Ä–º—É–ª –ø–æ–º–æ–∂–µ—Ç –≤–∞–º:**

- **–£—Å–∫–æ—Ä–∏—Ç—å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É** –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –º–æ–¥–µ–ª–µ–π
- **–ò–∑–±–µ–∂–∞—Ç—å —Ç–∏–ø–∏—á–Ω—ã—Ö –æ—à–∏–±–æ–∫** –≤ —Ä–∞—Å—á–µ—Ç–∞—Ö
- **–°–æ–∑–¥–∞–≤–∞—Ç—å –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏** –≤–æ –≤—Å–µ—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö
- **–ò–∑—É—á–∏—Ç—å –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏** —Ä–∞–±–æ—Ç—ã —Å DAX

### üìñ **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏–∑—É—á–µ–Ω–∏—é:**

1. **–ù–∞—á–∏–Ω–∞–π—Ç–µ —Å –±–∞–∑–æ–≤—ã—Ö —Ñ–æ—Ä–º—É–ª** ‚Äî –æ—Å–≤–æ–π—Ç–µ SUM, CALCULATE, DIVIDE
2. **–ò–∑—É—á–∞–π—Ç–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è** ‚Äî –ø–æ–Ω–∏–º–∞–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è DAX
3. **–ü—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ—Å—å –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö** ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–∞–π–ª—ã –∏–∑ —É—á–µ–±–Ω—ã—Ö –∑–∞–¥–∞–Ω–∏–π
4. **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ —Å–≤–æ–∏ —Ñ–æ—Ä–º—É–ª—ã** ‚Äî –¥–æ–±–∞–≤–ª—è–π—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ

**–ü–æ–º–Ω–∏—Ç–µ: —Ö–æ—Ä–æ—à–∞—è DAX-—Ñ–æ—Ä–º—É–ª–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –Ω–µ —Ç–æ–ª—å–∫–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π, –Ω–æ –∏ –ø–æ–Ω—è—Ç–Ω–æ–π –¥–ª—è –∫–æ–ª–ª–µ–≥!**

---

üìñ [–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –æ–ø–∏—Å–∞–Ω–∏—é —Ñ–∞–π–ª–æ–≤](README.md) | üìù [–ü–µ—Ä–µ–π—Ç–∏ –∫ –ø—Ä–∞–∫—Ç–∏–∫–µ](../practice.md) | üöÄ [Git-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](git_project_structure.md)

---

üì¢ –ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Ç–µ—Å—å –∫ —á–∞—Ç—É –∫—É—Ä—Å–∞: [@analytics_course_chat](https://t.me/analytics_course_chat)
üì¢ –ö–∞–Ω–∞–ª –∫—É—Ä—Å–∞: [@analytics_course_channel](https://t.me/analytics_course_channel)