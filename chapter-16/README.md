# üéØ –ì–ª–∞–≤–∞ 16: –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –∏ —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è ‚Äî –Ω–∞—Ö–æ–¥–∏–º —Å–∫—Ä—ã—Ç—ã–µ –≥—Ä—É–ø–ø—ã –≤ –¥–∞–Ω–Ω—ã—Ö!

## üéØ –ß—Ç–æ –≤—ã –∏–∑—É—á–∏—Ç–µ

–ü–æ—Å–ª–µ –∏–∑—É—á–µ–Ω–∏—è —ç—Ç–æ–π –≥–ª–∞–≤—ã –≤—ã —Å–º–æ–∂–µ—Ç–µ:

- üîç **–ù–∞—Ö–æ–¥–∏—Ç—å —Å–∫—Ä—ã—Ç—ã–µ –≥—Ä—É–ø–ø—ã** –≤ –¥–∞–Ω–Ω—ã—Ö –±–µ–∑ –∑–∞—Ä–∞–Ω–µ–µ –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –º–µ—Ç–æ–∫
- üéØ **–°–µ–≥–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–ª–∏–µ–Ω—Ç–æ–≤** –¥–ª—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–∞
- ü§ñ **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º—ã k-means –∏ –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫—É—é –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—é** –≤ scikit-learn
- üìä **–û—Ü–µ–Ω–∏–≤–∞—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ** –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ –∏ –≤—ã–±–∏—Ä–∞—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥—Ä—É–ø–ø
- üíº **–ü—Ä–∏–º–µ–Ω—è—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã** –¥–ª—è –ø—Ä–∏–Ω—è—Ç–∏—è –±–∏–∑–Ω–µ—Å-—Ä–µ—à–µ–Ω–∏–π –∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π

## üåü –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Å—Ç—ã–º–∏ —Å–ª–æ–≤–∞–º–∏

**–ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è** ‚Äî —ç—Ç–æ –∫–∞–∫ —É–º–Ω—ã–π —Å–æ—Ä—Ç–∏—Ä–æ–≤—â–∏–∫, –∫–æ—Ç–æ—Ä—ã–π —Å–º–æ—Ç—Ä–∏—Ç –Ω–∞ –∫—É—á—É —Ä–∞–∑–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å–∫–ª–∞–¥—ã–≤–∞–µ—Ç –∏—Ö –ø–æ –≥—Ä—É–ø–ø–∞–º, –æ—Å–Ω–æ–≤—ã–≤–∞—è—Å—å –Ω–∞ –∏—Ö —Å—Ö–æ–¥—Å—Ç–≤–µ.

### üé≠ **–ú–µ—Ç–∞—Ñ–æ—Ä–∞: –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –∫–∞–∫ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –≤–µ—á–µ—Ä–∏–Ω–∫–∏**

–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ –≤—ã –æ—Ä–≥–∞–Ω–∏–∑—É–µ—Ç–µ –±–æ–ª—å—à—É—é –≤–µ—á–µ—Ä–∏–Ω–∫—É –∏ —Ö–æ—Ç–∏—Ç–µ —Ä–∞—Å—Å–∞–¥–∏—Ç—å –≥–æ—Å—Ç–µ–π –∑–∞ —Å—Ç–æ–ª–∏–∫–∏ —Ç–∞–∫, —á—Ç–æ–±—ã –ª—é–¥—è–º –±—ã–ª–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ –æ–±—â–∞—Ç—å—Å—è:

- üéØ **–ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è** ‚Äî —ç—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ –≥–æ—Å—Ç–µ–π
- üë• **–ö–ª–∞—Å—Ç–µ—Ä—ã** ‚Äî —ç—Ç–æ —Å—Ç–æ–ª–∏–∫–∏ —Å –ø–æ—Ö–æ–∂–∏–º–∏ –ª—é–¥—å–º–∏
- üìè **–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ** ‚Äî —ç—Ç–æ —Å—Ç–µ–ø–µ–Ω—å —Å—Ö–æ–¥—Å—Ç–≤–∞ –º–µ–∂–¥—É –ª—é–¥—å–º–∏
- üé™ **–¶–µ–Ω—Ç—Ä–æ–∏–¥** ‚Äî —ç—Ç–æ "–¥—É—à–∞ –∫–æ–º–ø–∞–Ω–∏–∏" –∑–∞ –∫–∞–∂–¥—ã–º —Å—Ç–æ–ª–∏–∫–æ–º
- üîÑ **–ê–ª–≥–æ—Ä–∏—Ç–º** ‚Äî —ç—Ç–æ –≤–∞—à–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è —Ä–∞—Å—Å–∞–∂–∏–≤–∞–Ω–∏—è

### üíº **–ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ –∞–Ω–∞–ª–∏—Ç–∏–∫—É –≤ 2025:**

**–ë–µ–∑ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏:**
```
"–£ –Ω–∞—Å 50,000 –∫–ª–∏–µ–Ω—Ç–æ–≤. –í—Å–µ–º –æ—Ç–ø—Ä–∞–≤–∏–º –æ–¥–∏–Ω–∞–∫–æ–≤–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ!"
–†–µ–∑—É–ª—å—Ç–∞—Ç: üò¥ 2% –∫–æ–Ω–≤–µ—Ä—Å–∏—è
```

**–° –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–µ–π:**
```python
# –ù–∞—Ö–æ–¥–∏–º 5 –≥—Ä—É–ø–ø –∫–ª–∏–µ–Ω—Ç–æ–≤
clusters = KMeans(n_clusters=5)
customer_segments = clusters.fit_predict(customer_data)
# –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –¥–ª—è –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø—ã
```
–†–µ–∑—É–ª—å—Ç–∞—Ç: üöÄ 15% –∫–æ–Ω–≤–µ—Ä—Å–∏—è

## üß† –û—Å–Ω–æ–≤—ã –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏

### üéØ **–ß—Ç–æ —Ç–∞–∫–æ–µ –Ω–µ–∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º–æ–µ –æ–±—É—á–µ–Ω–∏–µ**

**–ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º–æ–µ –æ–±—É—á–µ–Ω–∏–µ** (–≥–ª–∞–≤—ã 17-18):
- –£ –Ω–∞—Å –µ—Å—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã ("—ç—Ç–æ —Å–ø–∞–º", "—ç—Ç–æ –Ω–µ —Å–ø–∞–º")
- –£—á–∏–º –º–æ–¥–µ–ª—å –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å –∏–∑–≤–µ—Å—Ç–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

**–ù–µ–∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º–æ–µ –æ–±—É—á–µ–Ω–∏–µ** (—ç—Ç–∞ –≥–ª–∞–≤–∞):
- –£ –Ω–∞—Å –ù–ï–¢ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤
- –ò—â–µ–º —Å–∫—Ä—ã—Ç—ã–µ –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏ –∏ –≥—Ä—É–ø–ø—ã
- –î–∞–Ω–Ω—ã–µ —Å–∞–º–∏ "—Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞—é—Ç" —Å–≤–æ—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É

### üìä **–¢–∏–ø—ã –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏**

#### üéØ **–ñ–µ—Å—Ç–∫–∞—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è**
–ö–∞–∂–¥—ã–π –æ–±—ä–µ–∫—Ç –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ–º—É –∫–ª–∞—Å—Ç–µ—Ä—É
```
–ö–ª–∏–µ–Ω—Ç –ò–≤–∞–Ω ‚Üí –ö–ª–∞—Å—Ç–µ—Ä "VIP" (100%)
–ö–ª–∏–µ–Ω—Ç –ú–∞—Ä–∏—è ‚Üí –ö–ª–∞—Å—Ç–µ—Ä "–≠–∫–æ–Ω–æ–º–Ω—ã–µ" (100%)
```

#### üåä **–ú—è–≥–∫–∞—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è**  
–ö–∞–∂–¥—ã–π –æ–±—ä–µ–∫—Ç –º–æ–∂–µ—Ç —á–∞—Å—Ç–∏—á–Ω–æ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç—å —Ä–∞–∑–Ω—ã–º –∫–ª–∞—Å—Ç–µ—Ä–∞–º
```
–ö–ª–∏–µ–Ω—Ç –ü–µ—Ç—Ä ‚Üí 70% "VIP" + 30% "–°—Ä–µ–¥–Ω–∏–π –∫–ª–∞—Å—Å"
```

## üéØ K-means –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è ‚Äî —Å–∞–º—ã–π –ø–æ–ø—É–ª—è—Ä–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º

### üåü **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç k-means**

**–ü—Ä–æ—Å—Ç–∞—è –∞–Ω–∞–ª–æ–≥–∏—è:** –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ –≤—ã –∏—â–µ—Ç–µ –ª—É—á—à–∏–µ –º–µ—Å—Ç–∞ –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –∫–æ—Ñ–µ–µ–Ω –≤ –≥–æ—Ä–æ–¥–µ.

1. **üéØ –í—ã–±–∏—Ä–∞–µ—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ—Ñ–µ–µ–Ω** (–ø–∞—Ä–∞–º–µ—Ç—Ä k)
2. **üìç –°–ª—É—á–∞–π–Ω–æ —Ä–∞–∑–º–µ—â–∞–µ—Ç–µ –∏—Ö** –Ω–∞ –∫–∞—Ä—Ç–µ –≥–æ—Ä–æ–¥–∞  
3. **üë• –ö–∞–∂–¥—ã–π –∂–∏—Ç–µ–ª—å –∏–¥–µ—Ç –≤ –±–ª–∏–∂–∞–π—à—É—é** –∫–æ—Ñ–µ–π–Ω—é
4. **üè† –ö–æ—Ñ–µ–π–Ω–∏ "–ø–µ—Ä–µ–µ–∑–∂–∞—é—Ç"** –≤ —Ü–µ–Ω—Ç—Ä —Å–≤–æ–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤
5. **üîÑ –ü–æ–≤—Ç–æ—Ä—è–µ—Ç–µ** –ø–æ–∫–∞ –∫–æ—Ñ–µ–π–Ω–∏ –Ω–µ –Ω–∞–π–¥—É—Ç –∏–¥–µ–∞–ª—å–Ω—ã–µ –º–µ—Å—Ç–∞

### üîß **K-means –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ**

```python
from sklearn.cluster import KMeans
import pandas as pd
import numpy as np

# –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç–æ–≤
customers = pd.read_csv('customers.csv')

# –í—ã–±–∏—Ä–∞–µ–º –ø—Ä–∏–∑–Ω–∞–∫–∏ –¥–ª—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏
features = ['–≤–æ–∑—Ä–∞—Å—Ç', '–¥–æ—Ö–æ–¥', '—á–∞—Å—Ç–æ—Ç–∞_–ø–æ–∫—É–ø–æ–∫']
X = customers[features]

# –°–æ–∑–¥–∞–µ–º –º–æ–¥–µ–ª—å k-means
kmeans = KMeans(
    n_clusters=4,        # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
    random_state=42,     # –î–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏
    n_init=10           # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–π
)

# –ù–∞—Ö–æ–¥–∏–º –∫–ª–∞—Å—Ç–µ—Ä—ã
cluster_labels = kmeans.fit_predict(X)

# –î–æ–±–∞–≤–ª—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫ –¥–∞–Ω–Ω—ã–º
customers['–∫–ª–∞—Å—Ç–µ—Ä'] = cluster_labels

print("üéâ –ö–ª–∏–µ–Ω—Ç—ã —Ä–∞–∑–¥–µ–ª–µ–Ω—ã –Ω–∞ –≥—Ä—É–ø–ø—ã!")
print(customers['–∫–ª–∞—Å—Ç–µ—Ä'].value_counts())
```

### üéØ **–í—ã–±–æ—Ä –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤**

#### üìà **–ú–µ—Ç–æ–¥ –ª–æ–∫—Ç—è (Elbow Method)**

**–ò–¥–µ—è:** –ò—â–µ–º "–ª–æ–∫–æ—Ç—å" –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–µ ‚Äî —Ç–æ—á–∫—É, –≥–¥–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–ª–∞—Å—Ç–µ—Ä–∞ –Ω–µ —Å–∏–ª—å–Ω–æ —É–ª—É—á—à–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

```python
from sklearn.metrics import silhouette_score

# –¢–µ—Å—Ç–∏—Ä—É–µ–º —Ä–∞–∑–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
inertias = []
silhouette_scores = []
k_range = range(2, 11)

for k in k_range:
    kmeans = KMeans(n_clusters=k, random_state=42)
    cluster_labels = kmeans.fit_predict(X)
    
    # –í–Ω—É—Ç—Ä–∏–∫–ª–∞—Å—Ç–µ—Ä–Ω–∞—è –¥–∏—Å–ø–µ—Ä—Å–∏—è (—á–µ–º –º–µ–Ω—å—à–µ, —Ç–µ–º –ª—É—á—à–µ)
    inertias.append(kmeans.inertia_)
    
    # –°–∏–ª—É—ç—Ç–Ω—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç (—á–µ–º –±–æ–ª—å—à–µ, —Ç–µ–º –ª—É—á—à–µ)
    silhouette_scores.append(silhouette_score(X, cluster_labels))

# –°—Ç—Ä–æ–∏–º –≥—Ä–∞—Ñ–∏–∫ –¥–ª—è –≤—ã–±–æ—Ä–∞ k
plt.figure(figsize=(12, 5))

plt.subplot(1, 2, 1)
plt.plot(k_range, inertias, 'bo-')
plt.title('üìà –ú–µ—Ç–æ–¥ –ª–æ–∫—Ç—è')
plt.xlabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ (k)')
plt.ylabel('–í–Ω—É—Ç—Ä–∏–∫–ª–∞—Å—Ç–µ—Ä–Ω–∞—è –¥–∏—Å–ø–µ—Ä—Å–∏—è')

plt.subplot(1, 2, 2)
plt.plot(k_range, silhouette_scores, 'ro-')
plt.title('üìä –°–∏–ª—É—ç—Ç–Ω—ã–π –∞–Ω–∞–ª–∏–∑')
plt.xlabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ (k)')
plt.ylabel('–°–∏–ª—É—ç—Ç–Ω—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç')

plt.show()
```

#### üéØ **–°–∏–ª—É—ç—Ç–Ω—ã–π –∞–Ω–∞–ª–∏–∑**

**–°–∏–ª—É—ç—Ç–Ω—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç** –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Ö–æ—Ä–æ—à–æ –æ–±—ä–µ–∫—Ç –≤–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ —Å–≤–æ–π –∫–ª–∞—Å—Ç–µ—Ä:
- **+1** ‚Äî –æ–±—ä–µ–∫—Ç –∏–¥–µ–∞–ª—å–Ω–æ –≤–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ —Å–≤–æ–π –∫–ª–∞—Å—Ç–µ—Ä
- **0** ‚Äî –æ–±—ä–µ–∫—Ç –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ –≥—Ä–∞–Ω–∏—Ü–µ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤  
- **-1** ‚Äî –æ–±—ä–µ–∫—Ç –ø–æ–ø–∞–ª –Ω–µ –≤ —Ç–æ—Ç –∫–ª–∞—Å—Ç–µ—Ä

### ‚öñÔ∏è **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ k-means**

#### ‚úÖ **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- üöÄ **–ë—ã—Å—Ç—Ä—ã–π** ‚Äî —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –±–æ–ª—å—à–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- üéØ **–ü—Ä–æ—Å—Ç–æ–π** ‚Äî –ª–µ–≥–∫–æ –ø–æ–Ω—è—Ç—å –∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å
- üìä **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π** ‚Äî —Ö–æ—Ä–æ—à–æ –Ω–∞—Ö–æ–¥–∏—Ç —Å—Ñ–µ—Ä–∏—á–µ—Å–∫–∏–µ –∫–ª–∞—Å—Ç–µ—Ä—ã
- üíº **–ü–æ–ø—É–ª—è—Ä–Ω—ã–π** ‚Äî –º–Ω–æ–≥–æ –≥–æ—Ç–æ–≤—ã—Ö —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π

#### ‚ùå **–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- üéØ **–ù—É–∂–Ω–æ –∑–∞—Ä–∞–Ω–µ–µ –∑–Ω–∞—Ç—å k** ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
- ‚≠ï **–¢–æ–ª—å–∫–æ –∫—Ä—É–≥–ª—ã–µ –∫–ª–∞—Å—Ç–µ—Ä—ã** ‚Äî –ø–ª–æ—Ö–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –≤—ã—Ç—è–Ω—É—Ç—ã–º–∏ –≥—Ä—É–ø–ø–∞–º–∏
- üìè **–ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –∫ –º–∞—Å—à—Ç–∞–±—É** ‚Äî –Ω—É–∂–Ω–∞ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- üé≤ **–°–ª—É—á–∞–π–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è** ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç –º–æ–∂–µ—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è

## üå≥ –ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∞—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è ‚Äî —Å—Ç—Ä–æ–∏–º –¥–µ—Ä–µ–≤–æ –≥—Ä—É–ø–ø

### üåü **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∞—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è**

**–ê–Ω–∞–ª–æ–≥–∏—è:** –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ —Å–µ–º–µ–π–Ω–æ–µ –¥–µ—Ä–µ–≤–æ, –Ω–æ –Ω–∞–æ–±–æ—Ä–æ—Ç ‚Äî –æ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –ª—é–¥–µ–π –∫ –±–æ–ª—å—à–∏–º —Å–µ–º—å—è–º.

#### üîó **–ê–≥–ª–æ–º–µ—Ä–∞—Ç–∏–≤–Ω–∞—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è (—Å–Ω–∏–∑—É –≤–≤–µ—Ä—Ö):**

1. **üë§ –ö–∞–∂–¥—ã–π –æ–±—ä–µ–∫—Ç** ‚Äî –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–ª–∞—Å—Ç–µ—Ä
2. **ü§ù –ù–∞—Ö–æ–¥–∏–º –¥–≤—É—Ö —Å–∞–º—ã—Ö –ø–æ—Ö–æ–∂–∏—Ö** "—Å–æ—Å–µ–¥–µ–π"
3. **üë• –û–±—ä–µ–¥–∏–Ω—è–µ–º –∏—Ö** –≤ –æ–¥–∏–Ω –∫–ª–∞—Å—Ç–µ—Ä  
4. **üîÑ –ü–æ–≤—Ç–æ—Ä—è–µ–º** –ø–æ–∫–∞ –Ω–µ –æ—Å—Ç–∞–Ω–µ—Ç—Å—è –æ–¥–∏–Ω –±–æ–ª—å—à–æ–π –∫–ª–∞—Å—Ç–µ—Ä
5. **‚úÇÔ∏è "–†–∞–∑—Ä–µ–∑–∞–µ–º" –¥–µ—Ä–µ–≤–æ** –Ω–∞ –Ω—É–∂–Ω–æ–º —É—Ä–æ–≤–Ω–µ

```python
from sklearn.cluster import AgglomerativeClustering
from scipy.cluster.hierarchy import dendrogram, linkage
import matplotlib.pyplot as plt

# –°–æ–∑–¥–∞–µ–º –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏–µ –∫–ª–∞—Å—Ç–µ—Ä—ã
hierarchical = AgglomerativeClustering(
    n_clusters=4,           # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–∏–Ω–∞–ª—å–Ω—ã—Ö –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
    linkage='ward'          # –ú–µ—Ç–æ–¥ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è
)

cluster_labels = hierarchical.fit_predict(X)

# –°—Ç—Ä–æ–∏–º –¥–µ–Ω–¥—Ä–æ–≥—Ä–∞–º–º—É (–¥–µ—Ä–µ–≤–æ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤)
linkage_matrix = linkage(X, method='ward')

plt.figure(figsize=(12, 8))
dendrogram(linkage_matrix, 
           truncate_mode='lastp',  # –ü–æ–∫–∞–∑–∞—Ç—å —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–µ p –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
           p=12,                   # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–∏—Å—Ç—å–µ–≤
           leaf_rotation=90,       # –ü–æ–≤–æ—Ä–æ—Ç –ø–æ–¥–ø–∏—Å–µ–π
           leaf_font_size=10)

plt.title('üå≥ –î–µ–Ω–¥—Ä–æ–≥—Ä–∞–º–º–∞ - –¥–µ—Ä–µ–≤–æ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤')
plt.xlabel('–ù–æ–º–µ—Ä –∫–ª–∞—Å—Ç–µ—Ä–∞ –∏–ª–∏ —Ä–∞–∑–º–µ—Ä')
plt.ylabel('–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è')
plt.show()
```

### üîó **–ú–µ—Ç–æ–¥—ã –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è –∫–ª–∞—Å—Ç–µ—Ä–æ–≤**

#### üéØ **Ward (–º–∏–Ω–∏–º—É–º –¥–∏—Å–ø–µ—Ä—Å–∏–∏)**
- –û–±—ä–µ–¥–∏–Ω—è–µ—Ç –∫–ª–∞—Å—Ç–µ—Ä—ã —Ç–∞–∫, —á—Ç–æ–±—ã –º–∏–Ω–∏–º–∞–ª—å–Ω–æ —É–≤–µ–ª–∏—á–∏—Ç—å –≤–Ω—É—Ç—Ä–µ–Ω–Ω—é—é –¥–∏—Å–ø–µ—Ä—Å–∏—é
- **–õ—É—á—à–∏–π –≤—ã–±–æ—Ä** –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –∑–∞–¥–∞—á

#### üìè **Complete (–ø–æ–ª–Ω–∞—è —Å–≤—è–∑—å)**
- –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ = –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
- –°–æ–∑–¥–∞–µ—Ç **–∫–æ–º–ø–∞–∫—Ç–Ω—ã–µ** –∫–ª–∞—Å—Ç–µ—Ä—ã

#### üîó **Average (—Å—Ä–µ–¥–Ω—è—è —Å–≤—è–∑—å)**
- –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ = —Å—Ä–µ–¥–Ω–µ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –≤—Å–µ–º–∏ –ø–∞—Ä–∞–º–∏ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- **–ö–æ–º–ø—Ä–æ–º–∏—Å—Å–Ω—ã–π** –≤–∞—Ä–∏–∞–Ω—Ç

#### ‚ö° **Single (–æ–¥–∏–Ω–æ—á–Ω–∞—è —Å–≤—è–∑—å)**
- –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ = –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –±–ª–∏–∂–∞–π—à–∏–º–∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏
- –°–∫–ª–æ–Ω–µ–Ω –∫ **—Ü–µ–ø–Ω–æ–º—É —ç—Ñ—Ñ–µ–∫—Ç—É**

### ‚öñÔ∏è **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–æ–π –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏**

#### ‚úÖ **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- üå≥ **–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É** –¥–∞–Ω–Ω—ã—Ö –≤ –≤–∏–¥–µ –¥–µ—Ä–µ–≤–∞
- üéØ **–ù–µ –Ω—É–∂–Ω–æ –∑–∞—Ä–∞–Ω–µ–µ –∑–Ω–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ** –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
- üìä **–î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω** ‚Äî –≤—Å–µ–≥–¥–∞ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
- üîç **–ú–æ–∂–Ω–æ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å** –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —É—Ä–æ–≤–Ω—è—Ö –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏

#### ‚ùå **–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- üêå **–ú–µ–¥–ª–µ–Ω–Ω—ã–π** ‚Äî –ø–ª–æ—Ö–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –±–æ–ª—å—à–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏ O(n¬≥)
- üö´ **–ù–µ–ª—å–∑—è –∏—Å–ø—Ä–∞–≤–∏—Ç—å –æ—à–∏–±–∫–∏** ‚Äî –µ—Å–ª–∏ –æ–±—ä–µ–¥–∏–Ω–∏–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ, –Ω–µ —Ä–∞–∑—ä–µ–¥–∏–Ω–∏—à—å
- üíæ **–ú–Ω–æ–≥–æ –ø–∞–º—è—Ç–∏** ‚Äî –Ω—É–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å –º–∞—Ç—Ä–∏—Ü—É —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π
- üéØ **–°–ª–æ–∂–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å** –≤—ã–±–æ—Ä —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤

## üìä –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏

### üë• **–°–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤**

**–¶–µ–ª—å:** –†–∞–∑–¥–µ–ª–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–æ–≤ –Ω–∞ –≥—Ä—É–ø–ø—ã –¥–ª—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–∞.

```python
# –ü—Ä–∏–∑–Ω–∞–∫–∏ –¥–ª—è —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤
customer_features = [
    '–≤–æ–∑—Ä–∞—Å—Ç',
    '–¥–æ—Ö–æ–¥', 
    '—á–∞—Å—Ç–æ—Ç–∞_–ø–æ–∫—É–ø–æ–∫',
    '—Å—Ä–µ–¥–Ω–∏–π_—á–µ–∫',
    '–≤—Ä–µ–º—è_—Å_–ø–æ—Å–ª–µ–¥–Ω–µ–π_–ø–æ–∫—É–ø–∫–∏',
    '–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–∫–∞—Ç–µ–≥–æ—Ä–∏–π'
]

# RFM –∞–Ω–∞–ª–∏–∑ (Recency, Frequency, Monetary)
customers['R'] = (datetime.now() - customers['–ø–æ—Å–ª–µ–¥–Ω—è—è_–ø–æ–∫—É–ø–∫–∞']).dt.days
customers['F'] = customers['–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–æ–∫—É–ø–æ–∫'] 
customers['M'] = customers['–æ–±—â–∞—è_—Å—É–º–º–∞_–ø–æ–∫—É–ø–æ–∫']

# –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö (–≤–∞–∂–Ω–æ –¥–ª—è k-means!)
from sklearn.preprocessing import StandardScaler

scaler = StandardScaler()
X_scaled = scaler.fit_transform(customers[['R', 'F', 'M']])

# –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è
kmeans = KMeans(n_clusters=5, random_state=42)
customers['—Å–µ–≥–º–µ–Ω—Ç'] = kmeans.fit_predict(X_scaled)

# –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Å–µ–≥–º–µ–Ω—Ç–æ–≤
segment_analysis = customers.groupby('—Å–µ–≥–º–µ–Ω—Ç').agg({
    'R': 'mean',
    'F': 'mean', 
    'M': 'mean',
    '–≤–æ–∑—Ä–∞—Å—Ç': 'mean',
    '–¥–æ—Ö–æ–¥': 'mean'
}).round(2)

print("üìä –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ —Å–µ–≥–º–µ–Ω—Ç–æ–≤:")
print(segment_analysis)
```

### üõçÔ∏è **–¢–æ–≤–∞—Ä–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏**

**–¶–µ–ª—å:** –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–≤–∞—Ä—ã –¥–ª—è –ø–µ—Ä–µ–∫—Ä–µ—Å—Ç–Ω—ã—Ö –ø—Ä–æ–¥–∞–∂ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π.

```python
# –ú–∞—Ç—Ä–∏—Ü–∞ "–∫–ª–∏–µ–Ω—Ç-—Ç–æ–≤–∞—Ä" 
customer_product_matrix = purchases.pivot_table(
    index='–∫–ª–∏–µ–Ω—Ç_id', 
    columns='—Ç–æ–≤–∞—Ä', 
    values='–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ', 
    fill_value=0
)

# –ö–ª–∞—Å—Ç–µ—Ä–∏–∑—É–µ–º —Ç–æ–≤–∞—Ä—ã –ø–æ –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–æ–º—É –ø–æ–≤–µ–¥–µ–Ω–∏—é
product_clusters = KMeans(n_clusters=8, random_state=42)
product_segments = product_clusters.fit_predict(customer_product_matrix.T)

# –¢–æ–≤–∞—Ä—ã –≤ –æ–¥–Ω–æ–º –∫–ª–∞—Å—Ç–µ—Ä–µ –ø–æ–∫—É–ø–∞—é—Ç –æ–¥–Ω–∏ –∏ —Ç–µ –∂–µ –∫–ª–∏–µ–Ω—Ç—ã
products_df = pd.DataFrame({
    '—Ç–æ–≤–∞—Ä': customer_product_matrix.columns,
    '–∫–ª–∞—Å—Ç–µ—Ä': product_segments
})

print("üõçÔ∏è –ì—Ä—É–ø–ø—ã —Ç–æ–≤–∞—Ä–æ–≤ –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π:")
for cluster in range(8):
    cluster_products = products_df[products_df['–∫–ª–∞—Å—Ç–µ—Ä'] == cluster]['—Ç–æ–≤–∞—Ä'].tolist()
    print(f"–ö–ª–∞—Å—Ç–µ—Ä {cluster}: {cluster_products[:5]}...")  # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—ã–µ 5
```

### üó∫Ô∏è **–ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è**

**–¶–µ–ª—å:** –ù–∞–π—Ç–∏ —Ä–µ–≥–∏–æ–Ω—ã —Å–æ —Å—Ö–æ–∂–∏–º –ø–æ–≤–µ–¥–µ–Ω–∏–µ–º –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ª–æ–≥–∏—Å—Ç–∏–∫–∏.

```python
# –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º –∏ —Å—á–∏—Ç–∞–µ–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
region_features = sales.groupby('—Ä–µ–≥–∏–æ–Ω').agg({
    '–≤—ã—Ä—É—á–∫–∞': 'mean',
    '–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–∑–∞–∫–∞–∑–æ–≤': 'sum',
    '—Å—Ä–µ–¥–Ω–∏–π_—á–µ–∫': 'mean',
    '—Å–∫–∏–¥–∫–∞': 'mean'
}).reset_index()

# –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è —Ä–µ–≥–∏–æ–Ω–æ–≤
region_clusters = KMeans(n_clusters=3, random_state=42)
region_features['–∫–ª–∞—Å—Ç–µ—Ä'] = region_clusters.fit_predict(
    region_features[['–≤—ã—Ä—É—á–∫–∞', '–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–∑–∞–∫–∞–∑–æ–≤', '—Å—Ä–µ–¥–Ω–∏–π_—á–µ–∫', '—Å–∫–∏–¥–∫–∞']]
)

print("üó∫Ô∏è –†–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–µ –∫–ª–∞—Å—Ç–µ—Ä—ã:")
print(region_features.groupby('–∫–ª–∞—Å—Ç–µ—Ä')['—Ä–µ–≥–∏–æ–Ω'].apply(list))
```

## üìè –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏

### üîß **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è**

**–ü—Ä–æ–±–ª–µ–º–∞:** –†–∞–∑–ª–∏—á–Ω—ã–µ –º–∞—Å—à—Ç–∞–±—ã –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏—Å–∫–∞–∂–∞—é—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è.

```python
from sklearn.preprocessing import StandardScaler, MinMaxScaler

# –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
data = pd.DataFrame({
    '–≤–æ–∑—Ä–∞—Å—Ç': [25, 35, 45, 55],      # –æ—Ç 0 –¥–æ 100
    '–¥–æ—Ö–æ–¥': [30000, 60000, 90000, 120000],  # –æ—Ç 0 –¥–æ 500000
    '–ø–æ–∫—É–ø–∫–∏': [2, 5, 8, 12]          # –æ—Ç 0 –¥–æ 50
})

print("üìä –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:")
print(data)

# –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è (—Å—Ä–µ–¥–Ω–µ–µ=0, —Å—Ç–¥.–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ=1)
scaler = StandardScaler()
data_standardized = scaler.fit_transform(data)

print("\nüìè –ü–æ—Å–ª–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏–∏:")
print(pd.DataFrame(data_standardized, columns=data.columns))

# –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è (–æ—Ç 0 –¥–æ 1)
minmax_scaler = MinMaxScaler()
data_normalized = minmax_scaler.fit_transform(data)

print("\nüéØ –ü–æ—Å–ª–µ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏:")
print(pd.DataFrame(data_normalized, columns=data.columns))
```

### üßπ **–û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö**

```python
from sklearn.preprocessing import LabelEncoder, OneHotEncoder

# –ö–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
customers = pd.DataFrame({
    '–ø–æ–ª': ['–ú', '–ñ', '–ú', '–ñ'],
    '–≥–æ—Ä–æ–¥': ['–ú–æ—Å–∫–≤–∞', '–°–ü–±', '–ú–æ—Å–∫–≤–∞', '–ö–∞–∑–∞–Ω—å'],
    '–¥–æ—Ö–æ–¥': [50000, 60000, 55000, 45000]
})

# –°–ø–æ—Å–æ–± 1: Label Encoding (–¥–ª—è –ø–æ—Ä—è–¥–∫–æ–≤—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö)
le = LabelEncoder()
customers['–ø–æ–ª_encoded'] = le.fit_transform(customers['–ø–æ–ª'])

# –°–ø–æ—Å–æ–± 2: One-Hot Encoding (–¥–ª—è –Ω–æ–º–∏–Ω–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö)
city_encoded = pd.get_dummies(customers['–≥–æ—Ä–æ–¥'], prefix='–≥–æ—Ä–æ–¥')
customers_encoded = pd.concat([customers, city_encoded], axis=1)

print("üîÑ –û–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:")
print(customers_encoded)
```

## üìä –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏

### üéØ **–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –º–µ—Ç—Ä–∏–∫–∏ (–Ω–µ –Ω—É–∂–Ω—ã –∏—Å—Ç–∏–Ω–Ω—ã–µ –º–µ—Ç–∫–∏)**

#### üìè **–°–∏–ª—É—ç—Ç–Ω—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç**
```python
from sklearn.metrics import silhouette_score, silhouette_samples

# –û–±—â–∏–π —Å–∏–ª—É—ç—Ç–Ω—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç
silhouette_avg = silhouette_score(X, cluster_labels)
print(f"–°—Ä–µ–¥–Ω–∏–π —Å–∏–ª—É—ç—Ç–Ω—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç: {silhouette_avg:.3f}")

# –°–∏–ª—É—ç—Ç–Ω—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞
sample_silhouette_values = silhouette_samples(X, cluster_labels)

# –ê–Ω–∞–ª–∏–∑ –ø–æ –∫–ª–∞—Å—Ç–µ—Ä–∞–º
for i in range(n_clusters):
    cluster_silhouettes = sample_silhouette_values[cluster_labels == i]
    print(f"–ö–ª–∞—Å—Ç–µ—Ä {i}: —Å–∏–ª—É—ç—Ç = {cluster_silhouettes.mean():.3f}")
```

#### üéØ **Calinski-Harabasz –∏–Ω–¥–µ–∫—Å**
```python
from sklearn.metrics import calinski_harabasz_score

ch_score = calinski_harabasz_score(X, cluster_labels)
print(f"Calinski-Harabasz –∏–Ω–¥–µ–∫—Å: {ch_score:.2f}")
# –ß–µ–º –±–æ–ª—å—à–µ, —Ç–µ–º –ª—É—á—à–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
```

#### üìä **Davies-Bouldin –∏–Ω–¥–µ–∫—Å**
```python
from sklearn.metrics import davies_bouldin_score

db_score = davies_bouldin_score(X, cluster_labels)
print(f"Davies-Bouldin –∏–Ω–¥–µ–∫—Å: {db_score:.3f}")
# –ß–µ–º –º–µ–Ω—å—à–µ, —Ç–µ–º –ª—É—á—à–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
```

### üé® **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏**

```python
import matplotlib.pyplot as plt
import seaborn as sns

# –î–≤—É–º–µ—Ä–Ω–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è (–µ—Å–ª–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –±–æ–ª—å—à–µ 2, –∏—Å–ø–æ–ª—å–∑—É–µ–º PCA)
from sklearn.decomposition import PCA

if X.shape[1] > 2:
    # –°–∂–∏–º–∞–µ–º –¥–æ 2D –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
    pca = PCA(n_components=2)
    X_pca = pca.fit_transform(X)
    print(f"PCA –æ–±—ä—è—Å–Ω—è–µ—Ç {pca.explained_variance_ratio_.sum():.1%} –¥–∏—Å–ø–µ—Ä—Å–∏–∏")
else:
    X_pca = X

# –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
plt.figure(figsize=(12, 8))

# –†–∞—Å–∫—Ä–∞—à–∏–≤–∞–µ–º —Ç–æ—á–∫–∏ –ø–æ –∫–ª–∞—Å—Ç–µ—Ä–∞–º
colors = plt.cm.Set1(np.linspace(0, 1, len(np.unique(cluster_labels))))

for i, color in enumerate(colors):
    mask = cluster_labels == i
    plt.scatter(X_pca[mask, 0], X_pca[mask, 1], 
               c=[color], label=f'–ö–ª–∞—Å—Ç–µ—Ä {i}', alpha=0.7)

# –î–æ–±–∞–≤–ª—è–µ–º —Ü–µ–Ω—Ç—Ä–æ–∏–¥—ã (–¥–ª—è k-means)
if hasattr(kmeans, 'cluster_centers_'):
    centers_pca = pca.transform(kmeans.cluster_centers_) if X.shape[1] > 2 else kmeans.cluster_centers_
    plt.scatter(centers_pca[:, 0], centers_pca[:, 1],
               c='black', marker='x', s=300, linewidths=3, label='–¶–µ–Ω—Ç—Ä–æ–∏–¥—ã')

plt.title('üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏')
plt.xlabel('–ü–µ—Ä–≤–∞—è –≥–ª–∞–≤–Ω–∞—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞' if X.shape[1] > 2 else '–ü—Ä–∏–∑–Ω–∞–∫ 1')
plt.ylabel('–í—Ç–æ—Ä–∞—è –≥–ª–∞–≤–Ω–∞—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞' if X.shape[1] > 2 else '–ü—Ä–∏–∑–Ω–∞–∫ 2')
plt.legend()
plt.grid(alpha=0.3)
plt.show()
```

## üíº –ë–∏–∑–Ω–µ—Å-–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### üéØ **–ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤**

```python
def profile_clusters(data, cluster_column='–∫–ª–∞—Å—Ç–µ—Ä'):
    """–°–æ–∑–¥–∞–µ—Ç –ø—Ä–æ—Ñ–∏–ª–∏ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ –¥–ª—è –±–∏–∑–Ω–µ—Å-–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏"""
    
    profiles = []
    
    for cluster_id in data[cluster_column].unique():
        cluster_data = data[data[cluster_column] == cluster_id]
        
        profile = {
            '–ö–ª–∞—Å—Ç–µ—Ä': cluster_id,
            '–†–∞–∑–º–µ—Ä': len(cluster_data),
            '–î–æ–ª—è': f"{len(cluster_data) / len(data) * 100:.1f}%"
        }
        
        # –°—Ä–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è —á–∏—Å–ª–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
        numeric_cols = data.select_dtypes(include=[np.number]).columns
        for col in numeric_cols:
            if col != cluster_column:
                profile[f'–°—Ä–µ–¥–Ω–∏–π {col}'] = cluster_data[col].mean()
        
        # –ú–æ–¥—ã –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤  
        categorical_cols = data.select_dtypes(include=['object']).columns
        for col in categorical_cols:
            if col != cluster_column:
                mode_value = cluster_data[col].mode()
                if len(mode_value) > 0:
                    profile[f'–¢–∏–ø–∏—á–Ω—ã–π {col}'] = mode_value[0]
        
        profiles.append(profile)
    
    return pd.DataFrame(profiles)

# –°–æ–∑–¥–∞–µ–º –ø—Ä–æ—Ñ–∏–ª–∏ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
cluster_profiles = profile_clusters(customers)
print("üìä –ü—Ä–æ—Ñ–∏–ª–∏ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ –∫–ª–∏–µ–Ω—Ç–æ–≤:")
print(cluster_profiles)
```

### üè∑Ô∏è **–ü—Ä–∏—Å–≤–æ–µ–Ω–∏–µ –±–∏–∑–Ω–µ—Å-–Ω–∞–∑–≤–∞–Ω–∏–π –∫–ª–∞—Å—Ç–µ—Ä–∞–º**

```python
# –ù–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–æ—Ñ–∏–ª–µ–π –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ–º –ø–æ–Ω—è—Ç–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è
cluster_names = {
    0: '–ú–æ–ª–æ–¥—ã–µ –∞–∫—Ç–∏–≤–Ω—ã–µ',
    1: '–ü—Ä–µ–º–∏—É–º –∫–ª–∏–µ–Ω—Ç—ã', 
    2: '–≠–∫–æ–Ω–æ–º–Ω—ã–µ –ø–æ–∫—É–ø–∞—Ç–µ–ª–∏',
    3: '–†–µ–¥–∫–∏–µ –∫—Ä—É–ø–Ω—ã–µ –ø–æ–∫—É–ø–∫–∏',
    4: '–°—Ä–µ–¥–Ω–∏–π –∫–ª–∞—Å—Å'
}

customers['—Å–µ–≥–º–µ–Ω—Ç_–Ω–∞–∑–≤–∞–Ω–∏–µ'] = customers['–∫–ª–∞—Å—Ç–µ—Ä'].map(cluster_names)

# –°–æ–∑–¥–∞–µ–º —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞
segment_strategies = {
    '–ú–æ–ª–æ–¥—ã–µ –∞–∫—Ç–∏–≤–Ω—ã–µ': '–ê–∫—Ü–∏–∏ –Ω–∞ —Ç—Ä–µ–Ω–¥–æ–≤—ã–µ —Ç–æ–≤–∞—Ä—ã, —Å–æ—Ü—Å–µ—Ç–∏',
    '–ü—Ä–µ–º–∏—É–º –∫–ª–∏–µ–Ω—Ç—ã': 'VIP –ø—Ä–æ–≥—Ä–∞–º–º–∞, –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä',  
    '–≠–∫–æ–Ω–æ–º–Ω—ã–µ –ø–æ–∫—É–ø–∞—Ç–µ–ª–∏': '–°–∫–∏–¥–∫–∏, –ø—Ä–æ–≥—Ä–∞–º–º–∞ –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏',
    '–†–µ–¥–∫–∏–µ –∫—Ä—É–ø–Ω—ã–µ –ø–æ–∫—É–ø–∫–∏': '–ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è, —Å–µ–∑–æ–Ω–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è',
    '–°—Ä–µ–¥–Ω–∏–π –∫–ª–∞—Å—Å': '–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∞–∫—Ü–∏–∏, email-—Ä–∞—Å—Å—ã–ª–∫–∞'
}

print("üéØ –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Ä–∞–±–æ—Ç—ã —Å —Å–µ–≥–º–µ–Ω—Ç–∞–º–∏:")
for segment, strategy in segment_strategies.items():
    count = (customers['—Å–µ–≥–º–µ–Ω—Ç_–Ω–∞–∑–≤–∞–Ω–∏–µ'] == segment).sum()
    print(f"{segment} ({count} –∫–ª–∏–µ–Ω—Ç–æ–≤): {strategy}")
```

## üöÄ –ì–æ—Ç–æ–≤—ã–µ —à–∞–±–ª–æ–Ω—ã –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è

### üéØ **–ü–æ–ª–Ω—ã–π –ø–∞–π–ø–ª–∞–π–Ω —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤**

```python
def customer_segmentation_pipeline(data, features, n_clusters=5):
    """
    –ü–æ–ª–Ω—ã–π –ø–∞–π–ø–ª–∞–π–Ω —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤
    
    Parameters:
    -----------
    data : DataFrame
        –î–∞–Ω–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç–æ–≤
    features : list
        –°–ø–∏—Å–æ–∫ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏
    n_clusters : int
        –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
    
    Returns:
    --------
    data_with_clusters : DataFrame
        –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–º–∏ –∫–ª–∞—Å—Ç–µ—Ä–∞–º–∏
    model : KMeans
        –û–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å –¥–ª—è –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    """
    
    from sklearn.cluster import KMeans
    from sklearn.preprocessing import StandardScaler
    from sklearn.metrics import silhouette_score
    
    # 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
    X = data[features].copy()
    
    # –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—Å–∫–æ–≤
    X = X.fillna(X.median())
    
    # –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è
    scaler = StandardScaler()
    X_scaled = scaler.fit_transform(X)
    
    # 2. –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è
    kmeans = KMeans(n_clusters=n_clusters, random_state=42, n_init=10)
    cluster_labels = kmeans.fit_predict(X_scaled)
    
    # 3. –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞
    silhouette = silhouette_score(X_scaled, cluster_labels)
    print(f"‚úÖ –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞!")
    print(f"üìä –°–∏–ª—É—ç—Ç–Ω—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç: {silhouette:.3f}")
    print(f"üéØ –ù–∞–π–¥–µ–Ω–æ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤: {n_clusters}")
    
    # 4. –î–æ–±–∞–≤–ª—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
    result_data = data.copy()
    result_data['–∫–ª–∞—Å—Ç–µ—Ä'] = cluster_labels
    
    # 5. –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ
    print("\nüìã –†–∞–∑–º–µ—Ä—ã –∫–ª–∞—Å—Ç–µ—Ä–æ–≤:")
    print(pd.Series(cluster_labels).value_counts().sort_index())
    
    return result_data, kmeans, scaler

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
segmented_customers, model, scaler = customer_segmentation_pipeline(
    data=customers,
    features=['–≤–æ–∑—Ä–∞—Å—Ç', '–¥–æ—Ö–æ–¥', '—á–∞—Å—Ç–æ—Ç–∞_–ø–æ–∫—É–ø–æ–∫', '—Å—Ä–µ–¥–Ω–∏–π_—á–µ–∫'],
    n_clusters=5
)
```

### üìä **–§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—ã–±–æ—Ä–∞ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤**

```python
def find_optimal_clusters(data, features, max_k=10):
    """–ù–∞—Ö–æ–¥–∏—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤"""
    
    from sklearn.cluster import KMeans
    from sklearn.preprocessing import StandardScaler
    from sklearn.metrics import silhouette_score
    import matplotlib.pyplot as plt
    
    # –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
    X = data[features]
    scaler = StandardScaler()
    X_scaled = scaler.fit_transform(X)
    
    # –¢–µ—Å—Ç–∏—Ä—É–µ–º —Ä–∞–∑–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
    k_range = range(2, max_k + 1)
    inertias = []
    silhouette_scores = []
    
    for k in k_range:
        kmeans = KMeans(n_clusters=k, random_state=42)
        cluster_labels = kmeans.fit_predict(X_scaled)
        
        inertias.append(kmeans.inertia_)
        silhouette_scores.append(silhouette_score(X_scaled, cluster_labels))
    
    # –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(15, 5))
    
    # –ì—Ä–∞—Ñ–∏–∫ –ª–æ–∫—Ç—è
    ax1.plot(k_range, inertias, 'bo-')
    ax1.set_title('üìà –ú–µ—Ç–æ–¥ –ª–æ–∫—Ç—è')
    ax1.set_xlabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ (k)')
    ax1.set_ylabel('–í–Ω—É—Ç—Ä–∏–∫–ª–∞—Å—Ç–µ—Ä–Ω–∞—è –¥–∏—Å–ø–µ—Ä—Å–∏—è')
    ax1.grid(alpha=0.3)
    
    # –°–∏–ª—É—ç—Ç–Ω—ã–π –∞–Ω–∞–ª–∏–∑
    ax2.plot(k_range, silhouette_scores, 'ro-')
    ax2.set_title('üìä –°–∏–ª—É—ç—Ç–Ω—ã–π –∞–Ω–∞–ª–∏–∑')
    ax2.set_xlabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ (k)')
    ax2.set_ylabel('–°–∏–ª—É—ç—Ç–Ω—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç')
    ax2.grid(alpha=0.3)
    
    # –ù–∞—Ö–æ–¥–∏–º –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ k
    best_k = k_range[np.argmax(silhouette_scores)]
    
    plt.tight_layout()
    plt.show()
    
    print(f"üéØ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤: {best_k}")
    print(f"üìä –°–∏–ª—É—ç—Ç–Ω—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç: {max(silhouette_scores):.3f}")
    
    return best_k, silhouette_scores

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
optimal_k, scores = find_optimal_clusters(
    data=customers,
    features=['–≤–æ–∑—Ä–∞—Å—Ç', '–¥–æ—Ö–æ–¥', '—á–∞—Å—Ç–æ—Ç–∞_–ø–æ–∫—É–ø–æ–∫'],
    max_k=10
)
```

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã –∏ –æ—à–∏–±–∫–∏

### ‚ùå **–ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏ –Ω–æ–≤–∏—á–∫–æ–≤:**

1. **üîç –ó–∞–±—ã–≤–∞—é—Ç –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ**
   ```python
   # ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ
   kmeans.fit(raw_data)
   
   # ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ
   scaler = StandardScaler()
   scaled_data = scaler.fit_transform(raw_data)
   kmeans.fit(scaled_data)
   ```

2. **üéØ –ù–µ –∞–Ω–∞–ª–∏–∑–∏—Ä—É—é—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã**
   ```python
   # ‚ùå –ü—Ä–æ—Å—Ç–æ –ø–æ–ª—É—á–∏–ª–∏ –∫–ª–∞—Å—Ç–µ—Ä—ã
   clusters = kmeans.fit_predict(X)
   
   # ‚úÖ –ê–Ω–∞–ª–∏–∑–∏—Ä—É—é—Ç –∏ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É—é—Ç
   clusters = kmeans.fit_predict(X)
   silhouette = silhouette_score(X, clusters)
   print(f"–ö–∞—á–µ—Å—Ç–≤–æ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏: {silhouette}")
   
   # –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
   for i in range(n_clusters):
       print(f"–ö–ª–∞—Å—Ç–µ—Ä {i}: {np.sum(clusters == i)} –æ–±—ä–µ–∫—Ç–æ–≤")
   ```

3. **üìä –ò—Å–ø–æ–ª—å–∑—É—é—Ç –Ω–µ–ø–æ–¥—Ö–æ–¥—è—â–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏**
   ```python
   # ‚ùå –í–∫–ª—é—á–∞—é—Ç ID –∏ –¥—Ä—É–≥–∏–µ –Ω–µ—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏
   features = ['client_id', 'registration_date', 'age', 'income']
   
   # ‚úÖ –¢–æ–ª—å–∫–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ –¥–ª—è —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –ø—Ä–∏–∑–Ω–∞–∫–∏
   features = ['age', 'income', 'purchase_frequency', 'avg_order_value']
   ```

### üí° **–õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏:**

1. **üîç –ò—Å—Å–ª–µ–¥—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–¥ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–µ–π**
2. **üìè –í—Å–µ–≥–¥–∞ –Ω–æ—Ä–º–∞–ª–∏–∑—É–π—Ç–µ —á–∏—Å–ª–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏**
3. **üéØ –ü—Ä–æ–±—É–π—Ç–µ —Ä–∞–∑–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã**
4. **üìä –û—Ü–µ–Ω–∏–≤–∞–π—Ç–µ –∫–∞—á–µ—Å—Ç–≤–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏**
5. **üíº –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å –±–∏–∑–Ω–µ—Å-—Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è**
6. **üîÑ –í–∞–ª–∏–¥–∏—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö**

## üöÄ –ß—Ç–æ –¥–∞–ª—å—à–µ?

–ü–æ—Å–ª–µ –æ—Å–≤–æ–µ–Ω–∏—è —ç—Ç–æ–π –≥–ª–∞–≤—ã –≤—ã —É–º–µ–µ—Ç–µ:

‚úÖ **–ù–∞—Ö–æ–¥–∏—Ç—å —Å–∫—Ä—ã—Ç—ã–µ –≥—Ä—É–ø–ø—ã** –≤ –¥–∞–Ω–Ω—ã—Ö –±–µ–∑ —É—á–∏—Ç–µ–ª—è  
‚úÖ **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å k-means –∏ –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫—É—é –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—é** –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∑–∞–¥–∞—á  
‚úÖ **–í—ã–±–∏—Ä–∞—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤** —Å –ø–æ–º–æ—â—å—é —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫  
‚úÖ **–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã** –∏ –ø—Ä–∏–º–µ–Ω—è—Ç—å –∏—Ö –≤ –±–∏–∑–Ω–µ—Å–µ  
‚úÖ **–°–æ–∑–¥–∞–≤–∞—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏** –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å–µ–≥–º–µ–Ω—Ç–æ–≤ –∫–ª–∏–µ–Ω—Ç–æ–≤

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ù–∞—É—á–∏—Ç—å—Å—è –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å –ø–æ–º–æ—â—å—é –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è!

## üõ† –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏

–¢–µ–ø–µ—Ä—å –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–º –∑–∞–¥–∞–Ω–∏—è–º ‚Äî –≤–∞—Å –∂–¥—É—Ç 5 —É–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ –ø–æ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ —Ä–µ–∞–ª—å–Ω—ã—Ö –±–∏–∑–Ω–µ—Å-–¥–∞–Ω–Ω—ã—Ö:

- üìù [–ü–µ—Ä–µ–π—Ç–∏ –∫ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–º –∑–∞–¥–∞–Ω–∏—è–º](practice.md)
- ‚úÖ [–ü–µ—Ä–µ–π—Ç–∏ –∫ —á–µ–∫-–ª–∏—Å—Ç—É](checklist.md)
- üìÅ [–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —É—á–µ–±–Ω—ã–µ —Ñ–∞–π–ª—ã](files/README.md)

---

- üîô [–ü—Ä–µ–¥—ã–¥—É—â–∞—è –≥–ª–∞–≤–∞: –ì–ª–∞–≤–∞ 15 - –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤ Python: Matplotlib –∏ Seaborn](../chapter-15/README.md)
- üîú [–°–ª–µ–¥—É—é—â–∞—è –≥–ª–∞–≤–∞: –ì–ª–∞–≤–∞ 17 - –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ —Ä–µ–≥—Ä–µ—Å—Å–∏—è –≤ –º–∞—à–∏–Ω–Ω–æ–º –æ–±—É—á–µ–Ω–∏–∏](../chapter-17/README.md)

---

- üì¢ –ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Ç–µ—Å—å –∫ —á–∞—Ç—É –∫—É—Ä—Å–∞: https://t.me/analytics_course_chat
- üì¢ –ö–∞–Ω–∞–ª –∫—É—Ä—Å–∞: https://t.me/analytics_course_channel